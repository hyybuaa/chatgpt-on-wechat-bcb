[INFO][2024-12-25 11:46:36][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': '', 'open_ai_api_key': 'YOU*****KEY', 'claude_api_key': 'YOU*****KEY', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': ['bot', '@bot'], 'single_chat_reply_prefix': '[bot] ', 'group_chat_prefix': ['@bot'], 'group_name_white_list': ['ChatGPT测试群', 'ChatGPT测试群2'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': ''}
[INFO][2024-12-25 11:46:36][config.py:226] - [Config] User datas file not found, ignore.
[INFO][2024-12-25 11:46:37][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 11:46:37][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 11:46:37][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 11:46:37][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 11:46:37][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 11:46:37][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 11:46:37][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 11:46:37][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 11:46:37][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 11:46:37][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 11:46:37][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 11:46:37][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[INFO][2024-12-25 11:46:37][plugin_manager.py:123] - Plugin GODCMD not found in pconfig, adding to pconfig...
[INFO][2024-12-25 11:46:37][plugin_manager.py:123] - Plugin KEYWORD not found in pconfig, adding to pconfig...
[INFO][2024-12-25 11:46:37][plugin_manager.py:123] - Plugin BANWORDS not found in pconfig, adding to pconfig...
[INFO][2024-12-25 11:46:37][plugin_manager.py:123] - Plugin LINKAI not found in pconfig, adding to pconfig...
[INFO][2024-12-25 11:46:37][plugin_manager.py:123] - Plugin ROLE not found in pconfig, adding to pconfig...
[INFO][2024-12-25 11:46:37][plugin_manager.py:123] - Plugin DUNGEON not found in pconfig, adding to pconfig...
[INFO][2024-12-25 11:46:37][plugin_manager.py:123] - Plugin BDUNIT not found in pconfig, adding to pconfig...
[INFO][2024-12-25 11:46:37][plugin_manager.py:123] - Plugin HELLO not found in pconfig, adding to pconfig...
[INFO][2024-12-25 11:46:37][plugin_manager.py:123] - Plugin FINISH not found in pconfig, adding to pconfig...
[INFO][2024-12-25 11:46:37][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为6043。
[INFO][2024-12-25 11:46:37][godcmd.py:210] - [Godcmd] inited
[INFO][2024-12-25 11:46:37][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 11:46:37][keyword.py:42] - [keyword] inited.
[WARNING][2024-12-25 11:46:37][banwords.py:54] - [Banwords] init failed, ignore or see https://github.com/zhayujie/chatgpt-on-wechat/tree/master/plugins/banwords .
[WARNING][2024-12-25 11:46:37][plugin_manager.py:150] - Failed to init BANWORDS, diabled. [Errno 2] No such file or directory: '/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/plugins/banwords/banwords.txt'
[INFO][2024-12-25 11:46:37][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[INFO][2024-12-25 11:46:37][role.py:69] - [Role] inited
[INFO][2024-12-25 11:46:37][dungeon.py:56] - [Dungeon] inited
[WARNING][2024-12-25 11:46:37][bdunit.py:42] - [BDunit] init failed, ignore 
[WARNING][2024-12-25 11:46:37][plugin_manager.py:150] - Failed to init BDUNIT, diabled. config.json not found
[INFO][2024-12-25 11:46:37][hello.py:38] - [Hello] inited
[INFO][2024-12-25 11:46:37][finish.py:23] - [Finish] inited
[ERROR][2024-12-25 11:47:23][wechat_channel.py:138] - 'wxsid'
Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/channel/wechat/wechat_channel.py", line 124, in startup
    itchat.auto_login(
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/lib/itchat/components/register.py", line 38, in auto_login
    self.login(enableCmdQR=enableCmdQR, picDir=picDir, qrCallback=qrCallback,
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/lib/itchat/components/login.py", line 61, in login
    status = self.check_login()
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/lib/itchat/components/login.py", line 154, in check_login
    if process_login_info(self, r.text):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/lib/itchat/components/login.py", line 206, in process_login_info
    core.loginInfo['wxsid'] = core.loginInfo['BaseRequest']['Sid'] = cookies["wxsid"]
KeyError: 'wxsid'
[INFO][2024-12-25 11:56:38][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 11:56:38][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 11:56:42][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': '', 'open_ai_api_key': 'YOU*****KEY', 'claude_api_key': 'YOU*****KEY', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': ['bot', '@bot'], 'single_chat_reply_prefix': '[bot] ', 'group_chat_prefix': ['@bot'], 'group_name_white_list': ['ChatGPT测试群', 'ChatGPT测试群2'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': ''}
[INFO][2024-12-25 11:56:42][config.py:224] - [Config] User datas loaded.
[INFO][2024-12-25 11:56:42][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 11:56:42][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 11:56:42][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 11:56:42][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 11:56:42][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 11:56:42][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 11:56:42][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 11:56:42][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 11:56:42][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 11:56:42][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 11:56:42][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 11:56:42][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[INFO][2024-12-25 11:56:42][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为8039。
[INFO][2024-12-25 11:56:42][godcmd.py:210] - [Godcmd] inited
[INFO][2024-12-25 11:56:42][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 11:56:42][keyword.py:42] - [keyword] inited.
[INFO][2024-12-25 11:56:42][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[INFO][2024-12-25 11:56:42][role.py:69] - [Role] inited
[INFO][2024-12-25 11:56:42][dungeon.py:56] - [Dungeon] inited
[INFO][2024-12-25 11:56:42][hello.py:38] - [Hello] inited
[INFO][2024-12-25 11:56:42][finish.py:23] - [Finish] inited
[INFO][2024-12-25 11:57:08][wechat_channel.py:134] - Wechat login success, user_id: @5d85273fc1d49134111fab628a2877e004483fc402c4b1eda6ad939c49caf8e1, nickname: 学习小助手
[INFO][2024-12-25 11:58:36][bridge.py:68] - create bot chatGPT for chat
[INFO][2024-12-25 11:58:38][chat_gpt_bot.py:57] - [CHATGPT] query=你好
[ERROR][2024-12-25 11:58:41][chat_gpt_bot.py:163] - [CHATGPT] Exception: Incorrect API key provided: YOUR API KEY. You can find your API key at https://platform.openai.com/account/api-keys.
Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/chatgpt/chat_gpt_bot.py", line 131, in reply_text
    response = openai.ChatCompletion.create(api_key=api_key, messages=session.messages, **args)
  File "/opt/miniconda3/lib/python3.10/site-packages/openai/api_resources/chat_completion.py", line 25, in create
    return super().create(*args, **kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 153, in create
    response, _, api_key = requestor.request(
  File "/opt/miniconda3/lib/python3.10/site-packages/openai/api_requestor.py", line 298, in request
    resp, got_stream = self._interpret_response(result, stream)
  File "/opt/miniconda3/lib/python3.10/site-packages/openai/api_requestor.py", line 700, in _interpret_response
    self._interpret_response_line(
  File "/opt/miniconda3/lib/python3.10/site-packages/openai/api_requestor.py", line 763, in _interpret_response_line
    raise self.handle_error_response(
openai.error.AuthenticationError: Incorrect API key provided: YOUR API KEY. You can find your API key at https://platform.openai.com/account/api-keys.
[INFO][2024-12-25 11:58:41][wechat_channel.py:222] - [WX] sendMsg=Reply(type=ERROR, content=[ERROR]
我现在有点累了，等会再来吧), receiver=@94e55f9a5fa98e39a877d7b26e21ca24
[WARNING][2024-12-25 12:02:34][wechat_message.py:114] - [WX]get other_user_id failed: 'UserName'
[WARNING][2024-12-25 12:02:34][chat_channel.py:231] - [chat_channel] unknown context type: ACCEPT_FRIEND
[INFO][2024-12-25 13:09:50][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': 'moonshot-v1-32k', 'open_ai_api_key': 'sk-*****Tb1', 'claude_api_key': 'YOU*****KEY', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': [''], 'single_chat_reply_prefix': '', 'group_chat_prefix': ['@学习小助手'], 'group_name_white_list': ['ALL_GROUP'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': ''}
[INFO][2024-12-25 13:09:50][config.py:224] - [Config] User datas loaded.
[INFO][2024-12-25 13:09:51][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 13:09:51][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 13:09:51][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 13:09:51][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 13:09:51][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 13:09:51][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 13:09:51][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 13:09:51][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 13:09:51][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 13:09:51][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 13:09:51][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 13:09:51][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[INFO][2024-12-25 13:09:51][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为2715。
[INFO][2024-12-25 13:09:51][godcmd.py:210] - [Godcmd] inited
[INFO][2024-12-25 13:09:51][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 13:09:51][keyword.py:42] - [keyword] inited.
[INFO][2024-12-25 13:09:51][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[INFO][2024-12-25 13:09:51][role.py:69] - [Role] inited
[INFO][2024-12-25 13:09:51][dungeon.py:56] - [Dungeon] inited
[INFO][2024-12-25 13:09:51][hello.py:38] - [Hello] inited
[INFO][2024-12-25 13:09:51][finish.py:23] - [Finish] inited
[INFO][2024-12-25 13:10:19][wechat_channel.py:134] - Wechat login success, user_id: @dbe66e22ea75c45a889578924e65c71426826ce243b9899b7093896c01df8271, nickname: 学习小助手
[INFO][2024-12-25 13:10:27][bridge.py:68] - create bot moonshot for chat
[INFO][2024-12-25 13:10:28][moonshot_bot.py:36] - [MOONSHOT_AI] query=你好
[ERROR][2024-12-25 13:10:28][moonshot_bot.py:140] - can only concatenate str (not "NoneType") to str
Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 96, in reply_text
    "Authorization": "Bearer " + self.api_key
TypeError: can only concatenate str (not "NoneType") to str
[ERROR][2024-12-25 13:10:28][moonshot_bot.py:140] - can only concatenate str (not "NoneType") to str
Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 96, in reply_text
    "Authorization": "Bearer " + self.api_key
TypeError: can only concatenate str (not "NoneType") to str

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 96, in reply_text
    "Authorization": "Bearer " + self.api_key
TypeError: can only concatenate str (not "NoneType") to str
[ERROR][2024-12-25 13:10:28][moonshot_bot.py:140] - can only concatenate str (not "NoneType") to str
Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 96, in reply_text
    "Authorization": "Bearer " + self.api_key
TypeError: can only concatenate str (not "NoneType") to str

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 96, in reply_text
    "Authorization": "Bearer " + self.api_key
TypeError: can only concatenate str (not "NoneType") to str

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 96, in reply_text
    "Authorization": "Bearer " + self.api_key
TypeError: can only concatenate str (not "NoneType") to str
[INFO][2024-12-25 13:10:28][wechat_channel.py:222] - [WX] sendMsg=Reply(type=ERROR, content=[ERROR]
我现在有点累了，等会再来吧), receiver=@bf714499dcacf91a0f78388fe860320e
[INFO][2024-12-25 13:15:02][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 13:15:02][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 13:15:03][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 13:15:03][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 13:15:06][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': 'moonshot-v1-32k', 'open_ai_api_key': 'YOU*****KEY', 'claude_api_key': 'YOU*****KEY', 'bot_type': 'moonshot', 'moonshot_api_key': 'key*****key', 'moonshot_base_url': 'https://api.moonshot.cn/v1/chat/completions', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': [''], 'single_chat_reply_prefix': '', 'group_chat_prefix': ['@学习小助手'], 'group_name_white_list': ['ALL_GROUP'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': ''}
[INFO][2024-12-25 13:15:06][config.py:224] - [Config] User datas loaded.
[INFO][2024-12-25 13:15:06][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 13:15:06][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 13:15:06][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 13:15:06][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 13:15:06][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 13:15:06][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 13:15:06][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 13:15:06][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 13:15:06][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 13:15:06][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 13:15:06][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 13:15:06][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[INFO][2024-12-25 13:15:06][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为7183。
[INFO][2024-12-25 13:15:06][godcmd.py:210] - [Godcmd] inited
[INFO][2024-12-25 13:15:06][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 13:15:06][keyword.py:42] - [keyword] inited.
[INFO][2024-12-25 13:15:06][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[INFO][2024-12-25 13:15:06][role.py:69] - [Role] inited
[INFO][2024-12-25 13:15:06][dungeon.py:56] - [Dungeon] inited
[INFO][2024-12-25 13:15:06][hello.py:38] - [Hello] inited
[INFO][2024-12-25 13:15:06][finish.py:23] - [Finish] inited
[INFO][2024-12-25 13:15:50][wechat_channel.py:134] - Wechat login success, user_id: @8f582072a2770ca4d877de878d1db241896b3e6beb68254c1c4cc0a2c63e0242, nickname: 学习小助手
[INFO][2024-12-25 13:15:56][bridge.py:68] - create bot moonshot for chat
[INFO][2024-12-25 13:15:57][moonshot_bot.py:36] - [MOONSHOT_AI] query=你好
[ERROR][2024-12-25 13:15:57][moonshot_bot.py:117] - [MOONSHOT_AI] chat failed, status_code=401, msg=Invalid Authentication, type=invalid_authentication_error
[INFO][2024-12-25 13:15:57][wechat_channel.py:222] - [WX] sendMsg=Reply(type=ERROR, content=[ERROR]
授权失败，请检查API Key是否正确), receiver=@ed0daccba5d90f219461299826cb24aa
[INFO][2024-12-25 13:16:23][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 13:16:23][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 13:16:23][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 13:16:23][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 13:16:27][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': 'moonshot-v1-32k', 'open_ai_api_key': 'YOU*****KEY', 'claude_api_key': 'YOU*****KEY', 'bot_type': 'moonshot', 'moonshot_api_key': 'sk-*****Tb1', 'moonshot_base_url': 'https://api.moonshot.cn/v1/chat/completions', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': [''], 'single_chat_reply_prefix': '', 'group_chat_prefix': ['@学习小助手'], 'group_name_white_list': ['ALL_GROUP'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': ''}
[INFO][2024-12-25 13:16:27][config.py:224] - [Config] User datas loaded.
[INFO][2024-12-25 13:16:27][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 13:16:27][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 13:16:27][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 13:16:27][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 13:16:27][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 13:16:27][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 13:16:27][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 13:16:27][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 13:16:27][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 13:16:27][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 13:16:27][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 13:16:27][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[INFO][2024-12-25 13:16:27][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为1763。
[INFO][2024-12-25 13:16:27][godcmd.py:210] - [Godcmd] inited
[INFO][2024-12-25 13:16:27][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 13:16:27][keyword.py:42] - [keyword] inited.
[INFO][2024-12-25 13:16:27][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[INFO][2024-12-25 13:16:27][role.py:69] - [Role] inited
[INFO][2024-12-25 13:16:27][dungeon.py:56] - [Dungeon] inited
[INFO][2024-12-25 13:16:27][hello.py:38] - [Hello] inited
[INFO][2024-12-25 13:16:27][finish.py:23] - [Finish] inited
[INFO][2024-12-25 13:16:52][wechat_channel.py:134] - Wechat login success, user_id: @665872babb4bcfaacb2dc43a1926b931e0e263f1170b6c0fccf71dfc4af0e451, nickname: 学习小助手
[INFO][2024-12-25 13:16:58][bridge.py:68] - create bot moonshot for chat
[INFO][2024-12-25 13:16:59][moonshot_bot.py:36] - [MOONSHOT_AI] query=你好
[INFO][2024-12-25 13:17:00][wechat_channel.py:218] - [WX] sendMsg=Reply(type=TEXT, content=你好！有什么可以帮助你的吗？), receiver=@8c86a2e417e7f1b88f701f6a89820bd0
[INFO][2024-12-25 13:18:07][moonshot_bot.py:36] - [MOONSHOT_AI] query=帮我整理笔记
[INFO][2024-12-25 13:18:11][wechat_channel.py:218] - [WX] sendMsg=Reply(type=TEXT, content=当然可以。请上传你的笔记文件，无论是TXT、PDF、Word文档、PPT幻灯片还是Excel电子表格，只要是我可以阅读的格式，我都会帮你整理。如果你需要特定的整理方式，比如按主题分类或者提炼关键点，请告诉我具体的要求。), receiver=@8c86a2e417e7f1b88f701f6a89820bd0
[INFO][2024-12-25 13:24:02][moonshot_bot.py:36] - [MOONSHOT_AI] query=你好
[INFO][2024-12-25 13:24:04][wechat_channel.py:218] - [WX] sendMsg=Reply(type=TEXT, content=你好！有什么我可以帮你的吗？), receiver=@8c86a2e417e7f1b88f701f6a89820bd0
[INFO][2024-12-25 13:24:12][moonshot_bot.py:36] - [MOONSHOT_AI] query=帮我整理笔记
[INFO][2024-12-25 13:24:17][wechat_channel.py:218] - [WX] sendMsg=Reply(type=TEXT, content=当然可以，我需要你提供笔记的具体内容。你可以将笔记内容直接粘贴到对话框中，或者以文件的形式上传。请告诉我，你希望如何整理这些笔记？比如是否需要按主题分类、提炼关键点、创建大纲，或者有其他特定的要求？提供这些信息将帮助我更准确地满足你的需求。), receiver=@8c86a2e417e7f1b88f701f6a89820bd0
[INFO][2024-12-25 13:24:23][moonshot_bot.py:36] - [MOONSHOT_AI] query=真的吗
[INFO][2024-12-25 13:24:35][wechat_channel.py:218] - [WX] sendMsg=Reply(type=TEXT, content=当然是真的,我可以帮助你整理笔记。作为一个人工智能助手,我具备阅读、理解并整理信息的能力。以下是我整理笔记的一些方法:

1. 提取关键信息:我会仔细阅读你的笔记,从中提取重要的概念、观点和数据。

2. 按主题分类:如果笔记内容较多,我会尝试将它们分成几个主要主题,便于你快速查找。

3. 创建思维导图:我可以用mermaid语法帮你制作思维导图,直观展示笔记的逻辑结构。

4. 整理成文档:我会将整理好的笔记保存为TXT、Markdown或PDF文件,方便你随时查阅。

5. 生成摘要:如果需要,我可以为你的笔记生成一份简短的摘要,快速了解核心内容。

你只需要上传笔记文件或直接粘贴内容即可,我会仔细阅读并给出整理方案。有任何特殊要求也请告诉我,我会尽最大努力满足你的需求。请放心,我会认真对待你的笔记,保护你的隐私。让我们开始吧!), receiver=@8c86a2e417e7f1b88f701f6a89820bd0
[INFO][2024-12-25 14:34:27][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': 'math-assistant', 'open_ai_api_key': 'YOU*****KEY', 'claude_api_key': 'YOU*****KEY', 'bot_type': 'moonshot', 'moonshot_api_key': 'sk-*****9QE', 'moonshot_base_url': 'http://1.92.69.23:12003/v1/chat/completions', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': [''], 'single_chat_reply_prefix': '', 'group_chat_prefix': ['@学习小助手'], 'group_name_white_list': ['ALL_GROUP'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': ''}
[INFO][2024-12-25 14:34:27][config.py:224] - [Config] User datas loaded.
[INFO][2024-12-25 14:34:27][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 14:34:27][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 14:34:27][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 14:34:27][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 14:34:27][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 14:34:27][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 14:34:27][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 14:34:27][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 14:34:27][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 14:34:27][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 14:34:27][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 14:34:27][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[INFO][2024-12-25 14:34:27][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为2958。
[INFO][2024-12-25 14:34:27][godcmd.py:210] - [Godcmd] inited
[INFO][2024-12-25 14:34:27][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 14:34:27][keyword.py:42] - [keyword] inited.
[INFO][2024-12-25 14:34:27][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[INFO][2024-12-25 14:34:27][role.py:69] - [Role] inited
[INFO][2024-12-25 14:34:27][dungeon.py:56] - [Dungeon] inited
[INFO][2024-12-25 14:34:27][hello.py:38] - [Hello] inited
[INFO][2024-12-25 14:34:27][finish.py:23] - [Finish] inited
[INFO][2024-12-25 14:35:40][wechat_channel.py:134] - Wechat login success, user_id: @5e43acba7d336f4ed4f33e44750086de2dd1a58ee677784e01b433068e32b847, nickname: 学习小助手
[INFO][2024-12-25 14:35:45][bridge.py:68] - create bot moonshot for chat
[INFO][2024-12-25 14:35:46][moonshot_bot.py:36] - [MOONSHOT_AI] query=你好
[ERROR][2024-12-25 14:35:46][moonshot_bot.py:143] - 'NoneType' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 121, in reply_text
    f"msg={error.get('message')}, type={error.get('type')}")
AttributeError: 'NoneType' object has no attribute 'get'
[ERROR][2024-12-25 14:35:46][moonshot_bot.py:143] - 'NoneType' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 121, in reply_text
    f"msg={error.get('message')}, type={error.get('type')}")
AttributeError: 'NoneType' object has no attribute 'get'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 121, in reply_text
    f"msg={error.get('message')}, type={error.get('type')}")
AttributeError: 'NoneType' object has no attribute 'get'
[ERROR][2024-12-25 14:35:46][moonshot_bot.py:143] - 'NoneType' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 121, in reply_text
    f"msg={error.get('message')}, type={error.get('type')}")
AttributeError: 'NoneType' object has no attribute 'get'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 121, in reply_text
    f"msg={error.get('message')}, type={error.get('type')}")
AttributeError: 'NoneType' object has no attribute 'get'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 121, in reply_text
    f"msg={error.get('message')}, type={error.get('type')}")
AttributeError: 'NoneType' object has no attribute 'get'
[INFO][2024-12-25 14:35:46][wechat_channel.py:222] - [WX] sendMsg=Reply(type=ERROR, content=[ERROR]
我现在有点累了，等会再来吧), receiver=@0ec757823f456db94dbc3134939f50a4
[INFO][2024-12-25 14:45:18][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 14:45:18][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 14:45:19][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 14:45:19][config.py:235] - [Config] User datas saved.
[ERROR][2024-12-25 14:45:30][app.py:66] - App startup failed!
[ERROR][2024-12-25 14:45:30][app.py:67] - key open_ai_base_url not in available_setting
Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/app.py", line 46, in run
    load_config()
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/config.py", line 278, in load_config
    config = Config(json.loads(config_str))
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/config.py", line 192, in __init__
    self[k] = v
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/config.py", line 203, in __setitem__
    raise Exception("key {} not in available_setting".format(key))
Exception: key open_ai_base_url not in available_setting
[INFO][2024-12-25 14:47:19][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 14:47:19][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 14:52:07][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': 'math-assistant', 'open_ai_api_key': 'sk-*****9QE', 'claude_api_key': 'YOU*****KEY', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': [''], 'single_chat_reply_prefix': '', 'group_chat_prefix': ['@学习小助手'], 'group_name_white_list': ['ALL_GROUP'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': ''}
[INFO][2024-12-25 14:52:07][config.py:224] - [Config] User datas loaded.
[INFO][2024-12-25 14:52:07][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 14:52:07][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 14:52:07][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 14:52:07][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 14:52:07][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 14:52:07][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 14:52:07][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 14:52:07][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 14:52:07][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 14:52:07][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 14:52:07][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 14:52:07][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[INFO][2024-12-25 14:52:07][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为3961。
[INFO][2024-12-25 14:52:07][godcmd.py:210] - [Godcmd] inited
[INFO][2024-12-25 14:52:07][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 14:52:07][keyword.py:42] - [keyword] inited.
[INFO][2024-12-25 14:52:07][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[INFO][2024-12-25 14:52:07][role.py:69] - [Role] inited
[INFO][2024-12-25 14:52:07][dungeon.py:56] - [Dungeon] inited
[INFO][2024-12-25 14:52:07][hello.py:38] - [Hello] inited
[INFO][2024-12-25 14:52:07][finish.py:23] - [Finish] inited
[INFO][2024-12-25 14:52:55][wechat_channel.py:134] - Wechat login success, user_id: @def61ba2532611c358335ee7ff88ccf85e47073d4ffdafba72005ce8b259997e, nickname: 学习小助手
[INFO][2024-12-25 14:53:04][bridge.py:68] - create bot chatGPT for chat
[INFO][2024-12-25 14:53:04][chat_gpt_bot.py:57] - [CHATGPT] query=你好
[ERROR][2024-12-25 14:53:05][chat_gpt_bot.py:163] - [CHATGPT] Exception: Incorrect API key provided: sk-bcb_C***********************************************************M9QE. You can find your API key at https://platform.openai.com/account/api-keys.
Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/chatgpt/chat_gpt_bot.py", line 131, in reply_text
    response = openai.ChatCompletion.create(api_key=api_key, messages=session.messages, **args)
  File "/opt/miniconda3/lib/python3.10/site-packages/openai/api_resources/chat_completion.py", line 25, in create
    return super().create(*args, **kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 153, in create
    response, _, api_key = requestor.request(
  File "/opt/miniconda3/lib/python3.10/site-packages/openai/api_requestor.py", line 298, in request
    resp, got_stream = self._interpret_response(result, stream)
  File "/opt/miniconda3/lib/python3.10/site-packages/openai/api_requestor.py", line 700, in _interpret_response
    self._interpret_response_line(
  File "/opt/miniconda3/lib/python3.10/site-packages/openai/api_requestor.py", line 763, in _interpret_response_line
    raise self.handle_error_response(
openai.error.AuthenticationError: Incorrect API key provided: sk-bcb_C***********************************************************M9QE. You can find your API key at https://platform.openai.com/account/api-keys.
[INFO][2024-12-25 14:53:05][wechat_channel.py:222] - [WX] sendMsg=Reply(type=ERROR, content=[ERROR]
我现在有点累了，等会再来吧), receiver=@38741338e3d0c8148874c952457aee2b
[INFO][2024-12-25 14:57:40][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 14:57:40][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 14:57:41][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 14:57:41][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 14:58:12][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': 'math-assistant', 'bot_type': 'openAI', 'open_ai_api_key': 'sk-*****9QE', 'claude_api_key': 'YOU*****KEY', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': [''], 'single_chat_reply_prefix': '', 'group_chat_prefix': ['@学习小助手'], 'group_name_white_list': ['ALL_GROUP'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': ''}
[INFO][2024-12-25 14:58:12][config.py:224] - [Config] User datas loaded.
[INFO][2024-12-25 14:58:12][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 14:58:12][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 14:58:12][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 14:58:12][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 14:58:12][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 14:58:12][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 14:58:12][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 14:58:12][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 14:58:12][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 14:58:12][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 14:58:12][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 14:58:12][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[INFO][2024-12-25 14:58:12][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为9168。
[INFO][2024-12-25 14:58:12][godcmd.py:210] - [Godcmd] inited
[INFO][2024-12-25 14:58:12][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 14:58:12][keyword.py:42] - [keyword] inited.
[INFO][2024-12-25 14:58:12][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[INFO][2024-12-25 14:58:12][role.py:69] - [Role] inited
[INFO][2024-12-25 14:58:12][dungeon.py:56] - [Dungeon] inited
[INFO][2024-12-25 14:58:12][hello.py:38] - [Hello] inited
[INFO][2024-12-25 14:58:12][finish.py:23] - [Finish] inited
[INFO][2024-12-25 14:58:40][wechat_channel.py:134] - Wechat login success, user_id: @a32b843f418654702c5a759d3d4d43b7c8efc7dd6b98ba2f4039733366479ce0, nickname: 学习小助手
[INFO][2024-12-25 14:58:45][bridge.py:68] - create bot openAI for chat
[INFO][2024-12-25 14:58:45][open_ai_bot.py:49] - [OPEN_AI] query=你好
[WARNING][2024-12-25 14:58:45][session_manager.py:72] - Exception when counting tokens precisely for prompt: 'Could not automatically map math-assistant to a tokeniser. Please use `tiktoken.get_encoding` to explicitly get the tokeniser you expect.'
[WARNING][2024-12-25 14:58:46][open_ai_bot.py:124] - [OPEN_AI] Exception: Incorrect API key provided: sk-bcb_C***********************************************************M9QE. You can find your API key at https://platform.openai.com/account/api-keys.
[ERROR][2024-12-25 14:58:46][chat_channel.py:303] - Worker return exception: 'total_tokens'
Traceback (most recent call last):
  File "/opt/miniconda3/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/channel/chat_channel.py", line 170, in _handle
    reply = self._generate_reply(context)
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/channel/chat_channel.py", line 193, in _generate_reply
    reply = super().build_reply_content(context.content, context)
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/channel/channel.py", line 38, in build_reply_content
    return Bridge().fetch_reply_content(query, context)
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bridge/bridge.py", line 83, in fetch_reply_content
    return self.get_bot("chat").reply(query, context)
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/openai/open_ai_bot.py", line 62, in reply
    result["total_tokens"],
KeyError: 'total_tokens'
[INFO][2024-12-25 15:27:04][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 15:27:04][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 15:27:05][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 15:27:05][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 15:27:09][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': 'moonshot-v1-32k', 'open_ai_api_key': 'YOU*****KEY', 'claude_api_key': 'YOU*****KEY', 'bot_type': 'moonshot', 'moonshot_api_key': 'sk-*****Tb1', 'moonshot_base_url': 'https://api.moonshot.cn/v1/chat/completions', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': [''], 'single_chat_reply_prefix': '', 'group_chat_prefix': ['@学习小助手'], 'group_name_white_list': ['ALL_GROUP'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': ''}
[INFO][2024-12-25 15:27:09][config.py:224] - [Config] User datas loaded.
[INFO][2024-12-25 15:27:09][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 15:27:09][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 15:27:09][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 15:27:09][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 15:27:09][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 15:27:09][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 15:27:09][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 15:27:09][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 15:27:09][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 15:27:09][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 15:27:09][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 15:27:09][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[INFO][2024-12-25 15:27:09][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为0934。
[INFO][2024-12-25 15:27:09][godcmd.py:210] - [Godcmd] inited
[INFO][2024-12-25 15:27:09][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 15:27:09][keyword.py:42] - [keyword] inited.
[INFO][2024-12-25 15:27:09][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[INFO][2024-12-25 15:27:09][role.py:69] - [Role] inited
[INFO][2024-12-25 15:27:09][dungeon.py:56] - [Dungeon] inited
[INFO][2024-12-25 15:27:09][hello.py:38] - [Hello] inited
[INFO][2024-12-25 15:27:09][finish.py:23] - [Finish] inited
[INFO][2024-12-25 15:27:39][wechat_channel.py:134] - Wechat login success, user_id: @524bde8edb1d28b3cb24bc62d3a672058df5001f6d621e480b1f96c43547baa7, nickname: 学习小助手
[INFO][2024-12-25 15:27:50][bridge.py:68] - create bot moonshot for chat
[INFO][2024-12-25 15:27:51][moonshot_bot.py:36] - [MOONSHOT_AI] query=你好
[INFO][2024-12-25 15:27:55][wechat_channel.py:218] - [WX] sendMsg=Reply(type=TEXT, content=你好！有什么可以帮助你的吗？ 😊), receiver=@9861eaedf6fe4b207fa2772d06fb2e1b
[INFO][2024-12-25 15:32:34][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 15:32:34][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 15:32:35][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 15:32:35][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 15:32:37][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': 'moonshot-v1-32k', 'open_ai_api_key': 'YOU*****KEY', 'claude_api_key': 'YOU*****KEY', 'bot_type': 'moonshot', 'moonshot_api_key': 'sk-*****Tb1', 'moonshot_base_url': 'https://api.moonshot.cn/v1/chat/completions', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': [''], 'single_chat_reply_prefix': '', 'group_chat_prefix': ['@学习小助手'], 'group_name_white_list': ['ALL_GROUP'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': ''}
[INFO][2024-12-25 15:32:37][config.py:224] - [Config] User datas loaded.
[INFO][2024-12-25 15:32:37][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 15:32:37][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 15:32:37][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 15:32:37][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 15:32:37][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 15:32:37][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 15:32:37][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 15:32:37][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 15:32:37][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 15:32:37][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 15:32:37][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 15:32:37][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[INFO][2024-12-25 15:32:37][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为2901。
[INFO][2024-12-25 15:32:37][godcmd.py:210] - [Godcmd] inited
[INFO][2024-12-25 15:32:37][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 15:32:37][keyword.py:42] - [keyword] inited.
[INFO][2024-12-25 15:32:37][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[INFO][2024-12-25 15:32:37][role.py:69] - [Role] inited
[INFO][2024-12-25 15:32:37][dungeon.py:56] - [Dungeon] inited
[INFO][2024-12-25 15:32:37][hello.py:38] - [Hello] inited
[INFO][2024-12-25 15:32:37][finish.py:23] - [Finish] inited
[INFO][2024-12-25 15:33:01][wechat_channel.py:134] - Wechat login success, user_id: @66f610424f51252780c9a82bbcd966b09a8d3ccc81b00e4b734892ff33fb60ae, nickname: 学习小助手
[INFO][2024-12-25 15:33:10][wechat_channel.py:183] - [WX]receive text msg: {"MsgId": "2304425926870340079", "FromUserName": "@26d1aea40f9bb20b2177114fff7b8022", "ToUserName": "@66f610424f51252780c9a82bbcd966b09a8d3ccc81b00e4b734892ff33fb60ae", "MsgType": 1, "Content": "你好", "Status": 3, "ImgStatus": 1, "CreateTime": 1735111989, "VoiceLength": 0, "PlayLength": 0, "FileName": "", "FileSize": "", "MediaId": "", "Url": "", "AppMsgType": 0, "StatusNotifyCode": 0, "StatusNotifyUserName": "", "RecommendInfo": {"UserName": "", "NickName": "", "QQNum": 0, "Province": "", "City": "", "Content": "", "Signature": "", "Alias": "", "Scene": 0, "VerifyFlag": 0, "AttrStatus": 0, "Sex": 0, "Ticket": "", "OpCode": 0}, "ForwardFlag": 0, "AppInfo": {"AppID": "", "Type": 0}, "HasProductId": 0, "Ticket": "", "ImgHeight": 0, "ImgWidth": 0, "SubMsgType": 0, "NewMsgId": 2304425926870340079, "OriContent": "", "EncryFileName": "", "User": {"MemberList": [], "Uin": 0, "UserName": "@26d1aea40f9bb20b2177114fff7b8022", "NickName": "九歌", "HeadImgUrl": "/cgi-bin/mmwebwx-bin/webwxgeticon?seq=624980050&username=@26d1aea40f9bb20b2177114fff7b8022&skey=@crypt_fe88845f_2708f235f1b6fc21bf83d467bc9a3d65", "ContactFlag": 3, "MemberCount": 0, "RemarkName": "", "HideInputBarFlag": 0, "Sex": 1, "Signature": "Let`s go somewhere furher", "VerifyFlag": 0, "OwnerUin": 0, "PYInitial": "JG", "PYQuanPin": "jiuge", "RemarkPYInitial": "", "RemarkPYQuanPin": "", "StarFriend": 0, "AppAccountFlag": 0, "Statues": 0, "AttrStatus": 16880959, "Province": "上海", "City": "长宁", "Alias": "", "SnsFlag": 273, "UniFriend": 0, "DisplayName": "", "ChatRoomId": 0, "KeyWord": "sho", "EncryChatRoomId": "", "IsOwner": 0}, "Type": "Text", "Text": "你好"}, cmsg=ChatMessage: id=2304425926870340079, create_time=1735111989, ctype=TEXT, content=你好, from_user_id=@26d1aea40f9bb20b2177114fff7b8022, from_user_nickname=九歌, to_user_id=@66f610424f51252780c9a82bbcd966b09a8d3ccc81b00e4b734892ff33fb60ae, to_user_nickname=学习小助手, other_user_id=@26d1aea40f9bb20b2177114fff7b8022, other_user_nickname=九歌, is_group=False, is_at=False, actual_user_id=None, actual_user_nickname=None, at_list=None
[INFO][2024-12-25 15:33:10][bridge.py:68] - create bot moonshot for chat
[INFO][2024-12-25 15:33:10][moonshot_bot.py:36] - [MOONSHOT_AI] query=你好
[INFO][2024-12-25 15:33:12][wechat_channel.py:218] - [WX] sendMsg=Reply(type=TEXT, content=你好！有什么可以帮助你的吗？), receiver=@26d1aea40f9bb20b2177114fff7b8022
[INFO][2024-12-25 15:33:28][wechat_channel.py:179] - [WX]receive image msg: tmp/241225-153328.png
[INFO][2024-12-25 15:42:06][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 15:42:06][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 15:42:07][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 15:42:07][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 15:42:09][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': 'moonshot-v1-32k', 'open_ai_api_key': 'YOU*****KEY', 'claude_api_key': 'YOU*****KEY', 'bot_type': 'moonshot', 'moonshot_api_key': 'sk-*****Tb1', 'moonshot_base_url': 'https://api.moonshot.cn/v1/chat/completions', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': [''], 'single_chat_reply_prefix': '', 'group_chat_prefix': ['@学习小助手'], 'group_name_white_list': ['ALL_GROUP'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': ''}
[INFO][2024-12-25 15:42:09][config.py:224] - [Config] User datas loaded.
[INFO][2024-12-25 15:42:10][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 15:42:10][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 15:42:10][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 15:42:10][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 15:42:10][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 15:42:10][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 15:42:10][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 15:42:10][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 15:42:10][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 15:42:10][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 15:42:10][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 15:42:10][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[INFO][2024-12-25 15:42:10][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为7604。
[INFO][2024-12-25 15:42:10][godcmd.py:210] - [Godcmd] inited
[INFO][2024-12-25 15:42:10][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 15:42:10][keyword.py:42] - [keyword] inited.
[INFO][2024-12-25 15:42:10][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[INFO][2024-12-25 15:42:10][role.py:69] - [Role] inited
[INFO][2024-12-25 15:42:10][dungeon.py:56] - [Dungeon] inited
[INFO][2024-12-25 15:42:10][hello.py:38] - [Hello] inited
[INFO][2024-12-25 15:42:10][finish.py:23] - [Finish] inited
[INFO][2024-12-25 15:42:32][wechat_channel.py:134] - Wechat login success, user_id: @890fd2b9496265ea30223e3dfc76dda4e25cbb31f4bf0540c000965dcb29b3ff, nickname: 学习小助手
[INFO][2024-12-25 15:42:40][wechat_channel.py:183] - [WX]receive text msg: {"MsgId": "2493229231600561238", "FromUserName": "@1556c2b65d026911209185d121255d0a", "ToUserName": "@890fd2b9496265ea30223e3dfc76dda4e25cbb31f4bf0540c000965dcb29b3ff", "MsgType": 1, "Content": "你好", "Status": 3, "ImgStatus": 1, "CreateTime": 1735112560, "VoiceLength": 0, "PlayLength": 0, "FileName": "", "FileSize": "", "MediaId": "", "Url": "", "AppMsgType": 0, "StatusNotifyCode": 0, "StatusNotifyUserName": "", "RecommendInfo": {"UserName": "", "NickName": "", "QQNum": 0, "Province": "", "City": "", "Content": "", "Signature": "", "Alias": "", "Scene": 0, "VerifyFlag": 0, "AttrStatus": 0, "Sex": 0, "Ticket": "", "OpCode": 0}, "ForwardFlag": 0, "AppInfo": {"AppID": "", "Type": 0}, "HasProductId": 0, "Ticket": "", "ImgHeight": 0, "ImgWidth": 0, "SubMsgType": 0, "NewMsgId": 2493229231600561238, "OriContent": "", "EncryFileName": "", "User": {"MemberList": [], "Uin": 0, "UserName": "@1556c2b65d026911209185d121255d0a", "NickName": "九歌", "HeadImgUrl": "/cgi-bin/mmwebwx-bin/webwxgeticon?seq=624980050&username=@1556c2b65d026911209185d121255d0a&skey=@crypt_fe88845f_d5b41ee7de3315f1685b1cfbac9e7469", "ContactFlag": 3, "MemberCount": 0, "RemarkName": "", "HideInputBarFlag": 0, "Sex": 1, "Signature": "Let`s go somewhere furher", "VerifyFlag": 0, "OwnerUin": 0, "PYInitial": "JG", "PYQuanPin": "jiuge", "RemarkPYInitial": "", "RemarkPYQuanPin": "", "StarFriend": 0, "AppAccountFlag": 0, "Statues": 0, "AttrStatus": 16880959, "Province": "上海", "City": "长宁", "Alias": "", "SnsFlag": 273, "UniFriend": 0, "DisplayName": "", "ChatRoomId": 0, "KeyWord": "sho", "EncryChatRoomId": "", "IsOwner": 0}, "Type": "Text", "Text": "你好"}, cmsg=ChatMessage: id=2493229231600561238, create_time=1735112560, ctype=TEXT, content=你好, from_user_id=@1556c2b65d026911209185d121255d0a, from_user_nickname=九歌, to_user_id=@890fd2b9496265ea30223e3dfc76dda4e25cbb31f4bf0540c000965dcb29b3ff, to_user_nickname=学习小助手, other_user_id=@1556c2b65d026911209185d121255d0a, other_user_nickname=九歌, is_group=False, is_at=False, actual_user_id=None, actual_user_nickname=None, at_list=None
[INFO][2024-12-25 15:42:40][wechat_channel.py:187] - _compose_context后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x102dbcb50>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@1556c2b65d026911209185d121255d0a', 'receiver': '@1556c2b65d026911209185d121255d0a'})
[INFO][2024-12-25 15:42:40][wechat_channel.py:190] - produce后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x102dbcb50>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@1556c2b65d026911209185d121255d0a', 'receiver': '@1556c2b65d026911209185d121255d0a'})
[INFO][2024-12-25 15:42:40][bridge.py:68] - create bot moonshot for chat
[INFO][2024-12-25 15:42:41][moonshot_bot.py:36] - [MOONSHOT_AI] query=你好
[INFO][2024-12-25 15:42:44][wechat_channel.py:220] - [WX] sendMsg=Reply(type=TEXT, content=你好！有什么可以帮助你的吗？), receiver=@1556c2b65d026911209185d121255d0a
[INFO][2024-12-25 15:42:52][wechat_channel.py:179] - [WX]receive image msg: tmp/241225-154252.png
[INFO][2024-12-25 15:42:52][wechat_channel.py:187] - _compose_context后的 context: Context(type=IMAGE, content=tmp/241225-154252.png, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x102dbe140>, 'origin_ctype': <ContextType.IMAGE: 3>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@1556c2b65d026911209185d121255d0a', 'receiver': '@1556c2b65d026911209185d121255d0a'})
[INFO][2024-12-25 15:42:52][wechat_channel.py:190] - produce后的 context: Context(type=IMAGE, content=tmp/241225-154252.png, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x102dbe140>, 'origin_ctype': <ContextType.IMAGE: 3>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@1556c2b65d026911209185d121255d0a', 'receiver': '@1556c2b65d026911209185d121255d0a'})
[INFO][2024-12-25 15:56:13][wechat_channel.py:183] - [WX]receive text msg: {"MsgId": "1981370227479803433", "FromUserName": "@1556c2b65d026911209185d121255d0a", "ToUserName": "@890fd2b9496265ea30223e3dfc76dda4e25cbb31f4bf0540c000965dcb29b3ff", "MsgType": 1, "Content": "你好", "Status": 3, "ImgStatus": 1, "CreateTime": 1735113372, "VoiceLength": 0, "PlayLength": 0, "FileName": "", "FileSize": "", "MediaId": "", "Url": "", "AppMsgType": 0, "StatusNotifyCode": 0, "StatusNotifyUserName": "", "RecommendInfo": {"UserName": "", "NickName": "", "QQNum": 0, "Province": "", "City": "", "Content": "", "Signature": "", "Alias": "", "Scene": 0, "VerifyFlag": 0, "AttrStatus": 0, "Sex": 0, "Ticket": "", "OpCode": 0}, "ForwardFlag": 0, "AppInfo": {"AppID": "", "Type": 0}, "HasProductId": 0, "Ticket": "", "ImgHeight": 0, "ImgWidth": 0, "SubMsgType": 0, "NewMsgId": 1981370227479803433, "OriContent": "", "EncryFileName": "", "User": {"MemberList": [], "Uin": 0, "UserName": "@1556c2b65d026911209185d121255d0a", "NickName": "九歌", "HeadImgUrl": "/cgi-bin/mmwebwx-bin/webwxgeticon?seq=624980050&username=@1556c2b65d026911209185d121255d0a&skey=@crypt_fe88845f_d5b41ee7de3315f1685b1cfbac9e7469", "ContactFlag": 3, "MemberCount": 0, "RemarkName": "", "HideInputBarFlag": 0, "Sex": 1, "Signature": "Let`s go somewhere furher", "VerifyFlag": 0, "OwnerUin": 0, "PYInitial": "JG", "PYQuanPin": "jiuge", "RemarkPYInitial": "", "RemarkPYQuanPin": "", "StarFriend": 0, "AppAccountFlag": 0, "Statues": 0, "AttrStatus": 16880959, "Province": "上海", "City": "长宁", "Alias": "", "SnsFlag": 273, "UniFriend": 0, "DisplayName": "", "ChatRoomId": 0, "KeyWord": "sho", "EncryChatRoomId": "", "IsOwner": 0}, "Type": "Text", "Text": "你好"}, cmsg=ChatMessage: id=1981370227479803433, create_time=1735113372, ctype=TEXT, content=你好, from_user_id=@1556c2b65d026911209185d121255d0a, from_user_nickname=九歌, to_user_id=@890fd2b9496265ea30223e3dfc76dda4e25cbb31f4bf0540c000965dcb29b3ff, to_user_nickname=学习小助手, other_user_id=@1556c2b65d026911209185d121255d0a, other_user_nickname=九歌, is_group=False, is_at=False, actual_user_id=None, actual_user_nickname=None, at_list=None
[INFO][2024-12-25 15:56:13][wechat_channel.py:187] - _compose_context后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x10434a410>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@1556c2b65d026911209185d121255d0a', 'receiver': '@1556c2b65d026911209185d121255d0a'})
[INFO][2024-12-25 15:56:13][wechat_channel.py:190] - produce后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x10434a410>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@1556c2b65d026911209185d121255d0a', 'receiver': '@1556c2b65d026911209185d121255d0a'})
[INFO][2024-12-25 15:56:13][moonshot_bot.py:36] - [MOONSHOT_AI] query=你好
[INFO][2024-12-25 15:56:16][wechat_channel.py:220] - [WX] sendMsg=Reply(type=TEXT, content=你好！看起来你心情不错，愿意连说两次“你好”。有什么我可以帮你的吗？), receiver=@1556c2b65d026911209185d121255d0a
[INFO][2024-12-25 16:05:25][wechat_channel.py:179] - [WX]receive image msg: tmp/241225-160525.png
[INFO][2024-12-25 16:05:25][wechat_channel.py:187] - _compose_context后的 context: Context(type=IMAGE, content=tmp/241225-160525.png, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x10434a590>, 'origin_ctype': <ContextType.IMAGE: 3>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@1556c2b65d026911209185d121255d0a', 'receiver': '@1556c2b65d026911209185d121255d0a'})
[INFO][2024-12-25 16:05:25][wechat_channel.py:190] - produce后的 context: Context(type=IMAGE, content=tmp/241225-160525.png, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x10434a590>, 'origin_ctype': <ContextType.IMAGE: 3>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@1556c2b65d026911209185d121255d0a', 'receiver': '@1556c2b65d026911209185d121255d0a'})
[INFO][2024-12-25 16:31:03][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 16:31:03][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 16:31:03][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 16:31:03][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 16:31:06][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': 'moonshot-v1-32k', 'open_ai_api_key': 'YOU*****KEY', 'claude_api_key': 'YOU*****KEY', 'bot_type': 'moonshot', 'moonshot_api_key': 'sk-*****Tb1', 'moonshot_base_url': 'https://api.moonshot.cn/v1/chat/completions', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': [''], 'single_chat_reply_prefix': '', 'group_chat_prefix': ['@学习小助手'], 'group_name_white_list': ['ALL_GROUP'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': ''}
[INFO][2024-12-25 16:31:06][config.py:224] - [Config] User datas loaded.
[INFO][2024-12-25 16:31:06][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 16:31:06][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 16:31:06][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 16:31:06][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 16:31:06][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 16:31:06][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 16:31:06][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 16:31:06][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 16:31:06][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 16:31:06][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 16:31:06][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 16:31:06][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[INFO][2024-12-25 16:31:06][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为0879。
[INFO][2024-12-25 16:31:06][godcmd.py:210] - [Godcmd] inited
[INFO][2024-12-25 16:31:06][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 16:31:06][keyword.py:42] - [keyword] inited.
[INFO][2024-12-25 16:31:06][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[INFO][2024-12-25 16:31:06][role.py:69] - [Role] inited
[INFO][2024-12-25 16:31:06][dungeon.py:56] - [Dungeon] inited
[INFO][2024-12-25 16:31:06][hello.py:38] - [Hello] inited
[INFO][2024-12-25 16:31:06][finish.py:23] - [Finish] inited
[INFO][2024-12-25 16:31:33][wechat_channel.py:134] - Wechat login success, user_id: @b35bdf3ab3b7fc344ed99779210c7f1d27cf71950a50d36d257ec8a45bd8a3fd, nickname: 学习小助手
[INFO][2024-12-25 16:31:48][wechat_channel.py:183] - [WX]receive text msg: {"MsgId": "8035970366690778216", "FromUserName": "@5e19c88710331374a7f82bba96f7d71e", "ToUserName": "@b35bdf3ab3b7fc344ed99779210c7f1d27cf71950a50d36d257ec8a45bd8a3fd", "MsgType": 1, "Content": "你好", "Status": 3, "ImgStatus": 1, "CreateTime": 1735115508, "VoiceLength": 0, "PlayLength": 0, "FileName": "", "FileSize": "", "MediaId": "", "Url": "", "AppMsgType": 0, "StatusNotifyCode": 0, "StatusNotifyUserName": "", "RecommendInfo": {"UserName": "", "NickName": "", "QQNum": 0, "Province": "", "City": "", "Content": "", "Signature": "", "Alias": "", "Scene": 0, "VerifyFlag": 0, "AttrStatus": 0, "Sex": 0, "Ticket": "", "OpCode": 0}, "ForwardFlag": 0, "AppInfo": {"AppID": "", "Type": 0}, "HasProductId": 0, "Ticket": "", "ImgHeight": 0, "ImgWidth": 0, "SubMsgType": 0, "NewMsgId": 8035970366690778216, "OriContent": "", "EncryFileName": "", "User": {"MemberList": [], "Uin": 0, "UserName": "@5e19c88710331374a7f82bba96f7d71e", "NickName": "九歌", "HeadImgUrl": "/cgi-bin/mmwebwx-bin/webwxgeticon?seq=624980050&username=@5e19c88710331374a7f82bba96f7d71e&skey=@crypt_fe88845f_1793b1f22f66eccbf3bf1b228ee63825", "ContactFlag": 3, "MemberCount": 0, "RemarkName": "", "HideInputBarFlag": 0, "Sex": 1, "Signature": "Let`s go somewhere furher", "VerifyFlag": 0, "OwnerUin": 0, "PYInitial": "JG", "PYQuanPin": "jiuge", "RemarkPYInitial": "", "RemarkPYQuanPin": "", "StarFriend": 0, "AppAccountFlag": 0, "Statues": 0, "AttrStatus": 16880959, "Province": "上海", "City": "长宁", "Alias": "", "SnsFlag": 273, "UniFriend": 0, "DisplayName": "", "ChatRoomId": 0, "KeyWord": "sho", "EncryChatRoomId": "", "IsOwner": 0}, "Type": "Text", "Text": "你好"}, cmsg=ChatMessage: id=8035970366690778216, create_time=1735115508, ctype=TEXT, content=你好, from_user_id=@5e19c88710331374a7f82bba96f7d71e, from_user_nickname=九歌, to_user_id=@b35bdf3ab3b7fc344ed99779210c7f1d27cf71950a50d36d257ec8a45bd8a3fd, to_user_nickname=学习小助手, other_user_id=@5e19c88710331374a7f82bba96f7d71e, other_user_nickname=九歌, is_group=False, is_at=False, actual_user_id=None, actual_user_nickname=None, at_list=None
[INFO][2024-12-25 16:31:48][wechat_channel.py:187] - _compose_context后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x1078b62c0>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@5e19c88710331374a7f82bba96f7d71e', 'receiver': '@5e19c88710331374a7f82bba96f7d71e'})
[INFO][2024-12-25 16:31:48][wechat_channel.py:190] - produce后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x1078b62c0>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@5e19c88710331374a7f82bba96f7d71e', 'receiver': '@5e19c88710331374a7f82bba96f7d71e'})
[INFO][2024-12-25 16:31:48][bridge.py:68] - create bot moonshot for chat
[INFO][2024-12-25 16:31:49][bridge.py:83] - 模型回复内容query: 你好  context: 你好
[INFO][2024-12-25 16:31:49][moonshot_bot.py:36] - [MOONSHOT_AI] query=你好
[INFO][2024-12-25 16:31:50][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@5e19c88710331374a7f82bba96f7d71e
[INFO][2024-12-25 16:31:50][wechat_channel.py:221] - [WX] sendMsg=Reply(type=TEXT, content=你好呀！有什么可以帮助你的吗？😊), receiver=@5e19c88710331374a7f82bba96f7d71e
[INFO][2024-12-25 16:32:13][wechat_channel.py:179] - [WX]receive image msg: tmp/241225-163213.png
[INFO][2024-12-25 16:32:13][wechat_channel.py:187] - _compose_context后的 context: Context(type=IMAGE, content=tmp/241225-163213.png, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x1078b6470>, 'origin_ctype': <ContextType.IMAGE: 3>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@5e19c88710331374a7f82bba96f7d71e', 'receiver': '@5e19c88710331374a7f82bba96f7d71e'})
[INFO][2024-12-25 16:32:13][wechat_channel.py:190] - produce后的 context: Context(type=IMAGE, content=tmp/241225-163213.png, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x1078b6470>, 'origin_ctype': <ContextType.IMAGE: 3>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@5e19c88710331374a7f82bba96f7d71e', 'receiver': '@5e19c88710331374a7f82bba96f7d71e'})
[INFO][2024-12-25 16:33:43][wechat_channel.py:183] - [WX]receive text msg: {"MsgId": "2764895266989625719", "FromUserName": "@5e19c88710331374a7f82bba96f7d71e", "ToUserName": "@b35bdf3ab3b7fc344ed99779210c7f1d27cf71950a50d36d257ec8a45bd8a3fd", "MsgType": 1, "Content": "你好", "Status": 3, "ImgStatus": 1, "CreateTime": 1735115623, "VoiceLength": 0, "PlayLength": 0, "FileName": "", "FileSize": "", "MediaId": "", "Url": "", "AppMsgType": 0, "StatusNotifyCode": 0, "StatusNotifyUserName": "", "RecommendInfo": {"UserName": "", "NickName": "", "QQNum": 0, "Province": "", "City": "", "Content": "", "Signature": "", "Alias": "", "Scene": 0, "VerifyFlag": 0, "AttrStatus": 0, "Sex": 0, "Ticket": "", "OpCode": 0}, "ForwardFlag": 0, "AppInfo": {"AppID": "", "Type": 0}, "HasProductId": 0, "Ticket": "", "ImgHeight": 0, "ImgWidth": 0, "SubMsgType": 0, "NewMsgId": 2764895266989625719, "OriContent": "", "EncryFileName": "", "User": {"MemberList": [], "Uin": 0, "UserName": "@5e19c88710331374a7f82bba96f7d71e", "NickName": "九歌", "HeadImgUrl": "/cgi-bin/mmwebwx-bin/webwxgeticon?seq=624980050&username=@5e19c88710331374a7f82bba96f7d71e&skey=@crypt_fe88845f_1793b1f22f66eccbf3bf1b228ee63825", "ContactFlag": 3, "MemberCount": 0, "RemarkName": "", "HideInputBarFlag": 0, "Sex": 1, "Signature": "Let`s go somewhere furher", "VerifyFlag": 0, "OwnerUin": 0, "PYInitial": "JG", "PYQuanPin": "jiuge", "RemarkPYInitial": "", "RemarkPYQuanPin": "", "StarFriend": 0, "AppAccountFlag": 0, "Statues": 0, "AttrStatus": 16880959, "Province": "上海", "City": "长宁", "Alias": "", "SnsFlag": 273, "UniFriend": 0, "DisplayName": "", "ChatRoomId": 0, "KeyWord": "sho", "EncryChatRoomId": "", "IsOwner": 0}, "Type": "Text", "Text": "你好"}, cmsg=ChatMessage: id=2764895266989625719, create_time=1735115623, ctype=TEXT, content=你好, from_user_id=@5e19c88710331374a7f82bba96f7d71e, from_user_nickname=九歌, to_user_id=@b35bdf3ab3b7fc344ed99779210c7f1d27cf71950a50d36d257ec8a45bd8a3fd, to_user_nickname=学习小助手, other_user_id=@5e19c88710331374a7f82bba96f7d71e, other_user_nickname=九歌, is_group=False, is_at=False, actual_user_id=None, actual_user_nickname=None, at_list=None
[INFO][2024-12-25 16:33:43][wechat_channel.py:187] - _compose_context后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x1078b6080>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@5e19c88710331374a7f82bba96f7d71e', 'receiver': '@5e19c88710331374a7f82bba96f7d71e'})
[INFO][2024-12-25 16:33:43][wechat_channel.py:190] - produce后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x1078b6080>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@5e19c88710331374a7f82bba96f7d71e', 'receiver': '@5e19c88710331374a7f82bba96f7d71e'})
[INFO][2024-12-25 16:33:44][bridge.py:83] - 模型回复内容query: 你好  context: 你好
[INFO][2024-12-25 16:33:44][moonshot_bot.py:36] - [MOONSHOT_AI] query=你好
[INFO][2024-12-25 16:33:47][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@5e19c88710331374a7f82bba96f7d71e
[INFO][2024-12-25 16:33:48][wechat_channel.py:221] - [WX] sendMsg=Reply(type=TEXT, content=你好！有什么可以帮你的吗？不管是问题解答还是日常生活的小建议，我都在这里等你哦。), receiver=@5e19c88710331374a7f82bba96f7d71e
[INFO][2024-12-25 16:35:31][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 16:35:31][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 16:35:31][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 16:35:31][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 16:35:37][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': 'moonshot-v1-32k', 'open_ai_api_key': 'YOU*****KEY', 'claude_api_key': 'YOU*****KEY', 'bot_type': 'moonshot', 'moonshot_api_key': 'sk-*****Tb1', 'moonshot_base_url': 'https://api.moonshot.cn/v1/chat/completions', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': [''], 'single_chat_reply_prefix': '', 'group_chat_prefix': ['@学习小助手'], 'group_name_white_list': ['ALL_GROUP'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': ''}
[INFO][2024-12-25 16:35:37][config.py:224] - [Config] User datas loaded.
[INFO][2024-12-25 16:35:38][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 16:35:38][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 16:35:38][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 16:35:38][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 16:35:38][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 16:35:38][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 16:35:38][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 16:35:38][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 16:35:38][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 16:35:38][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 16:35:38][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 16:35:38][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[INFO][2024-12-25 16:35:38][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为5380。
[INFO][2024-12-25 16:35:38][godcmd.py:210] - [Godcmd] inited
[INFO][2024-12-25 16:35:38][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 16:35:38][keyword.py:42] - [keyword] inited.
[INFO][2024-12-25 16:35:38][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[INFO][2024-12-25 16:35:38][role.py:69] - [Role] inited
[INFO][2024-12-25 16:35:38][dungeon.py:56] - [Dungeon] inited
[INFO][2024-12-25 16:35:38][hello.py:38] - [Hello] inited
[INFO][2024-12-25 16:35:38][finish.py:23] - [Finish] inited
[INFO][2024-12-25 16:36:22][wechat_channel.py:134] - Wechat login success, user_id: @e809d51cfedecbfb83fe6ced13ccf7f04a9a73bed8ac7a33aa727ca48a806009, nickname: 学习小助手
[INFO][2024-12-25 16:36:34][wechat_channel.py:183] - [WX]receive text msg: {"MsgId": "4908190113112929617", "FromUserName": "@1e2e489c4acdd404fb582420bd0ae03d", "ToUserName": "@e809d51cfedecbfb83fe6ced13ccf7f04a9a73bed8ac7a33aa727ca48a806009", "MsgType": 1, "Content": "你好", "Status": 3, "ImgStatus": 1, "CreateTime": 1735115794, "VoiceLength": 0, "PlayLength": 0, "FileName": "", "FileSize": "", "MediaId": "", "Url": "", "AppMsgType": 0, "StatusNotifyCode": 0, "StatusNotifyUserName": "", "RecommendInfo": {"UserName": "", "NickName": "", "QQNum": 0, "Province": "", "City": "", "Content": "", "Signature": "", "Alias": "", "Scene": 0, "VerifyFlag": 0, "AttrStatus": 0, "Sex": 0, "Ticket": "", "OpCode": 0}, "ForwardFlag": 0, "AppInfo": {"AppID": "", "Type": 0}, "HasProductId": 0, "Ticket": "", "ImgHeight": 0, "ImgWidth": 0, "SubMsgType": 0, "NewMsgId": 4908190113112929617, "OriContent": "", "EncryFileName": "", "User": {"MemberList": [], "Uin": 0, "UserName": "@1e2e489c4acdd404fb582420bd0ae03d", "NickName": "九歌", "HeadImgUrl": "/cgi-bin/mmwebwx-bin/webwxgeticon?seq=624980050&username=@1e2e489c4acdd404fb582420bd0ae03d&skey=@crypt_fe88845f_9fbaa7f4401ad782c1263afc0c33b3ab", "ContactFlag": 3, "MemberCount": 0, "RemarkName": "", "HideInputBarFlag": 0, "Sex": 1, "Signature": "Let`s go somewhere furher", "VerifyFlag": 0, "OwnerUin": 0, "PYInitial": "JG", "PYQuanPin": "jiuge", "RemarkPYInitial": "", "RemarkPYQuanPin": "", "StarFriend": 0, "AppAccountFlag": 0, "Statues": 0, "AttrStatus": 16880959, "Province": "上海", "City": "长宁", "Alias": "", "SnsFlag": 273, "UniFriend": 0, "DisplayName": "", "ChatRoomId": 0, "KeyWord": "sho", "EncryChatRoomId": "", "IsOwner": 0}, "Type": "Text", "Text": "你好"}, cmsg=ChatMessage: id=4908190113112929617, create_time=1735115794, ctype=TEXT, content=你好, from_user_id=@1e2e489c4acdd404fb582420bd0ae03d, from_user_nickname=九歌, to_user_id=@e809d51cfedecbfb83fe6ced13ccf7f04a9a73bed8ac7a33aa727ca48a806009, to_user_nickname=学习小助手, other_user_id=@1e2e489c4acdd404fb582420bd0ae03d, other_user_nickname=九歌, is_group=False, is_at=False, actual_user_id=None, actual_user_nickname=None, at_list=None
[INFO][2024-12-25 16:36:34][wechat_channel.py:187] - _compose_context后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x102c32680>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@1e2e489c4acdd404fb582420bd0ae03d', 'receiver': '@1e2e489c4acdd404fb582420bd0ae03d'})
[INFO][2024-12-25 16:36:34][wechat_channel.py:190] - produce后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x102c32680>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@1e2e489c4acdd404fb582420bd0ae03d', 'receiver': '@1e2e489c4acdd404fb582420bd0ae03d'})
[INFO][2024-12-25 16:36:35][bridge.py:68] - create bot moonshot for chat
[INFO][2024-12-25 16:36:35][bridge.py:83] - 模型回复内容query: 你好  context type: TEXT
[INFO][2024-12-25 16:36:35][moonshot_bot.py:36] - [MOONSHOT_AI] query=你好
[INFO][2024-12-25 16:36:36][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@1e2e489c4acdd404fb582420bd0ae03d
[INFO][2024-12-25 16:36:37][wechat_channel.py:221] - [WX] sendMsg=Reply(type=TEXT, content=你好！有什么可以帮助你的吗？), receiver=@1e2e489c4acdd404fb582420bd0ae03d
[INFO][2024-12-25 16:36:47][wechat_channel.py:179] - [WX]receive image msg: tmp/241225-163647.png
[INFO][2024-12-25 16:36:47][wechat_channel.py:187] - _compose_context后的 context: Context(type=IMAGE, content=tmp/241225-163647.png, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x102c324d0>, 'origin_ctype': <ContextType.IMAGE: 3>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@1e2e489c4acdd404fb582420bd0ae03d', 'receiver': '@1e2e489c4acdd404fb582420bd0ae03d'})
[INFO][2024-12-25 16:36:47][wechat_channel.py:190] - produce后的 context: Context(type=IMAGE, content=tmp/241225-163647.png, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x102c324d0>, 'origin_ctype': <ContextType.IMAGE: 3>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@1e2e489c4acdd404fb582420bd0ae03d', 'receiver': '@1e2e489c4acdd404fb582420bd0ae03d'})
[INFO][2024-12-25 16:36:47][bridge.py:83] - 模型回复内容query: tmp/241225-163647.png  context type: IMAGE
[INFO][2024-12-25 16:36:47][moonshot_bot.py:83] - 已经获取到图片
[INFO][2024-12-25 16:36:47][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@1e2e489c4acdd404fb582420bd0ae03d
[INFO][2024-12-25 16:36:48][wechat_channel.py:221] - [WX] sendMsg=Reply(type=TEXT, content=已经获取到图片信息), receiver=@1e2e489c4acdd404fb582420bd0ae03d
[INFO][2024-12-25 16:42:47][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 16:42:47][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 16:42:47][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 16:42:47][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 16:42:50][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': 'moonshot-v1-32k', 'open_ai_api_key': 'YOU*****KEY', 'claude_api_key': 'YOU*****KEY', 'bot_type': 'moonshot', 'moonshot_api_key': 'sk-*****Tb1', 'moonshot_base_url': 'https://api.moonshot.cn/v1/chat/completions', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': [''], 'single_chat_reply_prefix': '', 'group_chat_prefix': ['@学习小助手'], 'group_name_white_list': ['ALL_GROUP'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': ''}
[INFO][2024-12-25 16:42:50][config.py:224] - [Config] User datas loaded.
[INFO][2024-12-25 16:42:50][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 16:42:50][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 16:42:50][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 16:42:50][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 16:42:50][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 16:42:50][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 16:42:50][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 16:42:50][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 16:42:50][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 16:42:50][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 16:42:50][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 16:42:50][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[INFO][2024-12-25 16:42:50][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为0514。
[INFO][2024-12-25 16:42:50][godcmd.py:210] - [Godcmd] inited
[INFO][2024-12-25 16:42:50][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 16:42:50][keyword.py:42] - [keyword] inited.
[INFO][2024-12-25 16:42:50][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[INFO][2024-12-25 16:42:50][role.py:69] - [Role] inited
[INFO][2024-12-25 16:42:50][dungeon.py:56] - [Dungeon] inited
[INFO][2024-12-25 16:42:50][hello.py:38] - [Hello] inited
[INFO][2024-12-25 16:42:50][finish.py:23] - [Finish] inited
[INFO][2024-12-25 16:43:37][wechat_channel.py:134] - Wechat login success, user_id: @d8a47af34fa44d8c4aad9efd8eb1ce9ab85577e3ae437a9b4e401ff62c7000fc, nickname: 学习小助手
[INFO][2024-12-25 16:43:41][wechat_channel.py:183] - [WX]receive text msg: {"MsgId": "1293765233878494287", "FromUserName": "@59efa0c8d0cf114049a459d240e5c6fa", "ToUserName": "@d8a47af34fa44d8c4aad9efd8eb1ce9ab85577e3ae437a9b4e401ff62c7000fc", "MsgType": 1, "Content": "你好", "Status": 3, "ImgStatus": 1, "CreateTime": 1735116221, "VoiceLength": 0, "PlayLength": 0, "FileName": "", "FileSize": "", "MediaId": "", "Url": "", "AppMsgType": 0, "StatusNotifyCode": 0, "StatusNotifyUserName": "", "RecommendInfo": {"UserName": "", "NickName": "", "QQNum": 0, "Province": "", "City": "", "Content": "", "Signature": "", "Alias": "", "Scene": 0, "VerifyFlag": 0, "AttrStatus": 0, "Sex": 0, "Ticket": "", "OpCode": 0}, "ForwardFlag": 0, "AppInfo": {"AppID": "", "Type": 0}, "HasProductId": 0, "Ticket": "", "ImgHeight": 0, "ImgWidth": 0, "SubMsgType": 0, "NewMsgId": 1293765233878494287, "OriContent": "", "EncryFileName": "", "User": {"MemberList": [], "Uin": 0, "UserName": "@59efa0c8d0cf114049a459d240e5c6fa", "NickName": "九歌", "HeadImgUrl": "/cgi-bin/mmwebwx-bin/webwxgeticon?seq=624980050&username=@59efa0c8d0cf114049a459d240e5c6fa&skey=@crypt_fe88845f_69faa87156e9dda97f30520f99c1bbf8", "ContactFlag": 3, "MemberCount": 0, "RemarkName": "", "HideInputBarFlag": 0, "Sex": 1, "Signature": "Let`s go somewhere furher", "VerifyFlag": 0, "OwnerUin": 0, "PYInitial": "JG", "PYQuanPin": "jiuge", "RemarkPYInitial": "", "RemarkPYQuanPin": "", "StarFriend": 0, "AppAccountFlag": 0, "Statues": 0, "AttrStatus": 16880959, "Province": "上海", "City": "长宁", "Alias": "", "SnsFlag": 273, "UniFriend": 0, "DisplayName": "", "ChatRoomId": 0, "KeyWord": "sho", "EncryChatRoomId": "", "IsOwner": 0}, "Type": "Text", "Text": "你好"}, cmsg=ChatMessage: id=1293765233878494287, create_time=1735116221, ctype=TEXT, content=你好, from_user_id=@59efa0c8d0cf114049a459d240e5c6fa, from_user_nickname=九歌, to_user_id=@d8a47af34fa44d8c4aad9efd8eb1ce9ab85577e3ae437a9b4e401ff62c7000fc, to_user_nickname=学习小助手, other_user_id=@59efa0c8d0cf114049a459d240e5c6fa, other_user_nickname=九歌, is_group=False, is_at=False, actual_user_id=None, actual_user_nickname=None, at_list=None
[INFO][2024-12-25 16:43:41][wechat_channel.py:187] - _compose_context后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x105ab58a0>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@59efa0c8d0cf114049a459d240e5c6fa', 'receiver': '@59efa0c8d0cf114049a459d240e5c6fa'})
[INFO][2024-12-25 16:43:41][wechat_channel.py:190] - produce后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x105ab58a0>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@59efa0c8d0cf114049a459d240e5c6fa', 'receiver': '@59efa0c8d0cf114049a459d240e5c6fa'})
[INFO][2024-12-25 16:43:41][bridge.py:68] - create bot moonshot for chat
[INFO][2024-12-25 16:43:42][bridge.py:83] - 模型回复内容query: 你好  context type: TEXT
[INFO][2024-12-25 16:43:42][moonshot_bot.py:36] - [MOONSHOT_AI] query=你好
[INFO][2024-12-25 16:43:42][moonshot_bot.py:53] - [MOONSHOT_AI] session query=[{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '你好'}]
[INFO][2024-12-25 16:43:45][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@59efa0c8d0cf114049a459d240e5c6fa
[INFO][2024-12-25 16:43:46][wechat_channel.py:221] - [WX] sendMsg=Reply(type=TEXT, content=你好！有什么可以帮助你的吗？), receiver=@59efa0c8d0cf114049a459d240e5c6fa
[INFO][2024-12-25 16:43:50][wechat_channel.py:179] - [WX]receive image msg: tmp/241225-164350.png
[INFO][2024-12-25 16:43:50][wechat_channel.py:187] - _compose_context后的 context: Context(type=IMAGE, content=tmp/241225-164350.png, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x105ab5cf0>, 'origin_ctype': <ContextType.IMAGE: 3>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@59efa0c8d0cf114049a459d240e5c6fa', 'receiver': '@59efa0c8d0cf114049a459d240e5c6fa'})
[INFO][2024-12-25 16:43:50][wechat_channel.py:190] - produce后的 context: Context(type=IMAGE, content=tmp/241225-164350.png, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x105ab5cf0>, 'origin_ctype': <ContextType.IMAGE: 3>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@59efa0c8d0cf114049a459d240e5c6fa', 'receiver': '@59efa0c8d0cf114049a459d240e5c6fa'})
[INFO][2024-12-25 16:43:50][bridge.py:83] - 模型回复内容query: tmp/241225-164350.png  context type: IMAGE
[INFO][2024-12-25 16:43:50][moonshot_bot.py:82] - [MOONSHOT_AI] query=tmp/241225-164350.png
[INFO][2024-12-25 16:43:50][moonshot_bot.py:98] - [MOONSHOT_AI] session query=[{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '你好'}, {'role': 'assistant', 'content': '你好！有什么可以帮助你的吗？'}, {'role': 'user', 'content': 'tmp/241225-164350.png'}]
[INFO][2024-12-25 16:43:55][moonshot_bot.py:125] - 已经获取到图片
[INFO][2024-12-25 16:43:55][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@59efa0c8d0cf114049a459d240e5c6fa
[INFO][2024-12-25 16:43:55][wechat_channel.py:221] - [WX] sendMsg=Reply(type=TEXT, content=看起来你发送了一个文件名，可能是一个图片文件。不过，我目前只能提供文字回复，无法查看或分析图片内容。如果你有任何关于这个图片的问题，或者需要我帮你查找相关信息，请用文字告诉我，我会尽力帮你解答。), receiver=@59efa0c8d0cf114049a459d240e5c6fa
[INFO][2024-12-25 18:30:19][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 18:30:19][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 18:31:45][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': 'math-assistant', 'open_ai_api_key': 'YOU*****KEY', 'claude_api_key': 'YOU*****KEY', 'bot_type': 'moonshot', 'moonshot_api_key': 'sk-*****9QE', 'moonshot_base_url': 'http://1.92.69.23:12003/v1/chat/completions', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': [''], 'single_chat_reply_prefix': '', 'group_chat_prefix': ['@学习小助手'], 'group_name_white_list': ['ALL_GROUP'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': ''}
[INFO][2024-12-25 18:31:45][config.py:224] - [Config] User datas loaded.
[INFO][2024-12-25 18:31:45][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 18:31:45][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 18:31:45][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 18:31:45][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 18:31:45][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 18:31:45][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 18:31:45][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 18:31:45][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 18:31:45][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 18:31:45][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 18:31:45][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 18:31:45][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[INFO][2024-12-25 18:31:45][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为4053。
[INFO][2024-12-25 18:31:45][godcmd.py:210] - [Godcmd] inited
[INFO][2024-12-25 18:31:45][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 18:31:45][keyword.py:42] - [keyword] inited.
[INFO][2024-12-25 18:31:45][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[INFO][2024-12-25 18:31:45][role.py:69] - [Role] inited
[INFO][2024-12-25 18:31:45][dungeon.py:56] - [Dungeon] inited
[INFO][2024-12-25 18:31:45][hello.py:38] - [Hello] inited
[INFO][2024-12-25 18:31:45][finish.py:23] - [Finish] inited
[INFO][2024-12-25 18:32:12][wechat_channel.py:134] - Wechat login success, user_id: @abbd7d7dfcfc5fcf1e13c412712a2d09316e9b7b5a464ca24cca593c7e025ab3, nickname: 学习小助手
[INFO][2024-12-25 18:32:24][wechat_channel.py:183] - [WX]receive text msg: {"MsgId": "6360801214353692885", "FromUserName": "@0fb975f2a6af4ae63ddf8882123d6720", "ToUserName": "@abbd7d7dfcfc5fcf1e13c412712a2d09316e9b7b5a464ca24cca593c7e025ab3", "MsgType": 1, "Content": "你好", "Status": 3, "ImgStatus": 1, "CreateTime": 1735122744, "VoiceLength": 0, "PlayLength": 0, "FileName": "", "FileSize": "", "MediaId": "", "Url": "", "AppMsgType": 0, "StatusNotifyCode": 0, "StatusNotifyUserName": "", "RecommendInfo": {"UserName": "", "NickName": "", "QQNum": 0, "Province": "", "City": "", "Content": "", "Signature": "", "Alias": "", "Scene": 0, "VerifyFlag": 0, "AttrStatus": 0, "Sex": 0, "Ticket": "", "OpCode": 0}, "ForwardFlag": 0, "AppInfo": {"AppID": "", "Type": 0}, "HasProductId": 0, "Ticket": "", "ImgHeight": 0, "ImgWidth": 0, "SubMsgType": 0, "NewMsgId": 6360801214353692885, "OriContent": "", "EncryFileName": "", "User": {"MemberList": [], "Uin": 0, "UserName": "@0fb975f2a6af4ae63ddf8882123d6720", "NickName": "九歌", "HeadImgUrl": "/cgi-bin/mmwebwx-bin/webwxgeticon?seq=624980050&username=@0fb975f2a6af4ae63ddf8882123d6720&skey=@crypt_fe88845f_e13cc03383c4ead8ff88aa7cb9ab4501", "ContactFlag": 3, "MemberCount": 0, "RemarkName": "", "HideInputBarFlag": 0, "Sex": 1, "Signature": "Let`s go somewhere furher", "VerifyFlag": 0, "OwnerUin": 0, "PYInitial": "JG", "PYQuanPin": "jiuge", "RemarkPYInitial": "", "RemarkPYQuanPin": "", "StarFriend": 0, "AppAccountFlag": 0, "Statues": 0, "AttrStatus": 16880959, "Province": "上海", "City": "长宁", "Alias": "", "SnsFlag": 273, "UniFriend": 0, "DisplayName": "", "ChatRoomId": 0, "KeyWord": "sho", "EncryChatRoomId": "", "IsOwner": 0}, "Type": "Text", "Text": "你好"}, cmsg=ChatMessage: id=6360801214353692885, create_time=1735122744, ctype=TEXT, content=你好, from_user_id=@0fb975f2a6af4ae63ddf8882123d6720, from_user_nickname=九歌, to_user_id=@abbd7d7dfcfc5fcf1e13c412712a2d09316e9b7b5a464ca24cca593c7e025ab3, to_user_nickname=学习小助手, other_user_id=@0fb975f2a6af4ae63ddf8882123d6720, other_user_nickname=九歌, is_group=False, is_at=False, actual_user_id=None, actual_user_nickname=None, at_list=None
[INFO][2024-12-25 18:32:24][wechat_channel.py:187] - _compose_context后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x106f6a260>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@0fb975f2a6af4ae63ddf8882123d6720', 'receiver': '@0fb975f2a6af4ae63ddf8882123d6720'})
[INFO][2024-12-25 18:32:24][wechat_channel.py:190] - produce后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x106f6a260>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@0fb975f2a6af4ae63ddf8882123d6720', 'receiver': '@0fb975f2a6af4ae63ddf8882123d6720'})
[INFO][2024-12-25 18:32:25][bridge.py:68] - create bot moonshot for chat
[INFO][2024-12-25 18:32:25][bridge.py:83] - 模型回复内容query: 你好  context type: TEXT
[INFO][2024-12-25 18:32:25][moonshot_bot.py:36] - [MOONSHOT_AI] query=你好
[INFO][2024-12-25 18:32:25][moonshot_bot.py:53] - [MOONSHOT_AI] session query=[{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '你好'}]
[ERROR][2024-12-25 18:32:25][moonshot_bot.py:186] - HTTPConnectionPool(host='127.0.0.1', port=59527): Max retries exceeded with url: http://1.92.69.23:12003/v1/chat/completions (Caused by ProxyError('Unable to connect to proxy', RemoteDisconnected('Remote end closed connection without response')))
Traceback (most recent call last):
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    response = self._make_request(
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 536, in _make_request
    response = conn.getresponse()
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
  File "/opt/miniconda3/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/opt/miniconda3/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/opt/miniconda3/lib/python3.10/http/client.py", line 287, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
http.client.RemoteDisconnected: Remote end closed connection without response

The above exception was the direct cause of the following exception:

urllib3.exceptions.ProxyError: ('Unable to connect to proxy', RemoteDisconnected('Remote end closed connection without response'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 844, in urlopen
    retries = retries.increment(
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/util/retry.py", line 515, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=59527): Max retries exceeded with url: http://1.92.69.23:12003/v1/chat/completions (Caused by ProxyError('Unable to connect to proxy', RemoteDisconnected('Remote end closed connection without response')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 148, in reply_text
    res = requests.post(
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/adapters.py", line 513, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=59527): Max retries exceeded with url: http://1.92.69.23:12003/v1/chat/completions (Caused by ProxyError('Unable to connect to proxy', RemoteDisconnected('Remote end closed connection without response')))
[ERROR][2024-12-25 18:32:25][moonshot_bot.py:186] - HTTPConnectionPool(host='127.0.0.1', port=59527): Max retries exceeded with url: http://1.92.69.23:12003/v1/chat/completions (Caused by ProxyError('Unable to connect to proxy', RemoteDisconnected('Remote end closed connection without response')))
Traceback (most recent call last):
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    response = self._make_request(
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 536, in _make_request
    response = conn.getresponse()
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
  File "/opt/miniconda3/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/opt/miniconda3/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/opt/miniconda3/lib/python3.10/http/client.py", line 287, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
http.client.RemoteDisconnected: Remote end closed connection without response

The above exception was the direct cause of the following exception:

urllib3.exceptions.ProxyError: ('Unable to connect to proxy', RemoteDisconnected('Remote end closed connection without response'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 844, in urlopen
    retries = retries.increment(
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/util/retry.py", line 515, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=59527): Max retries exceeded with url: http://1.92.69.23:12003/v1/chat/completions (Caused by ProxyError('Unable to connect to proxy', RemoteDisconnected('Remote end closed connection without response')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 148, in reply_text
    res = requests.post(
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/adapters.py", line 513, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=59527): Max retries exceeded with url: http://1.92.69.23:12003/v1/chat/completions (Caused by ProxyError('Unable to connect to proxy', RemoteDisconnected('Remote end closed connection without response')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    response = self._make_request(
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 536, in _make_request
    response = conn.getresponse()
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
  File "/opt/miniconda3/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/opt/miniconda3/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/opt/miniconda3/lib/python3.10/http/client.py", line 287, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
http.client.RemoteDisconnected: Remote end closed connection without response

The above exception was the direct cause of the following exception:

urllib3.exceptions.ProxyError: ('Unable to connect to proxy', RemoteDisconnected('Remote end closed connection without response'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 844, in urlopen
    retries = retries.increment(
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/util/retry.py", line 515, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=59527): Max retries exceeded with url: http://1.92.69.23:12003/v1/chat/completions (Caused by ProxyError('Unable to connect to proxy', RemoteDisconnected('Remote end closed connection without response')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 148, in reply_text
    res = requests.post(
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/adapters.py", line 513, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=59527): Max retries exceeded with url: http://1.92.69.23:12003/v1/chat/completions (Caused by ProxyError('Unable to connect to proxy', RemoteDisconnected('Remote end closed connection without response')))
[ERROR][2024-12-25 18:32:25][moonshot_bot.py:186] - HTTPConnectionPool(host='127.0.0.1', port=59527): Max retries exceeded with url: http://1.92.69.23:12003/v1/chat/completions (Caused by ProxyError('Unable to connect to proxy', RemoteDisconnected('Remote end closed connection without response')))
Traceback (most recent call last):
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    response = self._make_request(
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 536, in _make_request
    response = conn.getresponse()
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
  File "/opt/miniconda3/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/opt/miniconda3/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/opt/miniconda3/lib/python3.10/http/client.py", line 287, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
http.client.RemoteDisconnected: Remote end closed connection without response

The above exception was the direct cause of the following exception:

urllib3.exceptions.ProxyError: ('Unable to connect to proxy', RemoteDisconnected('Remote end closed connection without response'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 844, in urlopen
    retries = retries.increment(
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/util/retry.py", line 515, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=59527): Max retries exceeded with url: http://1.92.69.23:12003/v1/chat/completions (Caused by ProxyError('Unable to connect to proxy', RemoteDisconnected('Remote end closed connection without response')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 148, in reply_text
    res = requests.post(
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/adapters.py", line 513, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=59527): Max retries exceeded with url: http://1.92.69.23:12003/v1/chat/completions (Caused by ProxyError('Unable to connect to proxy', RemoteDisconnected('Remote end closed connection without response')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    response = self._make_request(
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 536, in _make_request
    response = conn.getresponse()
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
  File "/opt/miniconda3/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/opt/miniconda3/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/opt/miniconda3/lib/python3.10/http/client.py", line 287, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
http.client.RemoteDisconnected: Remote end closed connection without response

The above exception was the direct cause of the following exception:

urllib3.exceptions.ProxyError: ('Unable to connect to proxy', RemoteDisconnected('Remote end closed connection without response'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 844, in urlopen
    retries = retries.increment(
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/util/retry.py", line 515, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=59527): Max retries exceeded with url: http://1.92.69.23:12003/v1/chat/completions (Caused by ProxyError('Unable to connect to proxy', RemoteDisconnected('Remote end closed connection without response')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 148, in reply_text
    res = requests.post(
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/adapters.py", line 513, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=59527): Max retries exceeded with url: http://1.92.69.23:12003/v1/chat/completions (Caused by ProxyError('Unable to connect to proxy', RemoteDisconnected('Remote end closed connection without response')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    response = self._make_request(
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 536, in _make_request
    response = conn.getresponse()
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
  File "/opt/miniconda3/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/opt/miniconda3/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/opt/miniconda3/lib/python3.10/http/client.py", line 287, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
http.client.RemoteDisconnected: Remote end closed connection without response

The above exception was the direct cause of the following exception:

urllib3.exceptions.ProxyError: ('Unable to connect to proxy', RemoteDisconnected('Remote end closed connection without response'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 844, in urlopen
    retries = retries.increment(
  File "/opt/miniconda3/lib/python3.10/site-packages/urllib3/util/retry.py", line 515, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=59527): Max retries exceeded with url: http://1.92.69.23:12003/v1/chat/completions (Caused by ProxyError('Unable to connect to proxy', RemoteDisconnected('Remote end closed connection without response')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 148, in reply_text
    res = requests.post(
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/opt/miniconda3/lib/python3.10/site-packages/requests/adapters.py", line 513, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: HTTPConnectionPool(host='127.0.0.1', port=59527): Max retries exceeded with url: http://1.92.69.23:12003/v1/chat/completions (Caused by ProxyError('Unable to connect to proxy', RemoteDisconnected('Remote end closed connection without response')))
[INFO][2024-12-25 18:32:25][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@0fb975f2a6af4ae63ddf8882123d6720
[INFO][2024-12-25 18:32:26][wechat_channel.py:225] - [WX] sendMsg=Reply(type=ERROR, content=[ERROR]
我现在有点累了，等会再来吧), receiver=@0fb975f2a6af4ae63ddf8882123d6720
[INFO][2024-12-25 18:38:15][wechat_channel.py:183] - [WX]receive text msg: {"MsgId": "2498828132547685072", "FromUserName": "@0fb975f2a6af4ae63ddf8882123d6720", "ToUserName": "@abbd7d7dfcfc5fcf1e13c412712a2d09316e9b7b5a464ca24cca593c7e025ab3", "MsgType": 1, "Content": "你好", "Status": 3, "ImgStatus": 1, "CreateTime": 1735123094, "VoiceLength": 0, "PlayLength": 0, "FileName": "", "FileSize": "", "MediaId": "", "Url": "", "AppMsgType": 0, "StatusNotifyCode": 0, "StatusNotifyUserName": "", "RecommendInfo": {"UserName": "", "NickName": "", "QQNum": 0, "Province": "", "City": "", "Content": "", "Signature": "", "Alias": "", "Scene": 0, "VerifyFlag": 0, "AttrStatus": 0, "Sex": 0, "Ticket": "", "OpCode": 0}, "ForwardFlag": 0, "AppInfo": {"AppID": "", "Type": 0}, "HasProductId": 0, "Ticket": "", "ImgHeight": 0, "ImgWidth": 0, "SubMsgType": 0, "NewMsgId": 2498828132547685072, "OriContent": "", "EncryFileName": "", "User": {"MemberList": [], "Uin": 0, "UserName": "@0fb975f2a6af4ae63ddf8882123d6720", "NickName": "九歌", "HeadImgUrl": "/cgi-bin/mmwebwx-bin/webwxgeticon?seq=624980050&username=@0fb975f2a6af4ae63ddf8882123d6720&skey=@crypt_fe88845f_e13cc03383c4ead8ff88aa7cb9ab4501", "ContactFlag": 3, "MemberCount": 0, "RemarkName": "", "HideInputBarFlag": 0, "Sex": 1, "Signature": "Let`s go somewhere furher", "VerifyFlag": 0, "OwnerUin": 0, "PYInitial": "JG", "PYQuanPin": "jiuge", "RemarkPYInitial": "", "RemarkPYQuanPin": "", "StarFriend": 0, "AppAccountFlag": 0, "Statues": 0, "AttrStatus": 16880959, "Province": "上海", "City": "长宁", "Alias": "", "SnsFlag": 273, "UniFriend": 0, "DisplayName": "", "ChatRoomId": 0, "KeyWord": "sho", "EncryChatRoomId": "", "IsOwner": 0}, "Type": "Text", "Text": "你好"}, cmsg=ChatMessage: id=2498828132547685072, create_time=1735123094, ctype=TEXT, content=你好, from_user_id=@0fb975f2a6af4ae63ddf8882123d6720, from_user_nickname=九歌, to_user_id=@abbd7d7dfcfc5fcf1e13c412712a2d09316e9b7b5a464ca24cca593c7e025ab3, to_user_nickname=学习小助手, other_user_id=@0fb975f2a6af4ae63ddf8882123d6720, other_user_nickname=九歌, is_group=False, is_at=False, actual_user_id=None, actual_user_nickname=None, at_list=None
[INFO][2024-12-25 18:38:15][wechat_channel.py:187] - _compose_context后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x106f6a620>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@0fb975f2a6af4ae63ddf8882123d6720', 'receiver': '@0fb975f2a6af4ae63ddf8882123d6720'})
[INFO][2024-12-25 18:38:15][wechat_channel.py:190] - produce后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x106f6a620>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@0fb975f2a6af4ae63ddf8882123d6720', 'receiver': '@0fb975f2a6af4ae63ddf8882123d6720'})
[INFO][2024-12-25 18:38:15][bridge.py:83] - 模型回复内容query: 你好  context type: TEXT
[INFO][2024-12-25 18:38:15][moonshot_bot.py:36] - [MOONSHOT_AI] query=你好
[INFO][2024-12-25 18:38:15][moonshot_bot.py:53] - [MOONSHOT_AI] session query=[{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '你好'}, {'role': 'user', 'content': '你好'}]
[ERROR][2024-12-25 18:38:15][moonshot_bot.py:186] - 'NoneType' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 164, in reply_text
    f"msg={error.get('message')}, type={error.get('type')}")
AttributeError: 'NoneType' object has no attribute 'get'
[ERROR][2024-12-25 18:38:15][moonshot_bot.py:186] - 'NoneType' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 164, in reply_text
    f"msg={error.get('message')}, type={error.get('type')}")
AttributeError: 'NoneType' object has no attribute 'get'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 164, in reply_text
    f"msg={error.get('message')}, type={error.get('type')}")
AttributeError: 'NoneType' object has no attribute 'get'
[ERROR][2024-12-25 18:38:15][moonshot_bot.py:186] - 'NoneType' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 164, in reply_text
    f"msg={error.get('message')}, type={error.get('type')}")
AttributeError: 'NoneType' object has no attribute 'get'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 164, in reply_text
    f"msg={error.get('message')}, type={error.get('type')}")
AttributeError: 'NoneType' object has no attribute 'get'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 164, in reply_text
    f"msg={error.get('message')}, type={error.get('type')}")
AttributeError: 'NoneType' object has no attribute 'get'
[INFO][2024-12-25 18:38:15][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@0fb975f2a6af4ae63ddf8882123d6720
[INFO][2024-12-25 18:38:16][wechat_channel.py:225] - [WX] sendMsg=Reply(type=ERROR, content=[ERROR]
我现在有点累了，等会再来吧), receiver=@0fb975f2a6af4ae63ddf8882123d6720
[INFO][2024-12-25 18:42:34][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 18:42:34][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 18:42:34][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 18:42:34][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 18:42:37][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': 'math-assistant', 'open_ai_api_key': 'YOU*****KEY', 'claude_api_key': 'YOU*****KEY', 'bot_type': 'moonshot', 'moonshot_api_key': 'sk-*****9QE', 'moonshot_base_url': 'http://1.92.69.23:12003/v1/chat/completions', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': [''], 'single_chat_reply_prefix': '', 'group_chat_prefix': ['@学习小助手'], 'group_name_white_list': ['ALL_GROUP'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': ''}
[INFO][2024-12-25 18:42:37][config.py:224] - [Config] User datas loaded.
[INFO][2024-12-25 18:42:37][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 18:42:37][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 18:42:37][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 18:42:37][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 18:42:37][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 18:42:37][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 18:42:37][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 18:42:37][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 18:42:37][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 18:42:37][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 18:42:37][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 18:42:37][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[INFO][2024-12-25 18:42:37][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为1325。
[INFO][2024-12-25 18:42:37][godcmd.py:210] - [Godcmd] inited
[INFO][2024-12-25 18:42:37][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 18:42:37][keyword.py:42] - [keyword] inited.
[INFO][2024-12-25 18:42:37][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[INFO][2024-12-25 18:42:37][role.py:69] - [Role] inited
[INFO][2024-12-25 18:42:37][dungeon.py:56] - [Dungeon] inited
[INFO][2024-12-25 18:42:37][hello.py:38] - [Hello] inited
[INFO][2024-12-25 18:42:37][finish.py:23] - [Finish] inited
[INFO][2024-12-25 18:43:13][wechat_channel.py:134] - Wechat login success, user_id: @619fc8c7e97811c1d0683e51d0e912730eee5c6c2bb9b3b2602a644709993fba, nickname: 学习小助手
[INFO][2024-12-25 18:43:24][wechat_channel.py:183] - [WX]receive text msg: {"MsgId": "3016408735286874302", "FromUserName": "@faca92b30740d481d3e5fdd82dcb5371", "ToUserName": "@619fc8c7e97811c1d0683e51d0e912730eee5c6c2bb9b3b2602a644709993fba", "MsgType": 1, "Content": "你好", "Status": 3, "ImgStatus": 1, "CreateTime": 1735123403, "VoiceLength": 0, "PlayLength": 0, "FileName": "", "FileSize": "", "MediaId": "", "Url": "", "AppMsgType": 0, "StatusNotifyCode": 0, "StatusNotifyUserName": "", "RecommendInfo": {"UserName": "", "NickName": "", "QQNum": 0, "Province": "", "City": "", "Content": "", "Signature": "", "Alias": "", "Scene": 0, "VerifyFlag": 0, "AttrStatus": 0, "Sex": 0, "Ticket": "", "OpCode": 0}, "ForwardFlag": 0, "AppInfo": {"AppID": "", "Type": 0}, "HasProductId": 0, "Ticket": "", "ImgHeight": 0, "ImgWidth": 0, "SubMsgType": 0, "NewMsgId": 3016408735286874302, "OriContent": "", "EncryFileName": "", "User": {"MemberList": [], "Uin": 0, "UserName": "@faca92b30740d481d3e5fdd82dcb5371", "NickName": "九歌", "HeadImgUrl": "/cgi-bin/mmwebwx-bin/webwxgeticon?seq=624980050&username=@faca92b30740d481d3e5fdd82dcb5371&skey=@crypt_fe88845f_8a30b4d995e3ba5ea73d81525eaa4698", "ContactFlag": 3, "MemberCount": 0, "RemarkName": "", "HideInputBarFlag": 0, "Sex": 1, "Signature": "Let`s go somewhere furher", "VerifyFlag": 0, "OwnerUin": 0, "PYInitial": "JG", "PYQuanPin": "jiuge", "RemarkPYInitial": "", "RemarkPYQuanPin": "", "StarFriend": 0, "AppAccountFlag": 0, "Statues": 0, "AttrStatus": 16880959, "Province": "上海", "City": "长宁", "Alias": "", "SnsFlag": 273, "UniFriend": 0, "DisplayName": "", "ChatRoomId": 0, "KeyWord": "sho", "EncryChatRoomId": "", "IsOwner": 0}, "Type": "Text", "Text": "你好"}, cmsg=ChatMessage: id=3016408735286874302, create_time=1735123403, ctype=TEXT, content=你好, from_user_id=@faca92b30740d481d3e5fdd82dcb5371, from_user_nickname=九歌, to_user_id=@619fc8c7e97811c1d0683e51d0e912730eee5c6c2bb9b3b2602a644709993fba, to_user_nickname=学习小助手, other_user_id=@faca92b30740d481d3e5fdd82dcb5371, other_user_nickname=九歌, is_group=False, is_at=False, actual_user_id=None, actual_user_nickname=None, at_list=None
[INFO][2024-12-25 18:43:24][wechat_channel.py:187] - _compose_context后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x107ab9cf0>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@faca92b30740d481d3e5fdd82dcb5371', 'receiver': '@faca92b30740d481d3e5fdd82dcb5371'})
[INFO][2024-12-25 18:43:24][wechat_channel.py:190] - produce后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x107ab9cf0>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@faca92b30740d481d3e5fdd82dcb5371', 'receiver': '@faca92b30740d481d3e5fdd82dcb5371'})
[INFO][2024-12-25 18:43:24][bridge.py:68] - create bot moonshot for chat
[INFO][2024-12-25 18:43:24][bridge.py:83] - 模型回复内容query: 你好  context type: TEXT
[INFO][2024-12-25 18:43:24][moonshot_bot.py:36] - [MOONSHOT_AI] query=你好
[INFO][2024-12-25 18:43:24][moonshot_bot.py:53] - [MOONSHOT_AI] session query=[{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '你好'}]
[INFO][2024-12-25 18:43:24][moonshot_bot.py:146] - messages: [{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '你好'}]
[INFO][2024-12-25 18:43:24][moonshot_bot.py:154] - res: <Response [422]>
[ERROR][2024-12-25 18:43:24][moonshot_bot.py:188] - 'NoneType' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 166, in reply_text
    f"msg={error.get('message')}, type={error.get('type')}")
AttributeError: 'NoneType' object has no attribute 'get'
[INFO][2024-12-25 18:43:24][moonshot_bot.py:146] - messages: [{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '你好'}]
[INFO][2024-12-25 18:43:24][moonshot_bot.py:154] - res: <Response [422]>
[ERROR][2024-12-25 18:43:24][moonshot_bot.py:188] - 'NoneType' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 166, in reply_text
    f"msg={error.get('message')}, type={error.get('type')}")
AttributeError: 'NoneType' object has no attribute 'get'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 166, in reply_text
    f"msg={error.get('message')}, type={error.get('type')}")
AttributeError: 'NoneType' object has no attribute 'get'
[INFO][2024-12-25 18:43:24][moonshot_bot.py:146] - messages: [{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '你好'}]
[INFO][2024-12-25 18:43:24][moonshot_bot.py:154] - res: <Response [422]>
[ERROR][2024-12-25 18:43:24][moonshot_bot.py:188] - 'NoneType' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 166, in reply_text
    f"msg={error.get('message')}, type={error.get('type')}")
AttributeError: 'NoneType' object has no attribute 'get'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 166, in reply_text
    f"msg={error.get('message')}, type={error.get('type')}")
AttributeError: 'NoneType' object has no attribute 'get'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 166, in reply_text
    f"msg={error.get('message')}, type={error.get('type')}")
AttributeError: 'NoneType' object has no attribute 'get'
[INFO][2024-12-25 18:43:24][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@faca92b30740d481d3e5fdd82dcb5371
[INFO][2024-12-25 18:43:25][wechat_channel.py:225] - [WX] sendMsg=Reply(type=ERROR, content=[ERROR]
我现在有点累了，等会再来吧), receiver=@faca92b30740d481d3e5fdd82dcb5371
[INFO][2024-12-25 18:46:56][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 18:46:56][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 18:46:57][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 18:46:57][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 18:46:59][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': 'math-assistant', 'open_ai_api_key': 'YOU*****KEY', 'claude_api_key': 'YOU*****KEY', 'bot_type': 'moonshot', 'moonshot_api_key': 'sk-*****9QE', 'moonshot_base_url': 'http://1.92.69.23:12003/v1/chat/completions', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': [''], 'single_chat_reply_prefix': '', 'group_chat_prefix': ['@学习小助手'], 'group_name_white_list': ['ALL_GROUP'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': ''}
[INFO][2024-12-25 18:46:59][config.py:224] - [Config] User datas loaded.
[INFO][2024-12-25 18:47:00][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 18:47:00][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 18:47:00][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 18:47:00][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 18:47:00][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 18:47:00][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 18:47:00][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 18:47:00][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 18:47:00][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 18:47:00][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 18:47:00][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 18:47:00][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[INFO][2024-12-25 18:47:00][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为0247。
[INFO][2024-12-25 18:47:00][godcmd.py:210] - [Godcmd] inited
[INFO][2024-12-25 18:47:00][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 18:47:00][keyword.py:42] - [keyword] inited.
[INFO][2024-12-25 18:47:00][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[INFO][2024-12-25 18:47:00][role.py:69] - [Role] inited
[INFO][2024-12-25 18:47:00][dungeon.py:56] - [Dungeon] inited
[INFO][2024-12-25 18:47:00][hello.py:38] - [Hello] inited
[INFO][2024-12-25 18:47:00][finish.py:23] - [Finish] inited
[INFO][2024-12-25 18:47:23][wechat_channel.py:134] - Wechat login success, user_id: @06c8a6e400801b57e9451ae7b82ec7c3392d46eaa494ed05f7cc5c44bb6d9c1b, nickname: 学习小助手
[INFO][2024-12-25 18:47:28][wechat_channel.py:183] - [WX]receive text msg: {"MsgId": "2143327220595288723", "FromUserName": "@02a0c2c7845e2627c4fc4778e472a0de", "ToUserName": "@06c8a6e400801b57e9451ae7b82ec7c3392d46eaa494ed05f7cc5c44bb6d9c1b", "MsgType": 1, "Content": "你好", "Status": 3, "ImgStatus": 1, "CreateTime": 1735123647, "VoiceLength": 0, "PlayLength": 0, "FileName": "", "FileSize": "", "MediaId": "", "Url": "", "AppMsgType": 0, "StatusNotifyCode": 0, "StatusNotifyUserName": "", "RecommendInfo": {"UserName": "", "NickName": "", "QQNum": 0, "Province": "", "City": "", "Content": "", "Signature": "", "Alias": "", "Scene": 0, "VerifyFlag": 0, "AttrStatus": 0, "Sex": 0, "Ticket": "", "OpCode": 0}, "ForwardFlag": 0, "AppInfo": {"AppID": "", "Type": 0}, "HasProductId": 0, "Ticket": "", "ImgHeight": 0, "ImgWidth": 0, "SubMsgType": 0, "NewMsgId": 2143327220595288723, "OriContent": "", "EncryFileName": "", "User": {"MemberList": [], "Uin": 0, "UserName": "@02a0c2c7845e2627c4fc4778e472a0de", "NickName": "九歌", "HeadImgUrl": "/cgi-bin/mmwebwx-bin/webwxgeticon?seq=624980050&username=@02a0c2c7845e2627c4fc4778e472a0de&skey=@crypt_fe88845f_f9132527ce6551b5bff3397e93f84a82", "ContactFlag": 3, "MemberCount": 0, "RemarkName": "", "HideInputBarFlag": 0, "Sex": 1, "Signature": "Let`s go somewhere furher", "VerifyFlag": 0, "OwnerUin": 0, "PYInitial": "JG", "PYQuanPin": "jiuge", "RemarkPYInitial": "", "RemarkPYQuanPin": "", "StarFriend": 0, "AppAccountFlag": 0, "Statues": 0, "AttrStatus": 16880959, "Province": "上海", "City": "长宁", "Alias": "", "SnsFlag": 273, "UniFriend": 0, "DisplayName": "", "ChatRoomId": 0, "KeyWord": "sho", "EncryChatRoomId": "", "IsOwner": 0}, "Type": "Text", "Text": "你好"}, cmsg=ChatMessage: id=2143327220595288723, create_time=1735123647, ctype=TEXT, content=你好, from_user_id=@02a0c2c7845e2627c4fc4778e472a0de, from_user_nickname=九歌, to_user_id=@06c8a6e400801b57e9451ae7b82ec7c3392d46eaa494ed05f7cc5c44bb6d9c1b, to_user_nickname=学习小助手, other_user_id=@02a0c2c7845e2627c4fc4778e472a0de, other_user_nickname=九歌, is_group=False, is_at=False, actual_user_id=None, actual_user_nickname=None, at_list=None
[INFO][2024-12-25 18:47:28][wechat_channel.py:187] - _compose_context后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x1057b5840>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@02a0c2c7845e2627c4fc4778e472a0de', 'receiver': '@02a0c2c7845e2627c4fc4778e472a0de'})
[INFO][2024-12-25 18:47:28][wechat_channel.py:190] - produce后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x1057b5840>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@02a0c2c7845e2627c4fc4778e472a0de', 'receiver': '@02a0c2c7845e2627c4fc4778e472a0de'})
[INFO][2024-12-25 18:47:28][bridge.py:68] - create bot moonshot for chat
[INFO][2024-12-25 18:47:28][bridge.py:83] - 模型回复内容query: 你好  context type: TEXT
[INFO][2024-12-25 18:47:28][moonshot_bot.py:36] - [MOONSHOT_AI] query=你好
[INFO][2024-12-25 18:47:28][moonshot_bot.py:53] - [MOONSHOT_AI] session query=[{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '你好'}]
[INFO][2024-12-25 18:47:28][moonshot_bot.py:146] - messages: [{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '你好'}]
[INFO][2024-12-25 18:47:31][moonshot_bot.py:154] - res: <Response [200]>
[INFO][2024-12-25 18:47:31][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@02a0c2c7845e2627c4fc4778e472a0de
[INFO][2024-12-25 18:47:31][wechat_channel.py:221] - [WX] sendMsg=Reply(type=TEXT, content=哈哈，你好呀，有什么数学方面的问题或者需要我帮忙的地方呀，随时都可以和我说。), receiver=@02a0c2c7845e2627c4fc4778e472a0de
[INFO][2024-12-25 18:47:51][wechat_channel.py:183] - [WX]receive text msg: {"MsgId": "5130879797232061845", "FromUserName": "@02a0c2c7845e2627c4fc4778e472a0de", "ToUserName": "@06c8a6e400801b57e9451ae7b82ec7c3392d46eaa494ed05f7cc5c44bb6d9c1b", "MsgType": 1, "Content": "1+1等于多少", "Status": 3, "ImgStatus": 1, "CreateTime": 1735123670, "VoiceLength": 0, "PlayLength": 0, "FileName": "", "FileSize": "", "MediaId": "", "Url": "", "AppMsgType": 0, "StatusNotifyCode": 0, "StatusNotifyUserName": "", "RecommendInfo": {"UserName": "", "NickName": "", "QQNum": 0, "Province": "", "City": "", "Content": "", "Signature": "", "Alias": "", "Scene": 0, "VerifyFlag": 0, "AttrStatus": 0, "Sex": 0, "Ticket": "", "OpCode": 0}, "ForwardFlag": 0, "AppInfo": {"AppID": "", "Type": 0}, "HasProductId": 0, "Ticket": "", "ImgHeight": 0, "ImgWidth": 0, "SubMsgType": 0, "NewMsgId": 5130879797232061845, "OriContent": "", "EncryFileName": "", "User": {"MemberList": [], "Uin": 0, "UserName": "@02a0c2c7845e2627c4fc4778e472a0de", "NickName": "九歌", "HeadImgUrl": "/cgi-bin/mmwebwx-bin/webwxgeticon?seq=624980050&username=@02a0c2c7845e2627c4fc4778e472a0de&skey=@crypt_fe88845f_f9132527ce6551b5bff3397e93f84a82", "ContactFlag": 3, "MemberCount": 0, "RemarkName": "", "HideInputBarFlag": 0, "Sex": 1, "Signature": "Let`s go somewhere furher", "VerifyFlag": 0, "OwnerUin": 0, "PYInitial": "JG", "PYQuanPin": "jiuge", "RemarkPYInitial": "", "RemarkPYQuanPin": "", "StarFriend": 0, "AppAccountFlag": 0, "Statues": 0, "AttrStatus": 16880959, "Province": "上海", "City": "长宁", "Alias": "", "SnsFlag": 273, "UniFriend": 0, "DisplayName": "", "ChatRoomId": 0, "KeyWord": "sho", "EncryChatRoomId": "", "IsOwner": 0}, "Type": "Text", "Text": "1+1等于多少"}, cmsg=ChatMessage: id=5130879797232061845, create_time=1735123670, ctype=TEXT, content=1+1等于多少, from_user_id=@02a0c2c7845e2627c4fc4778e472a0de, from_user_nickname=九歌, to_user_id=@06c8a6e400801b57e9451ae7b82ec7c3392d46eaa494ed05f7cc5c44bb6d9c1b, to_user_nickname=学习小助手, other_user_id=@02a0c2c7845e2627c4fc4778e472a0de, other_user_nickname=九歌, is_group=False, is_at=False, actual_user_id=None, actual_user_nickname=None, at_list=None
[INFO][2024-12-25 18:47:51][wechat_channel.py:187] - _compose_context后的 context: Context(type=TEXT, content=1+1等于多少, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x1057b6200>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@02a0c2c7845e2627c4fc4778e472a0de', 'receiver': '@02a0c2c7845e2627c4fc4778e472a0de'})
[INFO][2024-12-25 18:47:51][wechat_channel.py:190] - produce后的 context: Context(type=TEXT, content=1+1等于多少, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x1057b6200>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@02a0c2c7845e2627c4fc4778e472a0de', 'receiver': '@02a0c2c7845e2627c4fc4778e472a0de'})
[INFO][2024-12-25 18:47:51][bridge.py:83] - 模型回复内容query: 1+1等于多少  context type: TEXT
[INFO][2024-12-25 18:47:51][moonshot_bot.py:36] - [MOONSHOT_AI] query=1+1等于多少
[INFO][2024-12-25 18:47:51][moonshot_bot.py:53] - [MOONSHOT_AI] session query=[{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '你好'}, {'role': 'assistant', 'content': '哈哈，你好呀，有什么数学方面的问题或者需要我帮忙的地方呀，随时都可以和我说。'}, {'role': 'user', 'content': '1+1等于多少'}]
[INFO][2024-12-25 18:47:51][moonshot_bot.py:146] - messages: [{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '你好'}, {'role': 'assistant', 'content': '哈哈，你好呀，有什么数学方面的问题或者需要我帮忙的地方呀，随时都可以和我说。'}, {'role': 'user', 'content': '1+1等于多少'}]
[INFO][2024-12-25 18:47:55][moonshot_bot.py:154] - res: <Response [200]>
[INFO][2024-12-25 18:47:55][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@02a0c2c7845e2627c4fc4778e472a0de
[INFO][2024-12-25 18:47:56][wechat_channel.py:221] - [WX] sendMsg=Reply(type=TEXT, content=<|InnerThoughtBegin|>当前提供了5个技能，分别是["问题解答", "课堂笔记辅导", "制作知识点复习卡片", "课后作业支持", "错题练习"]，用户需求为计算1+1等于多少，需要调用问题解答技能<|InnerThoughtEnd|><|FunctionCallBegin|>[
{"name": "回答问题", "parameters": {"question": "1+1等于多少"}}
]<|FunctionCallEnd|>), receiver=@02a0c2c7845e2627c4fc4778e472a0de
[INFO][2024-12-25 18:48:12][wechat_channel.py:179] - [WX]receive image msg: tmp/241225-184812.png
[INFO][2024-12-25 18:48:12][wechat_channel.py:187] - _compose_context后的 context: Context(type=IMAGE, content=tmp/241225-184812.png, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x1057b5de0>, 'origin_ctype': <ContextType.IMAGE: 3>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@02a0c2c7845e2627c4fc4778e472a0de', 'receiver': '@02a0c2c7845e2627c4fc4778e472a0de'})
[INFO][2024-12-25 18:48:12][wechat_channel.py:190] - produce后的 context: Context(type=IMAGE, content=tmp/241225-184812.png, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x1057b5de0>, 'origin_ctype': <ContextType.IMAGE: 3>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@02a0c2c7845e2627c4fc4778e472a0de', 'receiver': '@02a0c2c7845e2627c4fc4778e472a0de'})
[INFO][2024-12-25 18:48:12][bridge.py:83] - 模型回复内容query: tmp/241225-184812.png  context type: IMAGE
[INFO][2024-12-25 18:48:12][moonshot_bot.py:82] - [MOONSHOT_AI] query=tmp/241225-184812.png
[INFO][2024-12-25 18:48:12][moonshot_bot.py:98] - [MOONSHOT_AI] session query=[{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '你好'}, {'role': 'assistant', 'content': '哈哈，你好呀，有什么数学方面的问题或者需要我帮忙的地方呀，随时都可以和我说。'}, {'role': 'user', 'content': '1+1等于多少'}, {'role': 'assistant', 'content': '<|InnerThoughtBegin|>当前提供了5个技能，分别是["问题解答", "课堂笔记辅导", "制作知识点复习卡片", "课后作业支持", "错题练习"]，用户需求为计算1+1等于多少，需要调用问题解答技能<|InnerThoughtEnd|><|FunctionCallBegin|>[\n{"name": "回答问题", "parameters": {"question": "1+1等于多少"}}\n]<|FunctionCallEnd|>'}, {'role': 'user', 'content': 'tmp/241225-184812.png'}]
[ERROR][2024-12-25 18:48:12][moonshot_bot.py:251] - 'NoneType' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 229, in reply_image
    f"msg={error.get('message')}, type={error.get('type')}")
AttributeError: 'NoneType' object has no attribute 'get'
[INFO][2024-12-25 18:48:12][moonshot_bot.py:146] - messages: [{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '你好'}, {'role': 'assistant', 'content': '哈哈，你好呀，有什么数学方面的问题或者需要我帮忙的地方呀，随时都可以和我说。'}, {'role': 'user', 'content': '1+1等于多少'}, {'role': 'assistant', 'content': '<|InnerThoughtBegin|>当前提供了5个技能，分别是["问题解答", "课堂笔记辅导", "制作知识点复习卡片", "课后作业支持", "错题练习"]，用户需求为计算1+1等于多少，需要调用问题解答技能<|InnerThoughtEnd|><|FunctionCallBegin|>[\n{"name": "回答问题", "parameters": {"question": "1+1等于多少"}}\n]<|FunctionCallEnd|>'}, {'role': 'user', 'content': 'tmp/241225-184812.png'}]
[INFO][2024-12-25 18:48:17][moonshot_bot.py:154] - res: <Response [200]>
[INFO][2024-12-25 18:48:17][moonshot_bot.py:125] - 已经获取到图片
[INFO][2024-12-25 18:48:17][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@02a0c2c7845e2627c4fc4778e472a0de
[INFO][2024-12-25 18:48:18][wechat_channel.py:221] - [WX] sendMsg=Reply(type=TEXT, content=哎呀呀，你怎么给我发了一张图片呀，快和我说说你在数学学习上有什么问题或者需要我帮你做些什么呀，比如解答问题、辅导课堂笔记、制作知识点复习卡片等等。), receiver=@02a0c2c7845e2627c4fc4778e472a0de
[INFO][2024-12-25 18:57:19][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 18:57:19][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 18:57:19][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 18:57:19][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 18:57:22][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': 'math-assistant', 'open_ai_api_key': 'YOU*****KEY', 'claude_api_key': 'YOU*****KEY', 'bot_type': 'moonshot', 'moonshot_api_key': 'sk-*****9QE', 'moonshot_base_url': 'http://1.92.69.23:12003/v1/chat/completions', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': [''], 'single_chat_reply_prefix': '', 'group_chat_prefix': ['@学习小助手'], 'group_name_white_list': ['ALL_GROUP'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': ''}
[INFO][2024-12-25 18:57:22][config.py:224] - [Config] User datas loaded.
[INFO][2024-12-25 18:57:22][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 18:57:22][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 18:57:22][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 18:57:22][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 18:57:22][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 18:57:22][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 18:57:22][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 18:57:22][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 18:57:22][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 18:57:22][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 18:57:22][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 18:57:22][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[INFO][2024-12-25 18:57:22][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为0716。
[INFO][2024-12-25 18:57:22][godcmd.py:210] - [Godcmd] inited
[INFO][2024-12-25 18:57:22][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 18:57:22][keyword.py:42] - [keyword] inited.
[INFO][2024-12-25 18:57:22][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[INFO][2024-12-25 18:57:22][role.py:69] - [Role] inited
[INFO][2024-12-25 18:57:22][dungeon.py:56] - [Dungeon] inited
[INFO][2024-12-25 18:57:22][hello.py:38] - [Hello] inited
[INFO][2024-12-25 18:57:22][finish.py:23] - [Finish] inited
[INFO][2024-12-25 18:57:44][wechat_channel.py:134] - Wechat login success, user_id: @6a9fc7f1437efa994ad22f94533f3add93dbbac8d156dca77cb43e44c5dea3d7, nickname: 学习小助手
[INFO][2024-12-25 18:57:52][wechat_channel.py:183] - [WX]receive text msg: {"MsgId": "8162393689836071100", "FromUserName": "@3e0d5ebdc20ac5170959ae4dee7d216e", "ToUserName": "@6a9fc7f1437efa994ad22f94533f3add93dbbac8d156dca77cb43e44c5dea3d7", "MsgType": 1, "Content": "你好", "Status": 3, "ImgStatus": 1, "CreateTime": 1735124271, "VoiceLength": 0, "PlayLength": 0, "FileName": "", "FileSize": "", "MediaId": "", "Url": "", "AppMsgType": 0, "StatusNotifyCode": 0, "StatusNotifyUserName": "", "RecommendInfo": {"UserName": "", "NickName": "", "QQNum": 0, "Province": "", "City": "", "Content": "", "Signature": "", "Alias": "", "Scene": 0, "VerifyFlag": 0, "AttrStatus": 0, "Sex": 0, "Ticket": "", "OpCode": 0}, "ForwardFlag": 0, "AppInfo": {"AppID": "", "Type": 0}, "HasProductId": 0, "Ticket": "", "ImgHeight": 0, "ImgWidth": 0, "SubMsgType": 0, "NewMsgId": 8162393689836071100, "OriContent": "", "EncryFileName": "", "User": {"MemberList": [], "Uin": 0, "UserName": "@3e0d5ebdc20ac5170959ae4dee7d216e", "NickName": "九歌", "HeadImgUrl": "/cgi-bin/mmwebwx-bin/webwxgeticon?seq=624980050&username=@3e0d5ebdc20ac5170959ae4dee7d216e&skey=@crypt_fe88845f_053f72f577a65ccf72d38bb2448a98e6", "ContactFlag": 3, "MemberCount": 0, "RemarkName": "", "HideInputBarFlag": 0, "Sex": 1, "Signature": "Let`s go somewhere furher", "VerifyFlag": 0, "OwnerUin": 0, "PYInitial": "JG", "PYQuanPin": "jiuge", "RemarkPYInitial": "", "RemarkPYQuanPin": "", "StarFriend": 0, "AppAccountFlag": 0, "Statues": 0, "AttrStatus": 16880959, "Province": "上海", "City": "长宁", "Alias": "", "SnsFlag": 273, "UniFriend": 0, "DisplayName": "", "ChatRoomId": 0, "KeyWord": "sho", "EncryChatRoomId": "", "IsOwner": 0}, "Type": "Text", "Text": "你好"}, cmsg=ChatMessage: id=8162393689836071100, create_time=1735124271, ctype=TEXT, content=你好, from_user_id=@3e0d5ebdc20ac5170959ae4dee7d216e, from_user_nickname=九歌, to_user_id=@6a9fc7f1437efa994ad22f94533f3add93dbbac8d156dca77cb43e44c5dea3d7, to_user_nickname=学习小助手, other_user_id=@3e0d5ebdc20ac5170959ae4dee7d216e, other_user_nickname=九歌, is_group=False, is_at=False, actual_user_id=None, actual_user_nickname=None, at_list=None
[INFO][2024-12-25 18:57:52][wechat_channel.py:187] - _compose_context后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x1043b61a0>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@3e0d5ebdc20ac5170959ae4dee7d216e', 'receiver': '@3e0d5ebdc20ac5170959ae4dee7d216e'})
[INFO][2024-12-25 18:57:52][wechat_channel.py:190] - produce后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x1043b61a0>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@3e0d5ebdc20ac5170959ae4dee7d216e', 'receiver': '@3e0d5ebdc20ac5170959ae4dee7d216e'})
[INFO][2024-12-25 18:57:52][bridge.py:68] - create bot moonshot for chat
[INFO][2024-12-25 18:57:53][bridge.py:83] - 模型回复内容query: 你好  context type: TEXT
[INFO][2024-12-25 18:57:53][moonshot_bot.py:36] - [MOONSHOT_AI] query=你好
[INFO][2024-12-25 18:57:53][moonshot_bot.py:53] - [MOONSHOT_AI] session query=[{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '你好'}]
[INFO][2024-12-25 18:57:53][moonshot_bot.py:146] - 输入大模型的messages: [{'role': 'user', 'content': '你好'}]
[INFO][2024-12-25 18:57:55][moonshot_bot.py:154] - res: <Response [200]>
[INFO][2024-12-25 18:57:55][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@3e0d5ebdc20ac5170959ae4dee7d216e
[INFO][2024-12-25 18:57:55][wechat_channel.py:221] - [WX] sendMsg=Reply(type=TEXT, content=你好呀，有什么数学方面的问题或者需要我帮助的地方都可以随时和我说哦。), receiver=@3e0d5ebdc20ac5170959ae4dee7d216e
[INFO][2024-12-25 18:58:12][wechat_channel.py:183] - [WX]receive text msg: {"MsgId": "499381692156341677", "FromUserName": "@3e0d5ebdc20ac5170959ae4dee7d216e", "ToUserName": "@6a9fc7f1437efa994ad22f94533f3add93dbbac8d156dca77cb43e44c5dea3d7", "MsgType": 1, "Content": "1+1等于多少", "Status": 3, "ImgStatus": 1, "CreateTime": 1735124291, "VoiceLength": 0, "PlayLength": 0, "FileName": "", "FileSize": "", "MediaId": "", "Url": "", "AppMsgType": 0, "StatusNotifyCode": 0, "StatusNotifyUserName": "", "RecommendInfo": {"UserName": "", "NickName": "", "QQNum": 0, "Province": "", "City": "", "Content": "", "Signature": "", "Alias": "", "Scene": 0, "VerifyFlag": 0, "AttrStatus": 0, "Sex": 0, "Ticket": "", "OpCode": 0}, "ForwardFlag": 0, "AppInfo": {"AppID": "", "Type": 0}, "HasProductId": 0, "Ticket": "", "ImgHeight": 0, "ImgWidth": 0, "SubMsgType": 0, "NewMsgId": 499381692156341677, "OriContent": "", "EncryFileName": "", "User": {"MemberList": [], "Uin": 0, "UserName": "@3e0d5ebdc20ac5170959ae4dee7d216e", "NickName": "九歌", "HeadImgUrl": "/cgi-bin/mmwebwx-bin/webwxgeticon?seq=624980050&username=@3e0d5ebdc20ac5170959ae4dee7d216e&skey=@crypt_fe88845f_053f72f577a65ccf72d38bb2448a98e6", "ContactFlag": 3, "MemberCount": 0, "RemarkName": "", "HideInputBarFlag": 0, "Sex": 1, "Signature": "Let`s go somewhere furher", "VerifyFlag": 0, "OwnerUin": 0, "PYInitial": "JG", "PYQuanPin": "jiuge", "RemarkPYInitial": "", "RemarkPYQuanPin": "", "StarFriend": 0, "AppAccountFlag": 0, "Statues": 0, "AttrStatus": 16880959, "Province": "上海", "City": "长宁", "Alias": "", "SnsFlag": 273, "UniFriend": 0, "DisplayName": "", "ChatRoomId": 0, "KeyWord": "sho", "EncryChatRoomId": "", "IsOwner": 0}, "Type": "Text", "Text": "1+1等于多少"}, cmsg=ChatMessage: id=499381692156341677, create_time=1735124291, ctype=TEXT, content=1+1等于多少, from_user_id=@3e0d5ebdc20ac5170959ae4dee7d216e, from_user_nickname=九歌, to_user_id=@6a9fc7f1437efa994ad22f94533f3add93dbbac8d156dca77cb43e44c5dea3d7, to_user_nickname=学习小助手, other_user_id=@3e0d5ebdc20ac5170959ae4dee7d216e, other_user_nickname=九歌, is_group=False, is_at=False, actual_user_id=None, actual_user_nickname=None, at_list=None
[INFO][2024-12-25 18:58:12][wechat_channel.py:187] - _compose_context后的 context: Context(type=TEXT, content=1+1等于多少, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x1043b5900>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@3e0d5ebdc20ac5170959ae4dee7d216e', 'receiver': '@3e0d5ebdc20ac5170959ae4dee7d216e'})
[INFO][2024-12-25 18:58:12][wechat_channel.py:190] - produce后的 context: Context(type=TEXT, content=1+1等于多少, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x1043b5900>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@3e0d5ebdc20ac5170959ae4dee7d216e', 'receiver': '@3e0d5ebdc20ac5170959ae4dee7d216e'})
[INFO][2024-12-25 18:58:12][bridge.py:83] - 模型回复内容query: 1+1等于多少  context type: TEXT
[INFO][2024-12-25 18:58:12][moonshot_bot.py:36] - [MOONSHOT_AI] query=1+1等于多少
[INFO][2024-12-25 18:58:12][moonshot_bot.py:53] - [MOONSHOT_AI] session query=[{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '你好'}, {'role': 'assistant', 'content': '你好呀，有什么数学方面的问题或者需要我帮助的地方都可以随时和我说哦。'}, {'role': 'user', 'content': '1+1等于多少'}]
[INFO][2024-12-25 18:58:12][moonshot_bot.py:146] - 输入大模型的messages: [{'role': 'user', 'content': '你好'}, {'role': 'assistant', 'content': '你好呀，有什么数学方面的问题或者需要我帮助的地方都可以随时和我说哦。'}, {'role': 'user', 'content': '1+1等于多少'}]
[INFO][2024-12-25 18:58:16][moonshot_bot.py:154] - res: <Response [200]>
[INFO][2024-12-25 18:58:16][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@3e0d5ebdc20ac5170959ae4dee7d216e
[INFO][2024-12-25 18:58:17][wechat_channel.py:221] - [WX] sendMsg=Reply(type=TEXT, content=<|InnerThoughtBegin|>当前提供了5个技能，分别是["问题解答", "课堂笔记辅导", "制作知识点复习卡片", "课后作业支持", "错题练习"]，用户需求为询问1+1等于多少，需要调用问题解答技能<|InnerThoughtEnd|><|FunctionCallBegin|>[
{"name": "回答问题", "parameters": {"question": "1+1等于多少"}}
]<|FunctionCallEnd|>), receiver=@3e0d5ebdc20ac5170959ae4dee7d216e
[INFO][2024-12-25 18:58:26][wechat_channel.py:179] - [WX]receive image msg: tmp/241225-185826.png
[INFO][2024-12-25 18:58:26][wechat_channel.py:187] - _compose_context后的 context: Context(type=IMAGE, content=tmp/241225-185826.png, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x1043b6440>, 'origin_ctype': <ContextType.IMAGE: 3>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@3e0d5ebdc20ac5170959ae4dee7d216e', 'receiver': '@3e0d5ebdc20ac5170959ae4dee7d216e'})
[INFO][2024-12-25 18:58:26][wechat_channel.py:190] - produce后的 context: Context(type=IMAGE, content=tmp/241225-185826.png, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x1043b6440>, 'origin_ctype': <ContextType.IMAGE: 3>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@3e0d5ebdc20ac5170959ae4dee7d216e', 'receiver': '@3e0d5ebdc20ac5170959ae4dee7d216e'})
[INFO][2024-12-25 18:58:26][bridge.py:83] - 模型回复内容query: tmp/241225-185826.png  context type: IMAGE
[INFO][2024-12-25 18:58:26][moonshot_bot.py:82] - [MOONSHOT_AI] query=tmp/241225-185826.png
[INFO][2024-12-25 18:58:26][moonshot_bot.py:98] - [MOONSHOT_AI] session query=[{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '你好'}, {'role': 'assistant', 'content': '你好呀，有什么数学方面的问题或者需要我帮助的地方都可以随时和我说哦。'}, {'role': 'user', 'content': '1+1等于多少'}, {'role': 'assistant', 'content': '<|InnerThoughtBegin|>当前提供了5个技能，分别是["问题解答", "课堂笔记辅导", "制作知识点复习卡片", "课后作业支持", "错题练习"]，用户需求为询问1+1等于多少，需要调用问题解答技能<|InnerThoughtEnd|><|FunctionCallBegin|>[\n{"name": "回答问题", "parameters": {"question": "1+1等于多少"}}\n]<|FunctionCallEnd|>'}, {'role': 'user', 'content': 'tmp/241225-185826.png'}]
[INFO][2024-12-25 18:58:26][moonshot_bot.py:211] - 输入大模型的messages: [{'role': 'user', 'content': [{'type': 'text', 'text': '你好'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': '你好呀，有什么数学方面的问题或者需要我帮助的地方都可以随时和我说哦。'}]}, {'role': 'user', 'content': [{'type': 'text', 'text': '1+1等于多少'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': '<|InnerThoughtBegin|>当前提供了5个技能，分别是["问题解答", "课堂笔记辅导", "制作知识点复习卡片", "课后作业支持", "错题练习"]，用户需求为询问1+1等于多少，需要调用问题解答技能<|InnerThoughtEnd|><|FunctionCallBegin|>[\n{"name": "回答问题", "parameters": {"question": "1+1等于多少"}}\n]<|FunctionCallEnd|>'}]}, {'role': 'user', 'content': [{'type': 'text', 'text': '根据上下文解读图片内容'}, {'type': 'image_url', 'image_url': 'tmp/241225-185826.png'}]}]
[ERROR][2024-12-25 18:58:26][moonshot_bot.py:252] - 'NoneType' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 230, in reply_image
    f"msg={error.get('message')}, type={error.get('type')}")
AttributeError: 'NoneType' object has no attribute 'get'
[INFO][2024-12-25 18:58:26][moonshot_bot.py:146] - 输入大模型的messages: [{'role': 'user', 'content': '你好'}, {'role': 'assistant', 'content': '你好呀，有什么数学方面的问题或者需要我帮助的地方都可以随时和我说哦。'}, {'role': 'user', 'content': '1+1等于多少'}, {'role': 'assistant', 'content': '<|InnerThoughtBegin|>当前提供了5个技能，分别是["问题解答", "课堂笔记辅导", "制作知识点复习卡片", "课后作业支持", "错题练习"]，用户需求为询问1+1等于多少，需要调用问题解答技能<|InnerThoughtEnd|><|FunctionCallBegin|>[\n{"name": "回答问题", "parameters": {"question": "1+1等于多少"}}\n]<|FunctionCallEnd|>'}, {'role': 'user', 'content': 'tmp/241225-185826.png'}]
[INFO][2024-12-25 18:58:30][moonshot_bot.py:154] - res: <Response [200]>
[INFO][2024-12-25 18:58:30][moonshot_bot.py:125] - 已经获取到图片
[INFO][2024-12-25 18:58:30][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@3e0d5ebdc20ac5170959ae4dee7d216e
[INFO][2024-12-25 18:58:30][wechat_channel.py:221] - [WX] sendMsg=Reply(type=TEXT, content=哎呀呀，你给我发了一张图片呀，不过我没办法直接看到图片内容呢，你可以和我说说图片上是关于什么数学内容的呀，比如是一道数学题、一些数学图形等等，我来帮助你。), receiver=@3e0d5ebdc20ac5170959ae4dee7d216e
[INFO][2024-12-25 19:03:50][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 19:03:50][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 19:03:52][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 19:03:52][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 19:03:55][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': 'math-assistant', 'open_ai_api_key': 'YOU*****KEY', 'claude_api_key': 'YOU*****KEY', 'bot_type': 'moonshot', 'moonshot_api_key': 'sk-*****9QE', 'moonshot_base_url': 'http://1.92.69.23:12003/v1/chat/completions', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': [''], 'single_chat_reply_prefix': '', 'group_chat_prefix': ['@学习小助手'], 'group_name_white_list': ['ALL_GROUP'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': ''}
[INFO][2024-12-25 19:03:55][config.py:224] - [Config] User datas loaded.
[INFO][2024-12-25 19:03:55][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 19:03:55][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 19:03:55][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 19:03:55][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 19:03:55][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 19:03:55][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 19:03:55][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 19:03:55][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 19:03:55][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 19:03:55][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 19:03:55][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 19:03:55][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[INFO][2024-12-25 19:03:55][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为4179。
[INFO][2024-12-25 19:03:55][godcmd.py:210] - [Godcmd] inited
[INFO][2024-12-25 19:03:55][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 19:03:55][keyword.py:42] - [keyword] inited.
[INFO][2024-12-25 19:03:55][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[INFO][2024-12-25 19:03:55][role.py:69] - [Role] inited
[INFO][2024-12-25 19:03:55][dungeon.py:56] - [Dungeon] inited
[INFO][2024-12-25 19:03:55][hello.py:38] - [Hello] inited
[INFO][2024-12-25 19:03:55][finish.py:23] - [Finish] inited
[INFO][2024-12-25 19:04:21][wechat_channel.py:134] - Wechat login success, user_id: @d2c59525f473fe4284c1e937e9068de3845aced4ddf8ae0b3352fe6e5d0c6efb, nickname: 学习小助手
[INFO][2024-12-25 19:04:26][wechat_channel.py:183] - [WX]receive text msg: {"MsgId": "5254610088738682781", "FromUserName": "@634df92969407bc304a8a2747d3c6c3e", "ToUserName": "@d2c59525f473fe4284c1e937e9068de3845aced4ddf8ae0b3352fe6e5d0c6efb", "MsgType": 1, "Content": "你好", "Status": 3, "ImgStatus": 1, "CreateTime": 1735124666, "VoiceLength": 0, "PlayLength": 0, "FileName": "", "FileSize": "", "MediaId": "", "Url": "", "AppMsgType": 0, "StatusNotifyCode": 0, "StatusNotifyUserName": "", "RecommendInfo": {"UserName": "", "NickName": "", "QQNum": 0, "Province": "", "City": "", "Content": "", "Signature": "", "Alias": "", "Scene": 0, "VerifyFlag": 0, "AttrStatus": 0, "Sex": 0, "Ticket": "", "OpCode": 0}, "ForwardFlag": 0, "AppInfo": {"AppID": "", "Type": 0}, "HasProductId": 0, "Ticket": "", "ImgHeight": 0, "ImgWidth": 0, "SubMsgType": 0, "NewMsgId": 5254610088738682781, "OriContent": "", "EncryFileName": "", "User": {"MemberList": [], "Uin": 0, "UserName": "@634df92969407bc304a8a2747d3c6c3e", "NickName": "九歌", "HeadImgUrl": "/cgi-bin/mmwebwx-bin/webwxgeticon?seq=624980050&username=@634df92969407bc304a8a2747d3c6c3e&skey=@crypt_fe88845f_2198e712e4d4002fb2c7ec992b1cad77", "ContactFlag": 3, "MemberCount": 0, "RemarkName": "", "HideInputBarFlag": 0, "Sex": 1, "Signature": "Let`s go somewhere furher", "VerifyFlag": 0, "OwnerUin": 0, "PYInitial": "JG", "PYQuanPin": "jiuge", "RemarkPYInitial": "", "RemarkPYQuanPin": "", "StarFriend": 0, "AppAccountFlag": 0, "Statues": 0, "AttrStatus": 16880959, "Province": "上海", "City": "长宁", "Alias": "", "SnsFlag": 273, "UniFriend": 0, "DisplayName": "", "ChatRoomId": 0, "KeyWord": "sho", "EncryChatRoomId": "", "IsOwner": 0}, "Type": "Text", "Text": "你好"}, cmsg=ChatMessage: id=5254610088738682781, create_time=1735124666, ctype=TEXT, content=你好, from_user_id=@634df92969407bc304a8a2747d3c6c3e, from_user_nickname=九歌, to_user_id=@d2c59525f473fe4284c1e937e9068de3845aced4ddf8ae0b3352fe6e5d0c6efb, to_user_nickname=学习小助手, other_user_id=@634df92969407bc304a8a2747d3c6c3e, other_user_nickname=九歌, is_group=False, is_at=False, actual_user_id=None, actual_user_nickname=None, at_list=None
[INFO][2024-12-25 19:04:26][wechat_channel.py:187] - _compose_context后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x102be65c0>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@634df92969407bc304a8a2747d3c6c3e', 'receiver': '@634df92969407bc304a8a2747d3c6c3e'})
[INFO][2024-12-25 19:04:26][wechat_channel.py:190] - produce后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x102be65c0>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@634df92969407bc304a8a2747d3c6c3e', 'receiver': '@634df92969407bc304a8a2747d3c6c3e'})
[INFO][2024-12-25 19:04:26][bridge.py:68] - create bot moonshot for chat
[INFO][2024-12-25 19:04:27][bridge.py:83] - 模型回复内容query: 你好  context type: TEXT
[INFO][2024-12-25 19:04:27][moonshot_bot.py:36] - [MOONSHOT_AI] query=你好
[INFO][2024-12-25 19:04:27][moonshot_bot.py:53] - [MOONSHOT_AI] session query=[{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '你好'}]
[INFO][2024-12-25 19:04:27][moonshot_bot.py:146] - 输入大模型的文本messages: [{'role': 'user', 'content': '你好'}]
[INFO][2024-12-25 19:04:29][moonshot_bot.py:154] - res: <Response [200]>
[INFO][2024-12-25 19:04:29][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@634df92969407bc304a8a2747d3c6c3e
[INFO][2024-12-25 19:04:29][wechat_channel.py:221] - [WX] sendMsg=Reply(type=TEXT, content=哈哈，你好呀，有什么数学问题或者需要我帮忙的地方都可以随时和我说哦。), receiver=@634df92969407bc304a8a2747d3c6c3e
[INFO][2024-12-25 19:04:38][wechat_channel.py:179] - [WX]receive image msg: tmp/241225-190438.png
[INFO][2024-12-25 19:04:38][wechat_channel.py:187] - _compose_context后的 context: Context(type=IMAGE, content=tmp/241225-190438.png, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x102be64d0>, 'origin_ctype': <ContextType.IMAGE: 3>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@634df92969407bc304a8a2747d3c6c3e', 'receiver': '@634df92969407bc304a8a2747d3c6c3e'})
[INFO][2024-12-25 19:04:38][wechat_channel.py:190] - produce后的 context: Context(type=IMAGE, content=tmp/241225-190438.png, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x102be64d0>, 'origin_ctype': <ContextType.IMAGE: 3>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@634df92969407bc304a8a2747d3c6c3e', 'receiver': '@634df92969407bc304a8a2747d3c6c3e'})
[INFO][2024-12-25 19:04:38][bridge.py:83] - 模型回复内容query: tmp/241225-190438.png  context type: IMAGE
[INFO][2024-12-25 19:04:38][moonshot_bot.py:82] - [MOONSHOT_AI] query=tmp/241225-190438.png
[INFO][2024-12-25 19:04:38][moonshot_bot.py:98] - [MOONSHOT_AI] session query=[{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '你好'}, {'role': 'assistant', 'content': '哈哈，你好呀，有什么数学问题或者需要我帮忙的地方都可以随时和我说哦。'}, {'role': 'user', 'content': 'tmp/241225-190438.png'}]
[INFO][2024-12-25 19:04:38][moonshot_bot.py:107] - 开始reply_image...
[INFO][2024-12-25 19:04:38][moonshot_bot.py:211] - 输入大模型的多模态messages: [{'role': 'user', 'content': [{'type': 'text', 'text': '你好'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': '哈哈，你好呀，有什么数学问题或者需要我帮忙的地方都可以随时和我说哦。'}]}, {'role': 'user', 'content': [{'type': 'text', 'text': '根据上下文解读图片内容'}, {'type': 'image_url', 'image_url': 'tmp/241225-190438.png'}]}]
[ERROR][2024-12-25 19:04:38][moonshot_bot.py:252] - 'NoneType' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 230, in reply_image
    f"msg={error.get('message')}, type={error.get('type')}")
AttributeError: 'NoneType' object has no attribute 'get'
[INFO][2024-12-25 19:04:38][moonshot_bot.py:146] - 输入大模型的文本messages: [{'role': 'user', 'content': '你好'}, {'role': 'assistant', 'content': '哈哈，你好呀，有什么数学问题或者需要我帮忙的地方都可以随时和我说哦。'}, {'role': 'user', 'content': 'tmp/241225-190438.png'}]
[INFO][2024-12-25 19:04:41][moonshot_bot.py:154] - res: <Response [200]>
[INFO][2024-12-25 19:04:41][moonshot_bot.py:125] - 已经获取到图片
[INFO][2024-12-25 19:04:41][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@634df92969407bc304a8a2747d3c6c3e
[INFO][2024-12-25 19:04:42][wechat_channel.py:221] - [WX] sendMsg=Reply(type=TEXT, content=哎呀呀，我没办法直接看到图片呀，你可以和我描述一下图片上的内容或者是关于它的数学问题呀。), receiver=@634df92969407bc304a8a2747d3c6c3e
[INFO][2024-12-25 19:12:11][wechat_channel.py:183] - [WX]receive text msg: {"MsgId": "1237499995126062880", "FromUserName": "@bd3a01ce9f7a0e097dd33f00222e66b8", "ToUserName": "@d2c59525f473fe4284c1e937e9068de3845aced4ddf8ae0b3352fe6e5d0c6efb", "MsgType": 1, "Content": "1+1等于几", "Status": 3, "ImgStatus": 1, "CreateTime": 1735125131, "VoiceLength": 0, "PlayLength": 0, "FileName": "", "FileSize": "", "MediaId": "", "Url": "", "AppMsgType": 0, "StatusNotifyCode": 0, "StatusNotifyUserName": "", "RecommendInfo": {"UserName": "", "NickName": "", "QQNum": 0, "Province": "", "City": "", "Content": "", "Signature": "", "Alias": "", "Scene": 0, "VerifyFlag": 0, "AttrStatus": 0, "Sex": 0, "Ticket": "", "OpCode": 0}, "ForwardFlag": 0, "AppInfo": {"AppID": "", "Type": 0}, "HasProductId": 0, "Ticket": "", "ImgHeight": 0, "ImgWidth": 0, "SubMsgType": 0, "NewMsgId": 1237499995126062880, "OriContent": "", "EncryFileName": "", "User": {"MemberList": [], "Uin": 0, "UserName": "@bd3a01ce9f7a0e097dd33f00222e66b8", "NickName": "三山", "HeadImgUrl": "/cgi-bin/mmwebwx-bin/webwxgeticon?seq=624980072&username=@bd3a01ce9f7a0e097dd33f00222e66b8&skey=@crypt_fe88845f_2198e712e4d4002fb2c7ec992b1cad77", "ContactFlag": 3, "MemberCount": 0, "RemarkName": "", "HideInputBarFlag": 0, "Sex": 1, "Signature": "<span class=\"emoji emoji1f308\"></span>\n-\n\n平\n安\n囍\n樂 \n萬\n事\n勝\n意", "VerifyFlag": 0, "OwnerUin": 0, "PYInitial": "SS", "PYQuanPin": "sanshan", "RemarkPYInitial": "", "RemarkPYQuanPin": "", "StarFriend": 0, "AppAccountFlag": 0, "Statues": 0, "AttrStatus": 111079, "Province": "", "City": "M78星云", "Alias": "", "SnsFlag": 305, "UniFriend": 0, "DisplayName": "", "ChatRoomId": 0, "KeyWord": "yuw", "EncryChatRoomId": "", "IsOwner": 0}, "Type": "Text", "Text": "1+1等于几"}, cmsg=ChatMessage: id=1237499995126062880, create_time=1735125131, ctype=TEXT, content=1+1等于几, from_user_id=@bd3a01ce9f7a0e097dd33f00222e66b8, from_user_nickname=三山, to_user_id=@d2c59525f473fe4284c1e937e9068de3845aced4ddf8ae0b3352fe6e5d0c6efb, to_user_nickname=学习小助手, other_user_id=@bd3a01ce9f7a0e097dd33f00222e66b8, other_user_nickname=三山, is_group=False, is_at=False, actual_user_id=None, actual_user_nickname=None, at_list=None
[INFO][2024-12-25 19:12:11][wechat_channel.py:187] - _compose_context后的 context: Context(type=TEXT, content=1+1等于几, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x102be6590>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@bd3a01ce9f7a0e097dd33f00222e66b8', 'receiver': '@bd3a01ce9f7a0e097dd33f00222e66b8'})
[INFO][2024-12-25 19:12:11][wechat_channel.py:190] - produce后的 context: Context(type=TEXT, content=1+1等于几, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x102be6590>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@bd3a01ce9f7a0e097dd33f00222e66b8', 'receiver': '@bd3a01ce9f7a0e097dd33f00222e66b8'})
[INFO][2024-12-25 19:12:11][bridge.py:83] - 模型回复内容query: 1+1等于几  context type: TEXT
[INFO][2024-12-25 19:12:11][moonshot_bot.py:36] - [MOONSHOT_AI] query=1+1等于几
[INFO][2024-12-25 19:12:11][moonshot_bot.py:53] - [MOONSHOT_AI] session query=[{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '1+1等于几'}]
[INFO][2024-12-25 19:12:11][moonshot_bot.py:146] - 输入大模型的文本messages: [{'role': 'user', 'content': '1+1等于几'}]
[INFO][2024-12-25 19:12:14][moonshot_bot.py:154] - res: <Response [200]>
[INFO][2024-12-25 19:12:14][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@bd3a01ce9f7a0e097dd33f00222e66b8
[INFO][2024-12-25 19:12:15][wechat_channel.py:221] - [WX] sendMsg=Reply(type=TEXT, content=哈哈，1+1等于2呀，这可是最基础的加法运算呢，就像你有1个苹果，再加上1个苹果，那就一共有2个苹果啦。), receiver=@bd3a01ce9f7a0e097dd33f00222e66b8
[INFO][2024-12-25 19:12:27][wechat_channel.py:179] - [WX]receive image msg: tmp/241225-191227.png
[INFO][2024-12-25 19:12:27][wechat_channel.py:187] - _compose_context后的 context: Context(type=IMAGE, content=tmp/241225-191227.png, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x102be5c60>, 'origin_ctype': <ContextType.IMAGE: 3>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@bd3a01ce9f7a0e097dd33f00222e66b8', 'receiver': '@bd3a01ce9f7a0e097dd33f00222e66b8'})
[INFO][2024-12-25 19:12:27][wechat_channel.py:190] - produce后的 context: Context(type=IMAGE, content=tmp/241225-191227.png, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x102be5c60>, 'origin_ctype': <ContextType.IMAGE: 3>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@bd3a01ce9f7a0e097dd33f00222e66b8', 'receiver': '@bd3a01ce9f7a0e097dd33f00222e66b8'})
[INFO][2024-12-25 19:12:27][bridge.py:83] - 模型回复内容query: tmp/241225-191227.png  context type: IMAGE
[INFO][2024-12-25 19:12:27][moonshot_bot.py:82] - [MOONSHOT_AI] query=tmp/241225-191227.png
[INFO][2024-12-25 19:12:27][moonshot_bot.py:98] - [MOONSHOT_AI] session query=[{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '1+1等于几'}, {'role': 'assistant', 'content': '哈哈，1+1等于2呀，这可是最基础的加法运算呢，就像你有1个苹果，再加上1个苹果，那就一共有2个苹果啦。'}, {'role': 'user', 'content': 'tmp/241225-191227.png'}]
[INFO][2024-12-25 19:12:27][moonshot_bot.py:107] - 开始reply_image...
[INFO][2024-12-25 19:12:27][moonshot_bot.py:211] - 输入大模型的多模态messages: [{'role': 'user', 'content': [{'type': 'text', 'text': '1+1等于几'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': '哈哈，1+1等于2呀，这可是最基础的加法运算呢，就像你有1个苹果，再加上1个苹果，那就一共有2个苹果啦。'}]}, {'role': 'user', 'content': [{'type': 'text', 'text': '根据上下文解读图片内容'}, {'type': 'image_url', 'image_url': 'tmp/241225-191227.png'}]}]
[ERROR][2024-12-25 19:12:27][moonshot_bot.py:252] - 'NoneType' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 230, in reply_image
    logger.error(f"[MOONSHOT_AI] chat failed, status_code={res.status_code}, "
AttributeError: 'NoneType' object has no attribute 'get'
[INFO][2024-12-25 19:12:27][moonshot_bot.py:146] - 输入大模型的文本messages: [{'role': 'user', 'content': '1+1等于几'}, {'role': 'assistant', 'content': '哈哈，1+1等于2呀，这可是最基础的加法运算呢，就像你有1个苹果，再加上1个苹果，那就一共有2个苹果啦。'}, {'role': 'user', 'content': 'tmp/241225-191227.png'}]
[INFO][2024-12-25 19:12:30][moonshot_bot.py:154] - res: <Response [200]>
[INFO][2024-12-25 19:12:30][moonshot_bot.py:125] - 已经获取到图片
[INFO][2024-12-25 19:12:30][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@bd3a01ce9f7a0e097dd33f00222e66b8
[INFO][2024-12-25 19:12:30][wechat_channel.py:221] - [WX] sendMsg=Reply(type=TEXT, content=哎呀呀，你给我发了一张图片呀，可是我没办法看到图片内容呢，你可以用文字描述一下图片上的内容或者是关于这张图片涉及到的数学问题呀，我来帮你解答。), receiver=@bd3a01ce9f7a0e097dd33f00222e66b8
[INFO][2024-12-25 19:12:42][wechat_channel.py:183] - [WX]receive text msg: {"MsgId": "8658824440242894387", "FromUserName": "@bd3a01ce9f7a0e097dd33f00222e66b8", "ToUserName": "@d2c59525f473fe4284c1e937e9068de3845aced4ddf8ae0b3352fe6e5d0c6efb", "MsgType": 1, "Content": "数的知识点有哪些", "Status": 3, "ImgStatus": 1, "CreateTime": 1735125161, "VoiceLength": 0, "PlayLength": 0, "FileName": "", "FileSize": "", "MediaId": "", "Url": "", "AppMsgType": 0, "StatusNotifyCode": 0, "StatusNotifyUserName": "", "RecommendInfo": {"UserName": "", "NickName": "", "QQNum": 0, "Province": "", "City": "", "Content": "", "Signature": "", "Alias": "", "Scene": 0, "VerifyFlag": 0, "AttrStatus": 0, "Sex": 0, "Ticket": "", "OpCode": 0}, "ForwardFlag": 0, "AppInfo": {"AppID": "", "Type": 0}, "HasProductId": 0, "Ticket": "", "ImgHeight": 0, "ImgWidth": 0, "SubMsgType": 0, "NewMsgId": 8658824440242894387, "OriContent": "", "EncryFileName": "", "User": {"MemberList": [], "Uin": 0, "UserName": "@bd3a01ce9f7a0e097dd33f00222e66b8", "NickName": "三山", "HeadImgUrl": "/cgi-bin/mmwebwx-bin/webwxgeticon?seq=624980072&username=@bd3a01ce9f7a0e097dd33f00222e66b8&skey=@crypt_fe88845f_2198e712e4d4002fb2c7ec992b1cad77", "ContactFlag": 3, "MemberCount": 0, "RemarkName": "", "HideInputBarFlag": 0, "Sex": 1, "Signature": "<span class=\"emoji emoji1f308\"></span>\n-\n\n平\n安\n囍\n樂 \n萬\n事\n勝\n意", "VerifyFlag": 0, "OwnerUin": 0, "PYInitial": "SS", "PYQuanPin": "sanshan", "RemarkPYInitial": "", "RemarkPYQuanPin": "", "StarFriend": 0, "AppAccountFlag": 0, "Statues": 0, "AttrStatus": 111079, "Province": "", "City": "M78星云", "Alias": "", "SnsFlag": 305, "UniFriend": 0, "DisplayName": "", "ChatRoomId": 0, "KeyWord": "yuw", "EncryChatRoomId": "", "IsOwner": 0}, "Type": "Text", "Text": "数的知识点有哪些"}, cmsg=ChatMessage: id=8658824440242894387, create_time=1735125161, ctype=TEXT, content=数的知识点有哪些, from_user_id=@bd3a01ce9f7a0e097dd33f00222e66b8, from_user_nickname=三山, to_user_id=@d2c59525f473fe4284c1e937e9068de3845aced4ddf8ae0b3352fe6e5d0c6efb, to_user_nickname=学习小助手, other_user_id=@bd3a01ce9f7a0e097dd33f00222e66b8, other_user_nickname=三山, is_group=False, is_at=False, actual_user_id=None, actual_user_nickname=None, at_list=None
[INFO][2024-12-25 19:12:42][wechat_channel.py:187] - _compose_context后的 context: Context(type=TEXT, content=数的知识点有哪些, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x102be57e0>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@bd3a01ce9f7a0e097dd33f00222e66b8', 'receiver': '@bd3a01ce9f7a0e097dd33f00222e66b8'})
[INFO][2024-12-25 19:12:42][wechat_channel.py:190] - produce后的 context: Context(type=TEXT, content=数的知识点有哪些, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x102be57e0>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@bd3a01ce9f7a0e097dd33f00222e66b8', 'receiver': '@bd3a01ce9f7a0e097dd33f00222e66b8'})
[INFO][2024-12-25 19:12:42][bridge.py:83] - 模型回复内容query: 数的知识点有哪些  context type: TEXT
[INFO][2024-12-25 19:12:42][moonshot_bot.py:36] - [MOONSHOT_AI] query=数的知识点有哪些
[INFO][2024-12-25 19:12:42][moonshot_bot.py:53] - [MOONSHOT_AI] session query=[{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '1+1等于几'}, {'role': 'assistant', 'content': '哈哈，1+1等于2呀，这可是最基础的加法运算呢，就像你有1个苹果，再加上1个苹果，那就一共有2个苹果啦。'}, {'role': 'user', 'content': 'tmp/241225-191227.png'}, {'role': 'assistant', 'content': '哎呀呀，你给我发了一张图片呀，可是我没办法看到图片内容呢，你可以用文字描述一下图片上的内容或者是关于这张图片涉及到的数学问题呀，我来帮你解答。'}, {'role': 'user', 'content': '数的知识点有哪些'}]
[INFO][2024-12-25 19:12:42][moonshot_bot.py:146] - 输入大模型的文本messages: [{'role': 'user', 'content': '1+1等于几'}, {'role': 'assistant', 'content': '哈哈，1+1等于2呀，这可是最基础的加法运算呢，就像你有1个苹果，再加上1个苹果，那就一共有2个苹果啦。'}, {'role': 'user', 'content': 'tmp/241225-191227.png'}, {'role': 'assistant', 'content': '哎呀呀，你给我发了一张图片呀，可是我没办法看到图片内容呢，你可以用文字描述一下图片上的内容或者是关于这张图片涉及到的数学问题呀，我来帮你解答。'}, {'role': 'user', 'content': '数的知识点有哪些'}]
[INFO][2024-12-25 19:13:23][wechat_channel.py:183] - [WX]receive text msg: {"MsgId": "4212415781479050708", "FromUserName": "@bd3a01ce9f7a0e097dd33f00222e66b8", "ToUserName": "@d2c59525f473fe4284c1e937e9068de3845aced4ddf8ae0b3352fe6e5d0c6efb", "MsgType": 1, "Content": "数的知识点有哪些", "Status": 3, "ImgStatus": 1, "CreateTime": 1735125203, "VoiceLength": 0, "PlayLength": 0, "FileName": "", "FileSize": "", "MediaId": "", "Url": "", "AppMsgType": 0, "StatusNotifyCode": 0, "StatusNotifyUserName": "", "RecommendInfo": {"UserName": "", "NickName": "", "QQNum": 0, "Province": "", "City": "", "Content": "", "Signature": "", "Alias": "", "Scene": 0, "VerifyFlag": 0, "AttrStatus": 0, "Sex": 0, "Ticket": "", "OpCode": 0}, "ForwardFlag": 0, "AppInfo": {"AppID": "", "Type": 0}, "HasProductId": 0, "Ticket": "", "ImgHeight": 0, "ImgWidth": 0, "SubMsgType": 0, "NewMsgId": 4212415781479050708, "OriContent": "", "EncryFileName": "", "User": {"MemberList": [], "Uin": 0, "UserName": "@bd3a01ce9f7a0e097dd33f00222e66b8", "NickName": "三山", "HeadImgUrl": "/cgi-bin/mmwebwx-bin/webwxgeticon?seq=624980072&username=@bd3a01ce9f7a0e097dd33f00222e66b8&skey=@crypt_fe88845f_2198e712e4d4002fb2c7ec992b1cad77", "ContactFlag": 3, "MemberCount": 0, "RemarkName": "", "HideInputBarFlag": 0, "Sex": 1, "Signature": "<span class=\"emoji emoji1f308\"></span>\n-\n\n平\n安\n囍\n樂 \n萬\n事\n勝\n意", "VerifyFlag": 0, "OwnerUin": 0, "PYInitial": "SS", "PYQuanPin": "sanshan", "RemarkPYInitial": "", "RemarkPYQuanPin": "", "StarFriend": 0, "AppAccountFlag": 0, "Statues": 0, "AttrStatus": 111079, "Province": "", "City": "M78星云", "Alias": "", "SnsFlag": 305, "UniFriend": 0, "DisplayName": "", "ChatRoomId": 0, "KeyWord": "yuw", "EncryChatRoomId": "", "IsOwner": 0}, "Type": "Text", "Text": "数的知识点有哪些"}, cmsg=ChatMessage: id=4212415781479050708, create_time=1735125203, ctype=TEXT, content=数的知识点有哪些, from_user_id=@bd3a01ce9f7a0e097dd33f00222e66b8, from_user_nickname=三山, to_user_id=@d2c59525f473fe4284c1e937e9068de3845aced4ddf8ae0b3352fe6e5d0c6efb, to_user_nickname=学习小助手, other_user_id=@bd3a01ce9f7a0e097dd33f00222e66b8, other_user_nickname=三山, is_group=False, is_at=False, actual_user_id=None, actual_user_nickname=None, at_list=None
[INFO][2024-12-25 19:13:23][wechat_channel.py:187] - _compose_context后的 context: Context(type=TEXT, content=数的知识点有哪些, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x1041af220>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@bd3a01ce9f7a0e097dd33f00222e66b8', 'receiver': '@bd3a01ce9f7a0e097dd33f00222e66b8'})
[INFO][2024-12-25 19:13:23][wechat_channel.py:190] - produce后的 context: Context(type=TEXT, content=数的知识点有哪些, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x1041af220>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@bd3a01ce9f7a0e097dd33f00222e66b8', 'receiver': '@bd3a01ce9f7a0e097dd33f00222e66b8'})
[INFO][2024-12-25 19:13:23][bridge.py:83] - 模型回复内容query: 数的知识点有哪些  context type: TEXT
[INFO][2024-12-25 19:13:23][moonshot_bot.py:36] - [MOONSHOT_AI] query=数的知识点有哪些
[INFO][2024-12-25 19:13:23][moonshot_bot.py:53] - [MOONSHOT_AI] session query=[{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '1+1等于几'}, {'role': 'assistant', 'content': '哈哈，1+1等于2呀，这可是最基础的加法运算呢，就像你有1个苹果，再加上1个苹果，那就一共有2个苹果啦。'}, {'role': 'user', 'content': 'tmp/241225-191227.png'}, {'role': 'assistant', 'content': '哎呀呀，你给我发了一张图片呀，可是我没办法看到图片内容呢，你可以用文字描述一下图片上的内容或者是关于这张图片涉及到的数学问题呀，我来帮你解答。'}, {'role': 'user', 'content': '数的知识点有哪些'}, {'role': 'user', 'content': '数的知识点有哪些'}]
[INFO][2024-12-25 19:13:23][moonshot_bot.py:146] - 输入大模型的文本messages: [{'role': 'user', 'content': '1+1等于几'}, {'role': 'assistant', 'content': '哈哈，1+1等于2呀，这可是最基础的加法运算呢，就像你有1个苹果，再加上1个苹果，那就一共有2个苹果啦。'}, {'role': 'user', 'content': 'tmp/241225-191227.png'}, {'role': 'assistant', 'content': '哎呀呀，你给我发了一张图片呀，可是我没办法看到图片内容呢，你可以用文字描述一下图片上的内容或者是关于这张图片涉及到的数学问题呀，我来帮你解答。'}, {'role': 'user', 'content': '数的知识点有哪些'}, {'role': 'user', 'content': '数的知识点有哪些'}]
[INFO][2024-12-25 19:13:32][moonshot_bot.py:154] - res: <Response [200]>
[INFO][2024-12-25 19:13:32][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@bd3a01ce9f7a0e097dd33f00222e66b8
[INFO][2024-12-25 19:13:32][wechat_channel.py:221] - [WX] sendMsg=Reply(type=TEXT, content=以下是一些关于数的重要知识点呀，我来给你制作成知识点复习卡片：

### 整数
- 定义
    - 像-3，-2，-1，0，1，2，3等这样的数称为整数。整数包括正整数、零与负整数。
    - 重点：0既不是正数也不是负数，但它是整数。
- 整数的运算
    - 加法
        - 把两个或多个整数合并成一个数的运算。例如3 + 5 = 8 。
        - 重点：同号两数相加，取相同的符号，并把绝对值相加；异号两数相加，取绝对值较大的符号，并用较大的绝对值减去较小的绝对值。
    - 减法
        - 已知两个加数的和与其中一个加数，求另一个加数的运算。例如7 - 4 = 3 。
        - 重点：减去一个数等于加上这个数的相反数。
    - 乘法
        - 求几个相同加数的和的简便运算。例如3×4表示4个3相加，即3×4 = 12 。
        - 重点：两数相乘，同号得正，异号得负，并把绝对值相乘；任何数与0相乘都得0。
    - 除法
        - 已知两个因数的积与其中一个因数，求另一个因数的运算。例如12÷3 = 4 。
        - 重点：除以一个不等于0的数，等于乘这个数的倒数；0除以任何一个不等于0的数都得0。

### 小数
- 定义
    - 把整数“1”平均分成10份、100份、1000份…… 这样的一份或几份是十分之几、百分之几、千分之几…… 可以用小数表示。例如0.5，3.14等。
    - 重点：小数点左边是整数部分，右边是小数部分。
- 小数的运算
    - 加法和减法
        - 先把各数的小数点对齐（也就是把相同数位上的数对齐），再按照整数加、减法的法则进行计算，最后在得数里对齐横线上的小数点，点上小数点。例如3.25+2.1 = 5.35 。
    - 乘法
        - 先按照整数乘法的计算法则算出积，再看因数中共有几位小数，就从积的右边起数出几位，点上小数点；如果位数不够，就用“0”补足。例如2.5×3.2 = 8.00 = 8 。
    - 除法
        - 除数是整数的小数除法，按照整数除法的法则去除，商的小数点要和被除数的小数点对齐；如果除到被除数的末尾仍有余数，就在余数后面添“0”，再继续除。例如5.6÷7 = 0.8 。
        - 除数是小数的除法，先移动除数的小数点，使它变成整数，除数的小数点向右移动几位，被除数的小数点也向右移动几位（位数不够的，在被除数的末尾用“0”补足），然后按照除数是整数的小数除法进行计算。例如3.6÷0.4 = 9 。

### 分数
- 定义
    - 把单位“1”平均分成若干份，表示这样的一份或几份的数叫分数。例如1/2，3/4等。
    - 重点：分数线上面的叫分子，分数线下面的叫分母。
- 分数的运算
    - 加法和减法
        - 同分母分数相加减，分母不变，只把分子相加减。例如1/3+2/3 = 3/3 = 1 。
        - 异分母分数相加减，先通分，然后按照同分母分数加减法的法则进行计算。例如1/2+1/3 = 3/6+2/6 = 5/6 。
    - 乘法
        - 分数乘整数，用分数的分子和整数相乘的积作分子，分母不变。例如2/3×3 = 6/3 = 2 。
        - 分数乘分数，用分子相乘的积作分子，分母相乘的积作分母。例如2/3×3/4 = 6/12 = 1/2 。
    - 除法
        - 甲数除以乙数（0除外），等于甲数乘乙数的倒数。例如2/3÷3/4 = 2/3×4/3 = 8/9 。

这些数的知识点都很重要哦，要好好记住呀。 ), receiver=@bd3a01ce9f7a0e097dd33f00222e66b8
[INFO][2024-12-25 19:14:05][moonshot_bot.py:154] - res: <Response [200]>
[INFO][2024-12-25 19:14:05][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@bd3a01ce9f7a0e097dd33f00222e66b8
[INFO][2024-12-25 19:14:06][wechat_channel.py:221] - [WX] sendMsg=Reply(type=TEXT, content=以下是一些关于数的重要知识点呀，我来给你制作成知识点卡片：

### 整数
- 定义
    - 像-3、-2、-1、0、1、2、3等这样的数称为整数。整数包括正整数、零与负整数。
    - 重点：0既不是正数也不是负数，但它是整数。
- 运算
    - 加法：把两个或多个整数合并成一个数的运算。例如3 + 5 = 8 。
    - 减法：已知两个数的和与其中一个加数，求另一个加数的运算。如8 - 3 = 5 。
    - 乘法：求几个相同加数的和的简便运算。例如3×5表示5个3相加，即3×5 = 15 。
    - 除法：已知两个因数的积与其中一个因数，求另一个因数的运算。如15÷3 = 5 。

### 小数
- 定义
    - 小数由整数部分、小数点和小数部分组成。例如3.14，其中3是整数部分，.是小数点，14是小数部分。
    - 重点：小数的意义是把整数“1”平均分成10份、100份、1000份…… 这样的一份或几份是十分之几、百分之几、千分之几…… 可以用小数表示。
- 运算
    - 加法和减法：要把小数点对齐，然后按照整数加减法的法则进行计算。例如2.3 + 1.2 = 3.5 。
    - 乘法：先按照整数乘法算出积，再看因数中一共有几位小数，就从积的右边起数出几位，点上小数点。如2.5×1.2 = 3.00 = 3 。
    - 除法：除数是整数时，按照整数除法的法则去除，商的小数点要和被除数的小数点对齐；除数是小数时，先把除数变成整数，除数的小数点向右移动几位，被除数的小数点也向右移动几位（位数不够的，在被除数的末尾用“0”补足），然后按照除数是整数的小数除法进行计算。

### 分数
- 定义
    - 把单位“1”平均分成若干份，表示这样的一份或几份的数叫分数。例如把一个蛋糕平均分成4份，其中的1份就是1/4 。
    - 重点：分数中间的横线叫做分数线，分数线上面的数叫做分子，分数线下面的数叫做分母。
- 运算
    - 加法和减法：同分母分数相加减，分母不变，只把分子相加减；异分母分数相加减，先通分，然后按照同分母分数加减法的法则进行计算。例如1/3 + 1/3 = 2/3 ，1/2 + 1/3 = 3/6 + 2/6 = 5/6 。
    - 乘法：分数乘整数，用分数的分子和整数相乘的积作分子，分母不变；分数乘分数，用分子相乘的积作分子，分母相乘的积作分母。如2/3×3 = 2 ，1/2×2/3 = 2/6 = 1/3 。
    - 除法：甲数除以乙数（0除外），等于甲数乘乙数的倒数。如2/3÷1/3 = 2/3×3 = 2 。

这些就是数的一些主要知识点啦，你要好好记住哦。 ), receiver=@bd3a01ce9f7a0e097dd33f00222e66b8
[INFO][2024-12-25 19:17:05][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 19:17:05][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 19:17:05][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 19:17:05][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 19:17:08][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': 'math-assistant', 'open_ai_api_key': 'YOU*****KEY', 'claude_api_key': 'YOU*****KEY', 'bot_type': 'moonshot', 'moonshot_api_key': 'sk-*****9QE', 'moonshot_base_url': 'http://1.92.69.23:12003/v1/chat/completions', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': [''], 'single_chat_reply_prefix': '', 'group_chat_prefix': ['@学习小助手'], 'group_name_white_list': ['ALL_GROUP'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': ''}
[INFO][2024-12-25 19:17:08][config.py:224] - [Config] User datas loaded.
[INFO][2024-12-25 19:17:08][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 19:17:08][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 19:17:08][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 19:17:08][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 19:17:08][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 19:17:08][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 19:17:08][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 19:17:08][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 19:17:08][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 19:17:08][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 19:17:08][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 19:17:08][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[INFO][2024-12-25 19:17:08][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为7196。
[INFO][2024-12-25 19:17:08][godcmd.py:210] - [Godcmd] inited
[INFO][2024-12-25 19:17:08][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 19:17:08][keyword.py:42] - [keyword] inited.
[INFO][2024-12-25 19:17:08][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[INFO][2024-12-25 19:17:08][role.py:69] - [Role] inited
[INFO][2024-12-25 19:17:08][dungeon.py:56] - [Dungeon] inited
[INFO][2024-12-25 19:17:08][hello.py:38] - [Hello] inited
[INFO][2024-12-25 19:17:08][finish.py:23] - [Finish] inited
[INFO][2024-12-25 19:17:30][wechat_channel.py:134] - Wechat login success, user_id: @2cd42c9680991855806a4f0946b0a44217d815648ae326355217171424f76a98, nickname: 学习小助手
[INFO][2024-12-25 19:17:38][wechat_channel.py:183] - [WX]receive text msg: {"MsgId": "2691465895522058220", "FromUserName": "@8707f799b30cebca2c4a64e0724420d5", "ToUserName": "@2cd42c9680991855806a4f0946b0a44217d815648ae326355217171424f76a98", "MsgType": 1, "Content": "你好", "Status": 3, "ImgStatus": 1, "CreateTime": 1735125457, "VoiceLength": 0, "PlayLength": 0, "FileName": "", "FileSize": "", "MediaId": "", "Url": "", "AppMsgType": 0, "StatusNotifyCode": 0, "StatusNotifyUserName": "", "RecommendInfo": {"UserName": "", "NickName": "", "QQNum": 0, "Province": "", "City": "", "Content": "", "Signature": "", "Alias": "", "Scene": 0, "VerifyFlag": 0, "AttrStatus": 0, "Sex": 0, "Ticket": "", "OpCode": 0}, "ForwardFlag": 0, "AppInfo": {"AppID": "", "Type": 0}, "HasProductId": 0, "Ticket": "", "ImgHeight": 0, "ImgWidth": 0, "SubMsgType": 0, "NewMsgId": 2691465895522058220, "OriContent": "", "EncryFileName": "", "User": {"MemberList": [], "Uin": 0, "UserName": "@8707f799b30cebca2c4a64e0724420d5", "NickName": "九歌", "HeadImgUrl": "/cgi-bin/mmwebwx-bin/webwxgeticon?seq=624980050&username=@8707f799b30cebca2c4a64e0724420d5&skey=@crypt_fe88845f_aa12fc82ee3b204f93a589e9d470df8c", "ContactFlag": 3, "MemberCount": 0, "RemarkName": "", "HideInputBarFlag": 0, "Sex": 1, "Signature": "Let`s go somewhere furher", "VerifyFlag": 0, "OwnerUin": 0, "PYInitial": "JG", "PYQuanPin": "jiuge", "RemarkPYInitial": "", "RemarkPYQuanPin": "", "StarFriend": 0, "AppAccountFlag": 0, "Statues": 0, "AttrStatus": 16880959, "Province": "上海", "City": "长宁", "Alias": "", "SnsFlag": 273, "UniFriend": 0, "DisplayName": "", "ChatRoomId": 0, "KeyWord": "sho", "EncryChatRoomId": "", "IsOwner": 0}, "Type": "Text", "Text": "你好"}, cmsg=ChatMessage: id=2691465895522058220, create_time=1735125457, ctype=TEXT, content=你好, from_user_id=@8707f799b30cebca2c4a64e0724420d5, from_user_nickname=九歌, to_user_id=@2cd42c9680991855806a4f0946b0a44217d815648ae326355217171424f76a98, to_user_nickname=学习小助手, other_user_id=@8707f799b30cebca2c4a64e0724420d5, other_user_nickname=九歌, is_group=False, is_at=False, actual_user_id=None, actual_user_nickname=None, at_list=None
[INFO][2024-12-25 19:17:38][wechat_channel.py:187] - _compose_context后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x10511a320>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@8707f799b30cebca2c4a64e0724420d5', 'receiver': '@8707f799b30cebca2c4a64e0724420d5'})
[INFO][2024-12-25 19:17:38][wechat_channel.py:190] - produce后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x10511a320>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@8707f799b30cebca2c4a64e0724420d5', 'receiver': '@8707f799b30cebca2c4a64e0724420d5'})
[INFO][2024-12-25 19:17:38][bridge.py:68] - create bot moonshot for chat
[INFO][2024-12-25 19:17:38][bridge.py:83] - 模型回复内容query: 你好  context type: TEXT
[INFO][2024-12-25 19:17:38][moonshot_bot.py:36] - [MOONSHOT_AI] query=你好
[INFO][2024-12-25 19:17:38][moonshot_bot.py:53] - [MOONSHOT_AI] session query=[{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '你好'}]
[INFO][2024-12-25 19:17:38][moonshot_bot.py:146] - 输入大模型的文本messages: [{'role': 'user', 'content': '你好'}]
[INFO][2024-12-25 19:17:40][moonshot_bot.py:154] - res: <Response [200]>
[INFO][2024-12-25 19:17:40][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@8707f799b30cebca2c4a64e0724420d5
[INFO][2024-12-25 19:17:41][wechat_channel.py:221] - [WX] sendMsg=Reply(type=TEXT, content=你好呀，有什么数学问题或者需要什么帮助都可以随时和我说哦。), receiver=@8707f799b30cebca2c4a64e0724420d5
[INFO][2024-12-25 19:17:53][wechat_channel.py:179] - [WX]receive image msg: tmp/241225-191753.png
[INFO][2024-12-25 19:17:53][wechat_channel.py:187] - _compose_context后的 context: Context(type=IMAGE, content=tmp/241225-191753.png, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x10511a4a0>, 'origin_ctype': <ContextType.IMAGE: 3>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@8707f799b30cebca2c4a64e0724420d5', 'receiver': '@8707f799b30cebca2c4a64e0724420d5'})
[INFO][2024-12-25 19:17:53][wechat_channel.py:190] - produce后的 context: Context(type=IMAGE, content=tmp/241225-191753.png, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x10511a4a0>, 'origin_ctype': <ContextType.IMAGE: 3>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@8707f799b30cebca2c4a64e0724420d5', 'receiver': '@8707f799b30cebca2c4a64e0724420d5'})
[INFO][2024-12-25 19:17:53][chat_channel.py:227] - 当前文件的路径: /Users/oleg/Documents/github/chatgpt-on-wechat-bcb/channel  图片的绝对路径：/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/channel/tmp/241225-191753.png
[INFO][2024-12-25 19:17:53][bridge.py:83] - 模型回复内容query: tmp/241225-191753.png  context type: IMAGE
[INFO][2024-12-25 19:17:53][moonshot_bot.py:82] - [MOONSHOT_AI] query=tmp/241225-191753.png
[INFO][2024-12-25 19:17:53][moonshot_bot.py:98] - [MOONSHOT_AI] session query=[{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '你好'}, {'role': 'assistant', 'content': '你好呀，有什么数学问题或者需要什么帮助都可以随时和我说哦。'}, {'role': 'user', 'content': 'tmp/241225-191753.png'}]
[INFO][2024-12-25 19:17:53][moonshot_bot.py:107] - 开始reply_image...
[INFO][2024-12-25 19:17:53][moonshot_bot.py:211] - 输入大模型的多模态messages: [{'role': 'user', 'content': [{'type': 'text', 'text': '你好'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': '你好呀，有什么数学问题或者需要什么帮助都可以随时和我说哦。'}]}, {'role': 'user', 'content': [{'type': 'text', 'text': '根据上下文解读图片内容'}, {'type': 'image_url', 'image_url': 'tmp/241225-191753.png'}]}]
[INFO][2024-12-25 19:17:53][moonshot_bot.py:219] - res: <Response [401]>
[ERROR][2024-12-25 19:17:53][moonshot_bot.py:253] - 'NoneType' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 231, in reply_image
    f"msg={error.get('message')}, type={error.get('type')}")
AttributeError: 'NoneType' object has no attribute 'get'
[INFO][2024-12-25 19:17:53][moonshot_bot.py:146] - 输入大模型的文本messages: [{'role': 'user', 'content': '你好'}, {'role': 'assistant', 'content': '你好呀，有什么数学问题或者需要什么帮助都可以随时和我说哦。'}, {'role': 'user', 'content': 'tmp/241225-191753.png'}]
[INFO][2024-12-25 19:17:56][moonshot_bot.py:154] - res: <Response [200]>
[INFO][2024-12-25 19:17:56][moonshot_bot.py:125] - 已经获取到图片
[INFO][2024-12-25 19:17:56][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@8707f799b30cebca2c4a64e0724420d5
[INFO][2024-12-25 19:17:56][wechat_channel.py:221] - [WX] sendMsg=Reply(type=TEXT, content=哎呀呀，我没办法看到你发的图片呀，你可以用文字描述一下图片上的内容或者相关的数学问题等，我来帮助你。), receiver=@8707f799b30cebca2c4a64e0724420d5
[INFO][2024-12-25 19:19:45][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 19:19:45][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 19:19:46][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 19:19:46][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 19:19:48][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': 'math-assistant', 'open_ai_api_key': 'YOU*****KEY', 'claude_api_key': 'YOU*****KEY', 'bot_type': 'moonshot', 'moonshot_api_key': 'sk-*****9QE', 'moonshot_base_url': 'http://1.92.69.23:12003/v1/chat/completions', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': [''], 'single_chat_reply_prefix': '', 'group_chat_prefix': ['@学习小助手'], 'group_name_white_list': ['ALL_GROUP'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': ''}
[INFO][2024-12-25 19:19:48][config.py:224] - [Config] User datas loaded.
[INFO][2024-12-25 19:19:49][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 19:19:49][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 19:19:49][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 19:19:49][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 19:19:49][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 19:19:49][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 19:19:49][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 19:19:49][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 19:19:49][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 19:19:49][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 19:19:49][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 19:19:49][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[INFO][2024-12-25 19:19:49][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为6074。
[INFO][2024-12-25 19:19:49][godcmd.py:210] - [Godcmd] inited
[INFO][2024-12-25 19:19:49][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 19:19:49][keyword.py:42] - [keyword] inited.
[INFO][2024-12-25 19:19:49][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[INFO][2024-12-25 19:19:49][role.py:69] - [Role] inited
[INFO][2024-12-25 19:19:49][dungeon.py:56] - [Dungeon] inited
[INFO][2024-12-25 19:19:49][hello.py:38] - [Hello] inited
[INFO][2024-12-25 19:19:49][finish.py:23] - [Finish] inited
[INFO][2024-12-25 19:20:11][wechat_channel.py:134] - Wechat login success, user_id: @96edd9f635b5e39af4255e75c10e7784e9fd7c5513657523ad1358247817c8e3, nickname: 学习小助手
[INFO][2024-12-25 19:20:18][wechat_channel.py:183] - [WX]receive text msg: {"MsgId": "1504776435394836006", "FromUserName": "@35508b74088aa150e2452b498206c14c", "ToUserName": "@96edd9f635b5e39af4255e75c10e7784e9fd7c5513657523ad1358247817c8e3", "MsgType": 1, "Content": "你好", "Status": 3, "ImgStatus": 1, "CreateTime": 1735125618, "VoiceLength": 0, "PlayLength": 0, "FileName": "", "FileSize": "", "MediaId": "", "Url": "", "AppMsgType": 0, "StatusNotifyCode": 0, "StatusNotifyUserName": "", "RecommendInfo": {"UserName": "", "NickName": "", "QQNum": 0, "Province": "", "City": "", "Content": "", "Signature": "", "Alias": "", "Scene": 0, "VerifyFlag": 0, "AttrStatus": 0, "Sex": 0, "Ticket": "", "OpCode": 0}, "ForwardFlag": 0, "AppInfo": {"AppID": "", "Type": 0}, "HasProductId": 0, "Ticket": "", "ImgHeight": 0, "ImgWidth": 0, "SubMsgType": 0, "NewMsgId": 1504776435394836006, "OriContent": "", "EncryFileName": "", "User": {"MemberList": [], "Uin": 0, "UserName": "@35508b74088aa150e2452b498206c14c", "NickName": "九歌", "HeadImgUrl": "/cgi-bin/mmwebwx-bin/webwxgeticon?seq=624980050&username=@35508b74088aa150e2452b498206c14c&skey=@crypt_fe88845f_932dd91d490dcf6f164a68d2f9b88697", "ContactFlag": 3, "MemberCount": 0, "RemarkName": "", "HideInputBarFlag": 0, "Sex": 1, "Signature": "Let`s go somewhere furher", "VerifyFlag": 0, "OwnerUin": 0, "PYInitial": "JG", "PYQuanPin": "jiuge", "RemarkPYInitial": "", "RemarkPYQuanPin": "", "StarFriend": 0, "AppAccountFlag": 0, "Statues": 0, "AttrStatus": 16880959, "Province": "上海", "City": "长宁", "Alias": "", "SnsFlag": 273, "UniFriend": 0, "DisplayName": "", "ChatRoomId": 0, "KeyWord": "sho", "EncryChatRoomId": "", "IsOwner": 0}, "Type": "Text", "Text": "你好"}, cmsg=ChatMessage: id=1504776435394836006, create_time=1735125618, ctype=TEXT, content=你好, from_user_id=@35508b74088aa150e2452b498206c14c, from_user_nickname=九歌, to_user_id=@96edd9f635b5e39af4255e75c10e7784e9fd7c5513657523ad1358247817c8e3, to_user_nickname=学习小助手, other_user_id=@35508b74088aa150e2452b498206c14c, other_user_nickname=九歌, is_group=False, is_at=False, actual_user_id=None, actual_user_nickname=None, at_list=None
[INFO][2024-12-25 19:20:18][wechat_channel.py:187] - _compose_context后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x106fb9c90>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@35508b74088aa150e2452b498206c14c', 'receiver': '@35508b74088aa150e2452b498206c14c'})
[INFO][2024-12-25 19:20:18][wechat_channel.py:190] - produce后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x106fb9c90>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@35508b74088aa150e2452b498206c14c', 'receiver': '@35508b74088aa150e2452b498206c14c'})
[INFO][2024-12-25 19:20:19][bridge.py:68] - create bot moonshot for chat
[INFO][2024-12-25 19:20:19][bridge.py:83] - 模型回复内容query: 你好  context type: TEXT
[INFO][2024-12-25 19:20:19][moonshot_bot.py:36] - [MOONSHOT_AI] query=你好
[INFO][2024-12-25 19:20:19][moonshot_bot.py:53] - [MOONSHOT_AI] session query=[{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '你好'}]
[INFO][2024-12-25 19:20:19][moonshot_bot.py:146] - 输入大模型的文本messages: [{'role': 'user', 'content': '你好'}]
[INFO][2024-12-25 19:20:21][moonshot_bot.py:154] - res: <Response [200]>
[INFO][2024-12-25 19:20:21][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@35508b74088aa150e2452b498206c14c
[INFO][2024-12-25 19:20:22][wechat_channel.py:221] - [WX] sendMsg=Reply(type=TEXT, content=哈哈，你好呀，有什么数学问题或者需要我帮忙的地方呀，快和老师说说。), receiver=@35508b74088aa150e2452b498206c14c
[INFO][2024-12-25 19:20:27][wechat_channel.py:179] - [WX]receive image msg: tmp/241225-192027.png
[INFO][2024-12-25 19:20:27][wechat_channel.py:187] - _compose_context后的 context: Context(type=IMAGE, content=tmp/241225-192027.png, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x106fb9a20>, 'origin_ctype': <ContextType.IMAGE: 3>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@35508b74088aa150e2452b498206c14c', 'receiver': '@35508b74088aa150e2452b498206c14c'})
[INFO][2024-12-25 19:20:27][wechat_channel.py:190] - produce后的 context: Context(type=IMAGE, content=tmp/241225-192027.png, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x106fb9a20>, 'origin_ctype': <ContextType.IMAGE: 3>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@35508b74088aa150e2452b498206c14c', 'receiver': '@35508b74088aa150e2452b498206c14c'})
[INFO][2024-12-25 19:20:27][chat_channel.py:229] - 当前文件的路径: /Users/oleg/Documents/github/chatgpt-on-wechat-bcb/channel  图片的绝对路径：/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/channel/tmp/241225-192027.png
[INFO][2024-12-25 19:20:27][bridge.py:83] - 模型回复内容query: /Users/oleg/Documents/github/chatgpt-on-wechat-bcb/channel/tmp/241225-192027.png  context type: IMAGE
[INFO][2024-12-25 19:20:27][moonshot_bot.py:82] - [MOONSHOT_AI] query=/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/channel/tmp/241225-192027.png
[INFO][2024-12-25 19:20:27][moonshot_bot.py:98] - [MOONSHOT_AI] session query=[{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '你好'}, {'role': 'assistant', 'content': '哈哈，你好呀，有什么数学问题或者需要我帮忙的地方呀，快和老师说说。'}, {'role': 'user', 'content': '/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/channel/tmp/241225-192027.png'}]
[INFO][2024-12-25 19:20:27][moonshot_bot.py:107] - 开始reply_image...
[INFO][2024-12-25 19:20:27][moonshot_bot.py:211] - 输入大模型的多模态messages: [{'role': 'user', 'content': [{'type': 'text', 'text': '你好'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': '哈哈，你好呀，有什么数学问题或者需要我帮忙的地方呀，快和老师说说。'}]}, {'role': 'user', 'content': [{'type': 'text', 'text': '根据上下文解读图片内容'}, {'type': 'image_url', 'image_url': '/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/channel/tmp/241225-192027.png'}]}]
[INFO][2024-12-25 19:20:27][moonshot_bot.py:219] - res: <Response [401]>
[ERROR][2024-12-25 19:20:27][moonshot_bot.py:253] - 'NoneType' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 231, in reply_image
    f"msg={error.get('message')}, type={error.get('type')}")
AttributeError: 'NoneType' object has no attribute 'get'
[INFO][2024-12-25 19:20:27][moonshot_bot.py:146] - 输入大模型的文本messages: [{'role': 'user', 'content': '你好'}, {'role': 'assistant', 'content': '哈哈，你好呀，有什么数学问题或者需要我帮忙的地方呀，快和老师说说。'}, {'role': 'user', 'content': '/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/channel/tmp/241225-192027.png'}]
[INFO][2024-12-25 19:20:30][moonshot_bot.py:154] - res: <Response [200]>
[INFO][2024-12-25 19:20:30][moonshot_bot.py:125] - 已经获取到图片
[INFO][2024-12-25 19:20:30][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@35508b74088aa150e2452b498206c14c
[INFO][2024-12-25 19:20:31][wechat_channel.py:221] - [WX] sendMsg=Reply(type=TEXT, content=哎呀呀，你给我发了个图片呀，可我没办法看到图片呢，你可以用文字描述一下图片里的内容或者直接跟我说说你在数学学习上遇到的问题呀。), receiver=@35508b74088aa150e2452b498206c14c
[INFO][2024-12-25 19:22:30][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 19:22:30][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 19:22:31][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 19:22:31][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 19:22:33][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': 'math-assistant', 'open_ai_api_key': 'YOU*****KEY', 'claude_api_key': 'YOU*****KEY', 'bot_type': 'moonshot', 'moonshot_api_key': 'sk-*****9QE', 'moonshot_base_url': 'http://1.92.69.23:12003/v1/chat/completions', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': [''], 'single_chat_reply_prefix': '', 'group_chat_prefix': ['@学习小助手'], 'group_name_white_list': ['ALL_GROUP'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': ''}
[INFO][2024-12-25 19:22:33][config.py:224] - [Config] User datas loaded.
[INFO][2024-12-25 19:22:34][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 19:22:34][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 19:22:34][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 19:22:34][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 19:22:34][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 19:22:34][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 19:22:34][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 19:22:34][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 19:22:34][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 19:22:34][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 19:22:34][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 19:22:34][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[INFO][2024-12-25 19:22:34][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为2394。
[INFO][2024-12-25 19:22:34][godcmd.py:210] - [Godcmd] inited
[INFO][2024-12-25 19:22:34][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 19:22:34][keyword.py:42] - [keyword] inited.
[INFO][2024-12-25 19:22:34][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[INFO][2024-12-25 19:22:34][role.py:69] - [Role] inited
[INFO][2024-12-25 19:22:34][dungeon.py:56] - [Dungeon] inited
[INFO][2024-12-25 19:22:34][hello.py:38] - [Hello] inited
[INFO][2024-12-25 19:22:34][finish.py:23] - [Finish] inited
[INFO][2024-12-25 19:22:58][wechat_channel.py:134] - Wechat login success, user_id: @7161de456bbcf8434d0595dd31701c2706e2fddbebdd5e84ede598f29797a3b2, nickname: 学习小助手
[INFO][2024-12-25 19:23:05][wechat_channel.py:179] - [WX]receive image msg: tmp/241225-192305.png
[INFO][2024-12-25 19:23:05][wechat_channel.py:187] - _compose_context后的 context: Context(type=IMAGE, content=tmp/241225-192305.png, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x1072b62f0>, 'origin_ctype': <ContextType.IMAGE: 3>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@64b9757938ea576c59fd51dd4dd5d597', 'receiver': '@64b9757938ea576c59fd51dd4dd5d597'})
[INFO][2024-12-25 19:23:05][wechat_channel.py:190] - produce后的 context: Context(type=IMAGE, content=tmp/241225-192305.png, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x1072b62f0>, 'origin_ctype': <ContextType.IMAGE: 3>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@64b9757938ea576c59fd51dd4dd5d597', 'receiver': '@64b9757938ea576c59fd51dd4dd5d597'})
[INFO][2024-12-25 19:23:05][chat_channel.py:229] - 当前文件的路径: /Users/oleg/Documents/github/chatgpt-on-wechat-bcb  图片的绝对路径：/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/tmp/241225-192305.png
[INFO][2024-12-25 19:23:05][bridge.py:83] - 模型回复内容query: /Users/oleg/Documents/github/chatgpt-on-wechat-bcb/tmp/241225-192305.png  context type: IMAGE
[INFO][2024-12-25 19:23:05][bridge.py:68] - create bot moonshot for chat
[INFO][2024-12-25 19:23:05][moonshot_bot.py:82] - [MOONSHOT_AI] query=/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/tmp/241225-192305.png
[INFO][2024-12-25 19:23:05][moonshot_bot.py:98] - [MOONSHOT_AI] session query=[{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/tmp/241225-192305.png'}]
[INFO][2024-12-25 19:23:05][moonshot_bot.py:107] - 开始reply_image...
[INFO][2024-12-25 19:23:05][moonshot_bot.py:211] - 输入大模型的多模态messages: [{'role': 'user', 'content': [{'type': 'text', 'text': '根据上下文解读图片内容'}, {'type': 'image_url', 'image_url': '/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/tmp/241225-192305.png'}]}]
[INFO][2024-12-25 19:23:05][moonshot_bot.py:219] - res: <Response [401]>
[ERROR][2024-12-25 19:23:05][moonshot_bot.py:253] - 'NoneType' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/bot/moonshot/moonshot_bot.py", line 231, in reply_image
    f"msg={error.get('message')}, type={error.get('type')}")
AttributeError: 'NoneType' object has no attribute 'get'
[INFO][2024-12-25 19:23:05][moonshot_bot.py:146] - 输入大模型的文本messages: [{'role': 'user', 'content': '/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/tmp/241225-192305.png'}]
[INFO][2024-12-25 19:23:09][moonshot_bot.py:154] - res: <Response [200]>
[INFO][2024-12-25 19:23:09][moonshot_bot.py:125] - 已经获取到图片
[INFO][2024-12-25 19:23:09][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@64b9757938ea576c59fd51dd4dd5d597
[INFO][2024-12-25 19:23:09][wechat_channel.py:221] - [WX] sendMsg=Reply(type=TEXT, content=很抱歉呀，我没办法直接看到图片内容呢，你可以描述一下图片里的数学问题或者相关信息，我来帮助你解答。), receiver=@64b9757938ea576c59fd51dd4dd5d597
[INFO][2024-12-25 19:23:50][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 19:23:50][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 19:23:52][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 19:23:52][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 19:43:31][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': 'math-assistant', 'open_ai_api_key': 'YOU*****KEY', 'claude_api_key': 'YOU*****KEY', 'bot_type': 'moonshot', 'moonshot_api_key': 'sk-*****9QE', 'moonshot_base_url': 'http://1.92.69.23:12003/v1/chat/completions', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': [''], 'single_chat_reply_prefix': '', 'group_chat_prefix': ['@学习小助手'], 'group_name_white_list': ['ALL_GROUP'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': ''}
[INFO][2024-12-25 19:43:31][config.py:224] - [Config] User datas loaded.
[INFO][2024-12-25 19:43:31][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 19:43:31][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 19:43:31][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 19:43:31][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 19:43:31][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 19:43:31][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 19:43:31][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 19:43:31][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 19:43:31][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 19:43:31][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 19:43:31][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 19:43:31][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[INFO][2024-12-25 19:43:31][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为3680。
[INFO][2024-12-25 19:43:31][godcmd.py:210] - [Godcmd] inited
[INFO][2024-12-25 19:43:31][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 19:43:31][keyword.py:42] - [keyword] inited.
[INFO][2024-12-25 19:43:31][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[INFO][2024-12-25 19:43:31][role.py:69] - [Role] inited
[INFO][2024-12-25 19:43:31][dungeon.py:56] - [Dungeon] inited
[INFO][2024-12-25 19:43:31][hello.py:38] - [Hello] inited
[INFO][2024-12-25 19:43:31][finish.py:23] - [Finish] inited
[INFO][2024-12-25 19:43:53][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 19:43:53][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 19:43:56][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': 'math-assistant', 'open_ai_api_key': 'YOU*****KEY', 'claude_api_key': 'YOU*****KEY', 'bot_type': 'moonshot', 'moonshot_api_key': 'sk-*****9QE', 'moonshot_base_url': 'http://1.92.69.23:12003/v1/chat/completions', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': [''], 'single_chat_reply_prefix': '', 'group_chat_prefix': ['@学习小助手'], 'group_name_white_list': ['ALL_GROUP'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': ''}
[INFO][2024-12-25 19:43:56][config.py:224] - [Config] User datas loaded.
[INFO][2024-12-25 19:43:56][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 19:43:56][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 19:43:56][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 19:43:56][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 19:43:56][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 19:43:56][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 19:43:56][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 19:43:56][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 19:43:56][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 19:43:56][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 19:43:56][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 19:43:56][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[INFO][2024-12-25 19:43:56][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为1583。
[INFO][2024-12-25 19:43:56][godcmd.py:210] - [Godcmd] inited
[INFO][2024-12-25 19:43:56][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 19:43:56][keyword.py:42] - [keyword] inited.
[INFO][2024-12-25 19:43:56][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[INFO][2024-12-25 19:43:56][role.py:69] - [Role] inited
[INFO][2024-12-25 19:43:56][dungeon.py:56] - [Dungeon] inited
[INFO][2024-12-25 19:43:56][hello.py:38] - [Hello] inited
[INFO][2024-12-25 19:43:56][finish.py:23] - [Finish] inited
[INFO][2024-12-25 19:44:17][wechat_channel.py:134] - Wechat login success, user_id: @4261ad777ebc62548443ca239a6be0af5483aee638e2ac5746a986dca1a5e78e, nickname: 学习小助手
[INFO][2024-12-25 19:44:21][wechat_channel.py:183] - [WX]receive text msg: {"MsgId": "1784627070501864232", "FromUserName": "@57cf20652ac14cbb233a9c1b8a8886d1", "ToUserName": "@4261ad777ebc62548443ca239a6be0af5483aee638e2ac5746a986dca1a5e78e", "MsgType": 1, "Content": "你好", "Status": 3, "ImgStatus": 1, "CreateTime": 1735127061, "VoiceLength": 0, "PlayLength": 0, "FileName": "", "FileSize": "", "MediaId": "", "Url": "", "AppMsgType": 0, "StatusNotifyCode": 0, "StatusNotifyUserName": "", "RecommendInfo": {"UserName": "", "NickName": "", "QQNum": 0, "Province": "", "City": "", "Content": "", "Signature": "", "Alias": "", "Scene": 0, "VerifyFlag": 0, "AttrStatus": 0, "Sex": 0, "Ticket": "", "OpCode": 0}, "ForwardFlag": 0, "AppInfo": {"AppID": "", "Type": 0}, "HasProductId": 0, "Ticket": "", "ImgHeight": 0, "ImgWidth": 0, "SubMsgType": 0, "NewMsgId": 1784627070501864232, "OriContent": "", "EncryFileName": "", "User": {"MemberList": [], "Uin": 0, "UserName": "@57cf20652ac14cbb233a9c1b8a8886d1", "NickName": "九歌", "HeadImgUrl": "/cgi-bin/mmwebwx-bin/webwxgeticon?seq=624980050&username=@57cf20652ac14cbb233a9c1b8a8886d1&skey=@crypt_fe88845f_605bbf6d9935edb220de474f9ee2a836", "ContactFlag": 3, "MemberCount": 0, "RemarkName": "", "HideInputBarFlag": 0, "Sex": 1, "Signature": "Let`s go somewhere furher", "VerifyFlag": 0, "OwnerUin": 0, "PYInitial": "JG", "PYQuanPin": "jiuge", "RemarkPYInitial": "", "RemarkPYQuanPin": "", "StarFriend": 0, "AppAccountFlag": 0, "Statues": 0, "AttrStatus": 16880959, "Province": "上海", "City": "长宁", "Alias": "", "SnsFlag": 273, "UniFriend": 0, "DisplayName": "", "ChatRoomId": 0, "KeyWord": "sho", "EncryChatRoomId": "", "IsOwner": 0}, "Type": "Text", "Text": "你好"}, cmsg=ChatMessage: id=1784627070501864232, create_time=1735127061, ctype=TEXT, content=你好, from_user_id=@57cf20652ac14cbb233a9c1b8a8886d1, from_user_nickname=九歌, to_user_id=@4261ad777ebc62548443ca239a6be0af5483aee638e2ac5746a986dca1a5e78e, to_user_nickname=学习小助手, other_user_id=@57cf20652ac14cbb233a9c1b8a8886d1, other_user_nickname=九歌, is_group=False, is_at=False, actual_user_id=None, actual_user_nickname=None, at_list=None
[INFO][2024-12-25 19:44:21][wechat_channel.py:187] - _compose_context后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x1046b9960>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@57cf20652ac14cbb233a9c1b8a8886d1', 'receiver': '@57cf20652ac14cbb233a9c1b8a8886d1'})
[INFO][2024-12-25 19:44:21][wechat_channel.py:190] - produce后的 context: Context(type=TEXT, content=你好, kwargs={'isgroup': False, 'msg': <channel.wechat.wechat_message.WechatMessage object at 0x1046b9960>, 'origin_ctype': <ContextType.TEXT: 1>, 'openai_api_key': None, 'gpt_model': None, 'session_id': '@57cf20652ac14cbb233a9c1b8a8886d1', 'receiver': '@57cf20652ac14cbb233a9c1b8a8886d1'})
[INFO][2024-12-25 19:44:21][bridge.py:68] - create bot moonshot for chat
[INFO][2024-12-25 19:44:22][bridge.py:83] - 模型回复内容query: 你好  context type: TEXT
[INFO][2024-12-25 19:44:22][moonshot_bot.py:36] - [MOONSHOT_AI] query=你好
[INFO][2024-12-25 19:44:22][moonshot_bot.py:53] - [MOONSHOT_AI] session query=[{'role': 'system', 'content': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。'}, {'role': 'user', 'content': '你好'}]
[INFO][2024-12-25 19:44:22][moonshot_bot.py:146] - 输入大模型的文本messages: [{'role': 'user', 'content': '你好'}]
[INFO][2024-12-25 19:44:24][moonshot_bot.py:154] - res: <Response [200]>
[INFO][2024-12-25 19:44:24][wechat_channel.py:217] - 进入了wechat_channel的send发送环节，receiver类型：@57cf20652ac14cbb233a9c1b8a8886d1
[INFO][2024-12-25 19:44:25][wechat_channel.py:221] - [WX] sendMsg=Reply(type=TEXT, content=哎呀呀，你好呀，有什么数学问题或者需要什么帮助都可以随时和我说呀。), receiver=@57cf20652ac14cbb233a9c1b8a8886d1
[INFO][2024-12-25 19:45:28][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 19:45:28][config.py:235] - [Config] User datas saved.
[INFO][2024-12-25 19:45:29][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 19:45:29][config.py:235] - [Config] User datas saved.
[DEBUG][2024-12-25 20:05:28][config.py:298] - [INIT] set log level to DEBUG
[INFO][2024-12-25 20:05:28][config.py:300] - [INIT] load config: {'channel_type': 'wx', 'model': 'math-assistant', 'open_ai_api_key': 'YOU*****KEY', 'claude_api_key': 'YOU*****KEY', 'bot_type': 'moonshot', 'moonshot_api_key': 'sk-*****9QE', 'moonshot_base_url': 'http://1.92.69.23:12003/v1/chat/completions', 'text_to_image': 'dall-e-2', 'voice_to_text': 'openai', 'text_to_voice': 'openai', 'proxy': '', 'hot_reload': False, 'single_chat_prefix': [''], 'single_chat_reply_prefix': '', 'group_chat_prefix': ['@学习小助手'], 'group_name_white_list': ['ALL_GROUP'], 'image_create_prefix': ['画'], 'speech_recognition': True, 'group_speech_recognition': False, 'voice_reply_voice': False, 'conversation_max_tokens': 2500, 'expires_in_seconds': 3600, 'character_desc': '你是基于大语言模型的AI智能助手，旨在回答并解决人们的任何问题，并且可以使用多种语言与人交流。', 'temperature': 0.7, 'subscribe_msg': '感谢您的关注！\n这里是AI智能助手，可以自由对话。\n支持语音对话。\n支持图片输入。\n支持图片输出，画字开头的消息将按要求创作图片。\n支持tool、角色扮演和文字冒险等丰富的插件。\n输入{trigger_prefix}#help 查看详细指令。', 'use_linkai': False, 'linkai_api_key': '*****', 'linkai_app_code': '', 'debug': True}
[INFO][2024-12-25 20:05:28][config.py:224] - [Config] User datas loaded.
[DEBUG][2024-12-25 20:05:28][audio_convert.py:9] - import pysilk failed, wechaty voice message will not be supported.
[INFO][2024-12-25 20:05:28][plugin_manager.py:50] - Loading plugins config...
[INFO][2024-12-25 20:05:28][plugin_manager.py:88] - Scaning plugins ...
[INFO][2024-12-25 20:05:28][plugin_manager.py:41] - Plugin Role_v1.0 registered, path=./plugins/role
[INFO][2024-12-25 20:05:28][plugin_manager.py:41] - Plugin linkai_v0.1.0 registered, path=./plugins/linkai
[INFO][2024-12-25 20:05:28][plugin_manager.py:41] - Plugin Dungeon_v1.0 registered, path=./plugins/dungeon
[INFO][2024-12-25 20:05:28][plugin_manager.py:41] - Plugin BDunit_v0.1 registered, path=./plugins/bdunit
[INFO][2024-12-25 20:05:28][plugin_manager.py:41] - Plugin Finish_v1.0 registered, path=./plugins/finish
[INFO][2024-12-25 20:05:28][plugin_manager.py:41] - Plugin Godcmd_v1.0 registered, path=./plugins/godcmd
[INFO][2024-12-25 20:05:28][plugin_manager.py:41] - Plugin Hello_v0.1 registered, path=./plugins/hello
[INFO][2024-12-25 20:05:28][plugin_manager.py:41] - Plugin Banwords_v1.0 registered, path=./plugins/banwords
[INFO][2024-12-25 20:05:28][plugin_manager.py:41] - Plugin Keyword_v0.1 registered, path=./plugins/keyword
[WARNING][2024-12-25 20:05:28][plugin_manager.py:113] - Failed to import plugin tool: No module named 'chatgpt_tool_hub'
[DEBUG][2024-12-25 20:05:28][plugin_manager.py:184] - plugins.json config={'plugins': SortedDict({'Godcmd': {'enabled': True, 'priority': 999}, 'Keyword': {'enabled': True, 'priority': 900}, 'Banwords': {'enabled': False, 'priority': 100}, 'linkai': {'enabled': True, 'priority': 99}, 'Role': {'enabled': True, 'priority': 0}, 'Dungeon': {'enabled': True, 'priority': 0}, 'BDunit': {'enabled': False, 'priority': 0}, 'Hello': {'enabled': True, 'priority': -1}, 'Finish': {'enabled': True, 'priority': -999}}, sort_func=<lambda>, reverse=True)}
[DEBUG][2024-12-25 20:05:28][plugin.py:21] - loading plugin config, plugin_config_path=./plugins/godcmd/config.json, exist=True
[DEBUG][2024-12-25 20:05:28][plugin.py:28] - loading plugin config, plugin_name=Godcmd, conf={'password': '', 'admin_users': []}
[INFO][2024-12-25 20:05:28][godcmd.py:194] - [Godcmd] 因未设置口令，本次的临时口令为9361。
[INFO][2024-12-25 20:05:28][godcmd.py:210] - [Godcmd] inited
[DEBUG][2024-12-25 20:05:28][keyword.py:34] - [keyword]加载配置文件/Users/oleg/Documents/github/chatgpt-on-wechat-bcb/plugins/keyword/config.json
[INFO][2024-12-25 20:05:28][keyword.py:40] - [keyword] {}
[INFO][2024-12-25 20:05:28][keyword.py:42] - [keyword] inited.
[DEBUG][2024-12-25 20:05:28][plugin.py:21] - loading plugin config, plugin_config_path=./plugins/linkai/config.json, exist=False
[DEBUG][2024-12-25 20:05:28][plugin.py:28] - loading plugin config, plugin_name=linkai, conf=None
[DEBUG][2024-12-25 20:05:28][linkai.py:286] - No LinkAI plugin config.json, use plugins/linkai/config.json.template
[INFO][2024-12-25 20:05:28][linkai.py:35] - [LinkAI] inited, config={'group_app_map': {'测试群名1': 'default', '测试群名2': 'Kv2fXJcH'}, 'midjourney': {'enabled': False, 'auto_translate': True, 'img_proxy': True, 'max_tasks': 3, 'max_tasks_per_user': 1, 'use_image_create_prefix': True}, 'summary': {'enabled': False, 'group_enabled': True, 'max_file_size': 5000, 'type': ['FILE', 'SHARING']}}
[DEBUG][2024-12-25 20:05:28][role.py:62] - [Role] no role found for tag comments 
[INFO][2024-12-25 20:05:28][role.py:69] - [Role] inited
[INFO][2024-12-25 20:05:28][dungeon.py:56] - [Dungeon] inited
[DEBUG][2024-12-25 20:05:28][plugin.py:21] - loading plugin config, plugin_config_path=./plugins/hello/config.json, exist=False
[DEBUG][2024-12-25 20:05:28][plugin.py:28] - loading plugin config, plugin_name=Hello, conf=None
[DEBUG][2024-12-25 20:05:28][hello.py:119] - No Hello plugin config.json, use plugins/hello/config.json.template
[INFO][2024-12-25 20:05:28][hello.py:38] - [Hello] inited
[INFO][2024-12-25 20:05:28][finish.py:23] - [Finish] inited
[INFO][2024-12-25 20:05:39][app.py:19] - signal 2 received, exiting...
[INFO][2024-12-25 20:05:39][config.py:235] - [Config] User datas saved.
